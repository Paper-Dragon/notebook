import{a as i,c as a,g as e,o as n}from"./app-Bdxrw26Y.js";const l={};function h(t,s){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="vmware-esxi-密码恢复指南" tabindex="-1"><a class="header-anchor" href="#vmware-esxi-密码恢复指南"><span>VMware ESXi 密码恢复指南</span></a></h1><h2 id="背景故事" tabindex="-1"><a class="header-anchor" href="#背景故事"><span>背景故事</span></a></h2><p>某企业客户在日常运维中，由于人员岗位变动和交接文档不完整，意外丢失了VMware ESXi服务器的root管理员密码。导致运维团队无法正常登录和管理虚拟化平台，影响了日常的虚拟机维护和监控工作。</p><p>由于该ESXi服务器承载了多个关键业务系统，常规的密码重置方法无法适用，且客户希望尽可能保留现有的服务器配置和虚拟机状态。</p><p>因为遇到了这个事情然后对特定版本进行恢复密码，发现不同版本的VMware密码的恢复方法不一样，我对各种版本的VMware稍作研究，对方法进行记录。</p><p>Esxi的密码加密类型可以大致分为两种种，7.0.1之前的版本是配置记录法，通过明文密码进行记录，并压缩保存，7.0.1之后的版本使用了加密压缩包+数据库进行记录，安全性大幅增加；下面我对每种类型的密码加密和破解进行分章节介绍。</p><h2 id="_7-0-1之前的esxi版本密码破解" tabindex="-1"><a class="header-anchor" href="#_7-0-1之前的esxi版本密码破解"><span>7.0.1之前的Esxi版本密码破解</span></a></h2><h3 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h3><p>启动Linux Live系统（如Fedora Live），打开终端，确认ESXi配置分区（通常是<code>/dev/sda5</code>）。</p><h3 id="操作步骤" tabindex="-1"><a class="header-anchor" href="#操作步骤"><span>操作步骤</span></a></h3><p>备份和解压配置文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/state.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>修改密码配置</strong> 编辑<code>etc/vmware/esx.conf</code>文件（6.5前版本可能是<code>esxi.conf</code>）：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> etc/vmware/esx.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>找到密码相关行进行修改或删除。</p><p>6.7-7.0.1版本操作</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> etc/shadow</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除root那一行的加密密码，密码就会为空，不需要密码就能登陆控制台</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重新打包并恢复</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> czf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> etc/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> czf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/state.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">umount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重启ESXi主机</strong> 重启后即可使用修改后的密码登录。</p><h2 id="_7-0-1之后的esxi密码破解" tabindex="-1"><a class="header-anchor" href="#_7-0-1之后的esxi密码破解"><span>7.0.1之后的Esxi密码破解</span></a></h2><h3 id="环境准备-1" tabindex="-1"><a class="header-anchor" href="#环境准备-1"><span>环境准备</span></a></h3><ul><li>一台ESXi服务器（可使用<code>crypto-util</code>命令）</li><li>一个CD Linux系统（用于挂载ESXi配置盘，推荐使用Fedora Live或其他带桌面环境的发行版）</li></ul><h3 id="在linux操作系统内进行拷贝解压" tabindex="-1"><a class="header-anchor" href="#在linux操作系统内进行拷贝解压"><span>在Linux操作系统内进行拷贝解压</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/state.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/esxi_recovery</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以得到加密的文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">encryption.info</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">local.tgz.ve</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="将local-tgz-ve文件解密和修改" tabindex="-1"><a class="header-anchor" href="#将local-tgz-ve文件解密和修改"><span>将local.tgz.ve文件解密和修改</span></a></h3><p>转移进Esxi系统进行操作</p><p>解密</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crypto-util</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ++coreDumpEnabled=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,mem=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> envelope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extract</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --aad</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ESXConfiguration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz.ve</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这里能得到var目录和etc目录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="编辑和注入加密密钥" tabindex="-1"><a class="header-anchor" href="#编辑和注入加密密钥"><span>编辑和注入加密密钥</span></a></h3><p>生成密钥</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lunar@light</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MINGW64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> P@ssw0rd456</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$6</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$WETC82U1igW2DA5B$DdhGW5DJGvZibnsGn2V</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.xdKGGeMQfs5K7dXcpf9C2v9pqmgKF01ma/iH1.yfHD0Jwb8rv0mt1kmkZFlG53Ltq1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lunar@light</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MINGW64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> P@ssw0rd456</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$6</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$TQSuipF384bW8Ggf$PjUJ46McgVBwqUGcJjSFD241tpXXPvedUPwwLEHS9i64l0fREBtvxCdxmWelDwBz0Vc28bbAMZtLJEqE8Yri70</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询密钥存储</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/lib/vmware/sqlite/bin/sqlite3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/var/lib/vmware/configstore/backup/current-store-1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">select</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">where</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Component=&#39;esx&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ConfigGroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;authentication&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;user_accounts&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Identifier</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注入密钥</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/lib/vmware/sqlite/bin/sqlite3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/var/lib/vmware/configstore/backup/current-store-1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入数据库，更新密码为P@ssw0rd456</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> config</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UserValue=&#39;{&quot;name&quot;:&quot;root&quot;,&quot;password_hash&quot;:&quot;$6$TQSuipF384bW8Ggf$PjUJ46McgVBwqUGcJjSFD241tpXXPvedUPwwLEHS9i64l0fREBtvxCdxmWelDwBz0Vc28bbAMZtLJEqE8Yri70&quot;,&quot;description&quot;:&quot;Administrator&quot;}&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> where</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Component=&#39;esx&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ConfigGroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;authentication&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;user_accounts&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Identifier</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重新打包并恢复" tabindex="-1"><a class="header-anchor" href="#重新打包并恢复"><span>重新打包并恢复</span></a></h3><p>在Esxi系统里面打包</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -cvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .ssh/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> etc/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> var/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>将local.tgz文件拷贝回Linux操作系统</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -cvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state.tgz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> encryption.info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local.tgz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="拷贝回服务器并重启" tabindex="-1"><a class="header-anchor" href="#拷贝回服务器并重启"><span>拷贝回服务器并重启</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重启后可以使用</p><p>P@ssw0rd456</p><p>进行登录</p>`,48)])])}const p=i(l,[["render",h]]),r=JSON.parse('{"path":"/note-book/VMware/VMware%20ESXi%20%E5%AF%86%E7%A0%81%E6%81%A2%E5%A4%8D%E6%8C%87%E5%8D%97.html","title":"VMware ESXi 密码恢复指南","lang":"zh-CN","frontmatter":{"description":"VMware ESXi 密码恢复指南 背景故事 某企业客户在日常运维中，由于人员岗位变动和交接文档不完整，意外丢失了VMware ESXi服务器的root管理员密码。导致运维团队无法正常登录和管理虚拟化平台，影响了日常的虚拟机维护和监控工作。 由于该ESXi服务器承载了多个关键业务系统，常规的密码重置方法无法适用，且客户希望尽可能保留现有的服务器配置和...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"VMware ESXi 密码恢复指南\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-05T15:42:58.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/VMware/VMware%20ESXi%20%E5%AF%86%E7%A0%81%E6%81%A2%E5%A4%8D%E6%8C%87%E5%8D%97.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"VMware ESXi 密码恢复指南"}],["meta",{"property":"og:description","content":"VMware ESXi 密码恢复指南 背景故事 某企业客户在日常运维中，由于人员岗位变动和交接文档不完整，意外丢失了VMware ESXi服务器的root管理员密码。导致运维团队无法正常登录和管理虚拟化平台，影响了日常的虚拟机维护和监控工作。 由于该ESXi服务器承载了多个关键业务系统，常规的密码重置方法无法适用，且客户希望尽可能保留现有的服务器配置和..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-05T15:42:58.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-05T15:42:58.000Z"}]]},"git":{"createdTime":1757086978000,"updatedTime":1757086978000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"}],"changelog":[{"hash":"c82b17a861069e5293c0f842f9a90efc74dc26eb","time":1757086978000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"VMware ESXi 密码恢复指南"}]},"readingTime":{"minutes":2.69,"words":807},"filePathRelative":"note-book/VMware/VMware ESXi 密码恢复指南.md","excerpt":"\\n<h2>背景故事</h2>\\n<p>某企业客户在日常运维中，由于人员岗位变动和交接文档不完整，意外丢失了VMware ESXi服务器的root管理员密码。导致运维团队无法正常登录和管理虚拟化平台，影响了日常的虚拟机维护和监控工作。</p>\\n<p>由于该ESXi服务器承载了多个关键业务系统，常规的密码重置方法无法适用，且客户希望尽可能保留现有的服务器配置和虚拟机状态。</p>\\n<p>因为遇到了这个事情然后对特定版本进行恢复密码，发现不同版本的VMware密码的恢复方法不一样，我对各种版本的VMware稍作研究，对方法进行记录。</p>\\n<p>Esxi的密码加密类型可以大致分为两种种，7.0.1之前的版本是配置记录法，通过明文密码进行记录，并压缩保存，7.0.1之后的版本使用了加密压缩包+数据库进行记录，安全性大幅增加；下面我对每种类型的密码加密和破解进行分章节介绍。</p>","autoDesc":true}');export{p as comp,r as data};
