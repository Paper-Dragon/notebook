import{ah as i,ai as a,an as n,am as l}from"./app-CI1Z7cn8.js";const h={};function k(e,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h1 id="清理rancher节点" tabindex="-1"><a class="header-anchor" href="#清理rancher节点"><span>清理Rancher节点</span></a></h1><h2 id="rancher重新部署-清理不干净的话是个很头疼的事情-残留的kubernetes组件可能导致资源冲突或部署失败-以下是官方标准清理流程" tabindex="-1"><a class="header-anchor" href="#rancher重新部署-清理不干净的话是个很头疼的事情-残留的kubernetes组件可能导致资源冲突或部署失败-以下是官方标准清理流程"><span>rancher重新部署，清理不干净的话是个很头疼的事情，<strong>残留的Kubernetes组件可能导致资源冲突或部署失败</strong>，以下是官方标准清理流程：</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#复制粘贴就可以，亲测无误（注意根据实际情况修改安装目录/var/lib/rancher）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubelet.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-scheduler.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-proxy.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-controller-manager.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-apiserver.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kubelet.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-scheduler.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-proxy.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-controller-manager.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kube-apiserver.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">egrep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rancher</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">egrep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k8s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openvpn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DRIVER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $2}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/etcd/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/rancher/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">umount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">df</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -HT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/var/lib/kubelet/pods&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $7}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/kubernetes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/etcd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/rancher</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt/rke/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/ceph/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/cni/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /opt/cni/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run/secrets/kubernetes.io</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run/calico/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run/flannel/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/calico/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/cni/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/kubelet/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/containers/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/pods/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">network_interface</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/class/net\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> net_inter</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $network_interface</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ! </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $net_inter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -qiE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;lo|docker0|eth*|ens*&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $net_inter</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  fi</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#因为k8s会进行一些临时配置：防火墙、网络缓存等，需要重启服务器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reboot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)]))}const p=i(h,[["render",k]]),r=JSON.parse(`{"path":"/note-book/Rancher/%E6%B8%85%E7%90%86rancher%E8%8A%82%E7%82%B9.html","title":"清理Rancher节点","lang":"zh-CN","frontmatter":{"description":"清理Rancher节点 rancher重新部署，清理不干净的话是个很头疼的事情，残留的Kubernetes组件可能导致资源冲突或部署失败，以下是官方标准清理流程：","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"清理Rancher节点\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-03-10T03:51:41.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/Rancher/%E6%B8%85%E7%90%86rancher%E8%8A%82%E7%82%B9.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"清理Rancher节点"}],["meta",{"property":"og:description","content":"清理Rancher节点 rancher重新部署，清理不干净的话是个很头疼的事情，残留的Kubernetes组件可能导致资源冲突或部署失败，以下是官方标准清理流程："}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-10T03:51:41.000Z"}],["meta",{"property":"article:modified_time","content":"2025-03-10T03:51:41.000Z"}]]},"git":{"createdTime":1741578701000,"updatedTime":1741578701000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"}],"changelog":[{"hash":"550a1b094ad692c090cbfa3bf9690978a0cc6151","time":1741578701000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"清理Rancher节点"}]},"readingTime":{"minutes":0.91,"words":274},"filePathRelative":"note-book/Rancher/清理rancher节点.md","localizedDate":"2025年3月10日","excerpt":"\\n<h2>rancher重新部署，清理不干净的话是个很头疼的事情，<strong>残留的Kubernetes组件可能导致资源冲突或部署失败</strong>，以下是官方标准清理流程：</h2>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">#复制粘贴就可以，亲测无误（注意根据实际情况修改安装目录/var/lib/rancher）</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  disable</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kubelet.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  disable</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-scheduler.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  disable</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-proxy.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  disable</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-controller-manager.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  disable</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-apiserver.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kubelet.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-scheduler.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-proxy.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-controller-manager.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> kube-apiserver.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> ps</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -a</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">egrep</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> rancher</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">awk</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> '{print $1}'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">xargs</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -f</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> ps</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -a</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">egrep</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> k8s</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">awk</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> '{print $1}'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">xargs</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -f</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> volume</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> ls</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">grep</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -v</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> openvpn</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">grep</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -v</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> DRIVER</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">awk</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> '{print $2}'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">xargs</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> volume</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> rm</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/etcd/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/rancher/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">umount</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> $(</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">df</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -HT</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">grep</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> '/var/lib/kubelet/pods'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">awk</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> '{print $7}'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/kubernetes</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/etcd</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/rancher</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /opt/rke/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/ceph/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/cni/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /opt/cni/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /run/secrets/kubernetes.io</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /run/calico/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /run/flannel/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/calico/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/cni/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/lib/kubelet/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/log/containers/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rm</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /var/log/pods/</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">network_interface</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\`</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">ls</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /sys/class/net\`</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> </span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">for</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\"> net_inter</span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\"> in</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\"> $network_interface</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">do</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">  if</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> ! </span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">echo</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\"> $net_inter</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">grep</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -qiE</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 'lo|docker0|eth*|ens*'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">then</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">    ip</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> link</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> delete</span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\"> $net_inter</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">  fi</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">done</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">#因为k8s会进行一些临时配置：防火墙、网络缓存等，需要重启服务器</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sudo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> reboot</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{p as comp,r as data};
