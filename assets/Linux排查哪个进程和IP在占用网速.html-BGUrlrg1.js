import{ah as i,ai as a,an as e,am as n}from"./app-Bs2UdrIZ.js";const t="/assets/image-20220803112311809-D21wFnmT.png",p="/assets/image-20220803112417099-D6yGUHbJ.png",h="/assets/image-20220803112443633-CItCtrkH.png",l="/assets/image-20220803112544922-BwrRClh_.png",r="/assets/image-20220803112551395-BACOmw1k.png",d="/assets/image-20220803112809801-AQp0GuC5.png",o={};function k(c,s){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="linux排查哪个进程在占用网速" tabindex="-1"><a class="header-anchor" href="#linux排查哪个进程在占用网速"><span>Linux排查哪个进程在占用网速</span></a></h1><p>本教程适用于CentOS 7,CentOS 8</p><h2 id="使用nethogs定位哪个进程在占用流量" tabindex="-1"><a class="header-anchor" href="#使用nethogs定位哪个进程在占用流量"><span>使用NetHogs定位哪个进程在占用流量</span></a></h2><h3 id="安装nethogs" tabindex="-1"><a class="header-anchor" href="#安装nethogs"><span>安装NetHogs</span></a></h3><pre><code># 安装NetHogs。
yum install nethogs -y   
</code></pre><h3 id="查看进程流量" tabindex="-1"><a class="header-anchor" href="#查看进程流量"><span>查看进程流量</span></a></h3><pre><code># 执行以下命令，查看占用内网带宽的进程。
nethogs eth0

# 查询间隔(-d)5秒
nethogs eth1 -d 5
</code></pre><p><img src="`+t+'" alt=""></p><h3 id="显示界面说明" tabindex="-1"><a class="header-anchor" href="#显示界面说明"><span>显示界面说明</span></a></h3><p>在nethogs监控界面，按s可以按照Sent列进行排序，按r可以按照Received列进行排序，按m可以切换不同的统计单位显示，例如kb/s、kb、b、mb。监控界面信息说明如下所示。 <img src="'+p+'" alt="image-20220803112417099"></p><h2 id="使用iftop定位哪个ip在占用流量" tabindex="-1"><a class="header-anchor" href="#使用iftop定位哪个ip在占用流量"><span>使用iftop定位哪个IP在占用流量</span></a></h2><h3 id="iftop基本用法" tabindex="-1"><a class="header-anchor" href="#iftop基本用法"><span>iftop基本用法</span></a></h3><p><img src="'+h+`" alt="image-20220803112443633"></p><h3 id="查看哪个连接占用流量最多" tabindex="-1"><a class="header-anchor" href="#查看哪个连接占用流量最多"><span>查看哪个连接占用流量最多</span></a></h3><pre><code># 查看eth0哪个连接网络流量最多
iftop -P
</code></pre><h3 id="不解析域名-所有的网络连接都以ip显示" tabindex="-1"><a class="header-anchor" href="#不解析域名-所有的网络连接都以ip显示"><span>不解析域名,所有的网络连接都以ip显示</span></a></h3><pre><code>iftop -n
</code></pre><p>指定监控网卡</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不加i参数表示监控所有网卡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iftop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定网卡且不解析dns</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iftop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> eth0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看流量较高的是占用的端口(或服务)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iftop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> eth0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -N查看流量较高的是占用的端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iftop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> eth0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -N</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+l+'" alt="image-20220803112544922"></p><p><img src="'+r+`" alt="image-20220803112551395"></p><h2 id="快速端口占用的pid" tabindex="-1"><a class="header-anchor" href="#快速端口占用的pid"><span>快速端口占用的pid</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  根据进程pid查端口：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lsof</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  根据端口port查进程（某次面试还考过）：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lsof</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -i:port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 根据进程pid查端口：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pid</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  根据端口port查进程</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> port</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">从形式上看，</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 更好记忆，</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 但lsof的用法也要熟练。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code># 使用fuser定位端口的pid

fuser -v  -n tcp 3306

结束掉占用的pid
kill -s 9 pid
</code></pre><h3 id="使用lsof定位端口的pid" tabindex="-1"><a class="header-anchor" href="#使用lsof定位端口的pid"><span>使用lsof定位端口的pid</span></a></h3><pre><code>lsof -i:端口号

[greg@node5 ~]$ sudo lsof -i:80
COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
haproxy 9521 haproxy    9u  IPv4  63613      0t0  TCP *:http (LISTEN)
</code></pre><p>​<br> ## -n 不要将端口号转换为端口名称。 ## -P 不解析主机名，显示数字地址。 ## -iTCP -sTCP:LISTEN -仅显示TCP状态为LISTEN的网络文件</p><pre><code># 查看TCP22端口是哪个进程占用
sudo lsof -nP -iTCP:22 -sTCP:LISTEN
# 查看监听的所有TCP端口
sudo lsof -nP -iTCP -sTCP:LISTEN
</code></pre><h3 id="通过pid进程号查找启动程序全路径" tabindex="-1"><a class="header-anchor" href="#通过pid进程号查找启动程序全路径"><span>通过PID进程号查找启动程序全路径</span></a></h3><pre><code>ls -ail /proc/pid进程号
</code></pre><ul><li>cwd是该进程的工作目录</li><li>exe是启程序的启动路径</li><li>fd包含进程打开文件的情况</li></ul><p><img src="`+d+`" alt="image-20220803112809801"></p><h2 id="结束进程" tabindex="-1"><a class="header-anchor" href="#结束进程"><span>结束进程</span></a></h2><pre><code># 停止进程
kill -15 pid号
或
# 强制结束进程
kill -9 pid号
</code></pre><h2 id="日志分析" tabindex="-1"><a class="header-anchor" href="#日志分析"><span>日志分析</span></a></h2><p>日志分析可以使用<strong>logwatch</strong>或<strong>awstats</strong>等工具进行.</p>`,36)]))}const m=i(o,[["render",k]]),A=JSON.parse('{"path":"/note-book/OperaSystems/Linux%E6%8E%92%E6%9F%A5%E5%93%AA%E4%B8%AA%E8%BF%9B%E7%A8%8B%E5%92%8CIP%E5%9C%A8%E5%8D%A0%E7%94%A8%E7%BD%91%E9%80%9F.html","title":"Linux排查哪个进程在占用网速","lang":"zh-CN","frontmatter":{"description":"Linux排查哪个进程在占用网速 本教程适用于CentOS 7,CentOS 8 使用NetHogs定位哪个进程在占用流量 安装NetHogs 查看进程流量 显示界面说明 在nethogs监控界面，按s可以按照Sent列进行排序，按r可以按照Received列进行排序，按m可以切换不同的统计单位显示，例如kb/s、kb、b、mb。监控界面信息说明如下所...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Linux排查哪个进程在占用网速\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-19T02:07:47.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/OperaSystems/Linux%E6%8E%92%E6%9F%A5%E5%93%AA%E4%B8%AA%E8%BF%9B%E7%A8%8B%E5%92%8CIP%E5%9C%A8%E5%8D%A0%E7%94%A8%E7%BD%91%E9%80%9F.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"Linux排查哪个进程在占用网速"}],["meta",{"property":"og:description","content":"Linux排查哪个进程在占用网速 本教程适用于CentOS 7,CentOS 8 使用NetHogs定位哪个进程在占用流量 安装NetHogs 查看进程流量 显示界面说明 在nethogs监控界面，按s可以按照Sent列进行排序，按r可以按照Received列进行排序，按m可以切换不同的统计单位显示，例如kb/s、kb、b、mb。监控界面信息说明如下所..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-19T02:07:47.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-19T02:07:47.000Z"}]]},"git":{"createdTime":1691939318000,"updatedTime":1734574067000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"},{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":1,"url":"https://github.com/PaperDragon-SH"},{"name":"PaperDragon-Bot","username":"PaperDragon-Bot","email":"2678885646@qq.com","commits":1,"url":"https://github.com/PaperDragon-Bot"}],"changelog":[{"hash":"ddccdec054167aa009d569bdca0ad5f933c4c807","time":1734574067000,"email":"2678885646@qq.com","author":"PaperDragon-Bot","message":"update  CTS Scripts , add manual build documents"},{"hash":"6ab7eb83988778fac940fa21b76fbec53d5cae3c","time":1730452668000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"optimize"},{"hash":"392a519398b2e846f316619fbe831e100164de7c","time":1691939318000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"Create The Worid!"}]},"readingTime":{"minutes":2.4,"words":719},"filePathRelative":"note-book/OperaSystems/Linux排查哪个进程和IP在占用网速.md","excerpt":"\\n<p>本教程适用于CentOS 7,CentOS 8</p>\\n<h2>使用NetHogs定位哪个进程在占用流量</h2>\\n<h3>安装NetHogs</h3>\\n<pre><code># 安装NetHogs。\\nyum install nethogs -y   \\n</code></pre>\\n<h3>查看进程流量</h3>\\n<pre><code># 执行以下命令，查看占用内网带宽的进程。\\nnethogs eth0\\n\\n# 查询间隔(-d)5秒\\nnethogs eth1 -d 5\\n</code></pre>\\n<p></p>\\n<h3>显示界面说明</h3>\\n<p>在nethogs监控界面，按s可以按照Sent列进行排序，按r可以按照Received列进行排序，按m可以切换不同的统计单位显示，例如kb/s、kb、b、mb。监控界面信息说明如下所示。\\n</p>","autoDesc":true}');export{m as comp,A as data};
