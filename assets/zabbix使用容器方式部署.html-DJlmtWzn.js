import{aq as i,ar as a,aw as n,av as e}from"./app-BkQX7AVe.js";const l={};function t(r,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="zabbix使用容器方式部署" tabindex="-1"><a class="header-anchor" href="#zabbix使用容器方式部署"><span>zabbix使用容器方式部署</span></a></h1><blockquote><p>近期做了一些民间项目，不需要极好的可靠性，要求快速部署和删除。所以做了个Docker方案。进行记录</p><p>参考资料：</p><ul><li>zabbix-docker镜像构建的文档在这里 <ul><li>https://github.com/zabbix/zabbix-docker</li></ul></li><li>该页面所有资料来自官网 <ul><li>https://www.zabbix.com/documentation/current/zh/manual/installation/containers</li></ul></li></ul></blockquote><h2 id="zabbix-server" tabindex="-1"><a class="header-anchor" href="#zabbix-server"><span>Zabbix-Server</span></a></h2><p>Zabbix 组件支持 MySQL 和 PostgreSQL 数据库、Apache2 和 Nginx Web 服务器。这些 image 被分成多个不同的 image。</p><blockquote><p>组件化和降低耦合度能够更加缩小软件的体积。更容易部署和升级。更容易实现负载均衡和高可用。</p></blockquote><h3 id="变量列表" tabindex="-1"><a class="header-anchor" href="#变量列表"><span>变量列表</span></a></h3><table><thead><tr><th><strong>变量</strong></th><th><strong>组件</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>DB_SERVER_HOST</code></td><td>Server Proxy Web 界面</td><td>这个变量指的是 MySQL 或 PostgreSQL 的 IP 或 DNS。 默认情况下，这个值根据 MySQL 和 PostgreSQL，分别为mysql-server 或 postgres-server</td></tr><tr><td><code>DB_SERVER_PORT</code></td><td>Server Proxy Web 界面</td><td>这个变量指的是 MySQL 或 PostgreSQL 的端口。 默认情况下，这个值根据 MySQL 和 PostgreSQL，分别为 &#39;3306&#39; 或 &#39;5432&#39; 。</td></tr><tr><td><code>MYSQL_USER</code></td><td>Server Proxy Web 界面</td><td>MySQL 数据库用户。 默认情况下，这个值为 &#39;zabbix&#39;。</td></tr><tr><td><code>MYSQL_PASSWORD</code></td><td>Server Proxy Web 界面</td><td>MySQL 数据库密码。 默认情况下，这个值为 &#39;zabbix&#39;。</td></tr><tr><td><code>MYSQL_DATABASE</code></td><td>Server Proxy Web 界面</td><td>Zabbix 数据库库名。 默认情况下，这个值根据 Zabbix server 和 Zabbix proxy，分别为 &#39;zabbix&#39; 和 &#39;zabbix_proxy&#39; 。</td></tr><tr><td><code>POSTGRES_USER</code></td><td>Server Web 界面</td><td>PostgreSQL 数据库用户。 默认情况下，这个值为 &#39;zabbix&#39;。</td></tr><tr><td><code>POSTGRES_PASSWORD</code></td><td>Server Web 界面</td><td>PostgreSQL 数据库密码。 默认情况下，这个值为 &#39;zabbix&#39;。</td></tr><tr><td><code>POSTGRES_DB</code></td><td>Server Web 界面</td><td>Zabbix 数据库库名。 默认情况下，这个值根据 Zabbix server 和 Zabbix proxy，分别为 &#39;zabbix&#39; 和 &#39;zabbix_proxy&#39; 。</td></tr><tr><td><code>PHP_TZ</code></td><td>Web 界面</td><td>PHP 时区格式。支持时区的完整列表参照 <a href="http://php.net/manual/en/timezones.php" target="_blank" rel="noopener noreferrer">php.net</a>。 默认情况下，这个值为 &#39;Europe/Riga&#39; 。</td></tr><tr><td><code>ZBX_SERVER_NAME</code></td><td>Web 界面</td><td>Web 界面右上角显示的安装名称。 默认情况下，这个值为 &#39;Zabbix Docker&#39; 。</td></tr><tr><td><code>ZBX_JAVAGATEWAY_ENABLE</code></td><td>Server Proxy</td><td>是否启用 Zabbix Java 网关 以采集与 Java 相关的检查数据。 默认情况下，这个值为 &quot;false&quot; 。</td></tr><tr><td><code>ZBX_ENABLE_SNMP_TRAPS</code></td><td>Server Proxy</td><td>是否启用 SNMP trap 功能。 这需要存在 zabbix-snmptraps 容器实例，并共享 /var/lib/zabbix/snmptraps volume 到 Zabbix server 或 proxy。</td></tr></tbody></table><h3 id="volumes" tabindex="-1"><a class="header-anchor" href="#volumes"><span>Volumes</span></a></h3><p>Image 中允许使用一些挂载点。根据 Zabbix 组件类型，这些挂载点各不相同：</p><table><thead><tr><th><strong>Volume</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>Zabbix agent</strong></td><td></td></tr><tr><td><em>/etc/zabbix/zabbix_agentd.d</em></td><td>这个 volume 允许包含 *<em>.conf</em> 文件并使用 <code>UserParameter</code> 扩展 Zabbix agent。</td></tr><tr><td><em>/var/lib/zabbix/modules</em></td><td>这个 volume 允许加载其它 module 并使用 <a href="https://www.zabbix.com/documentation/current/zh/manual/config/items/loadablemodules" target="_blank" rel="noopener noreferrer">LoadModule</a> 功能扩展 Zabbix agent。</td></tr><tr><td><em>/var/lib/zabbix/enc</em></td><td>这个 volume 用于存放 TLS 相关的文件。这些文件名使用 <code>ZBX_TLSCAFILE</code>, <code>ZBX_TLSCRLFILE</code>, <code>ZBX_TLSKEY_FILE</code> ，<code>ZBX_TLSPSKFILE</code> 等环境变量指定。</td></tr><tr><td><strong>Zabbix server</strong></td><td></td></tr><tr><td><em>/usr/lib/zabbix/alertscripts</em></td><td>这个 volume 用于自定义告警脚本。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_server" target="_blank" rel="noopener noreferrer">zabbix_server.conf</a> 中的 <code>AlertScriptsPath</code> 参数。</td></tr><tr><td><em>/usr/lib/zabbix/externalscripts</em></td><td>这个 volume 用于 <a href="https://www.zabbix.com/documentation/current/zh/manual/config/items/itemtypes/external" target="_blank" rel="noopener noreferrer">外部检查</a>。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_server" target="_blank" rel="noopener noreferrer">zabbix_server.conf</a> 中的 <code>ExternalScripts</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/modules</em></td><td>这个 volume 允许通过 <a href="https://www.zabbix.com/documentation/current/zh/manual/config/items/loadablemodules" target="_blank" rel="noopener noreferrer">LoadModule</a> 功能加载额外的模块以扩展 Zabbix server。</td></tr><tr><td><em>/var/lib/zabbix/enc</em></td><td>这个 volume 用于存放 TLS 相关的文件。这些文件名使用 <code>ZBX_TLSCAFILE</code>, <code>ZBX_TLSCRLFILE</code>, <code>ZBX_TLSKEY_FILE</code> ，<code>ZBX_TLSPSKFILE</code> 等环境变量指定。</td></tr><tr><td><em>/var/lib/zabbix/ssl/certs</em></td><td>这个 volume 用于存放客户端认证的 SSL 客户端认证文件。即 [zabbix_server.conf] 中的 <code>SSLCertLocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/ssl/keys</em></td><td>这个 volume 用于存放客户端认证的 SSL 私钥文件。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_server" target="_blank" rel="noopener noreferrer">zabbix_server.conf</a> 中的 <code>SSLKeyLocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/ssl/ssl_ca</em></td><td>这个 volume 用于存放 SSL 服务器证书认证的证书颁发机构(CA)文件。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_server" target="_blank" rel="noopener noreferrer">zabbix_server.conf</a> 中的 <code>SSLCALocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/snmptraps</em></td><td>这个 volume 用于存放 snmptraps.log 文件。它可由 zabbix-snmptraps 容器共享，并在创建 Zabbix server 新实例时使用 Docker 的 <code>--volumes-from</code> 选项继承。可以通过共享 volume ，并将 ZBX_ENABLE_SNMP_TRAPS 环境变量切换为 &#39;true&#39; 以启用 SNMP trap 处理功能。</td></tr><tr><td><em>/var/lib/zabbix/mibs</em></td><td>这个 volume 允许添加新的 MIB 文件。它不支持子目录，所有的 MIB 文件必须位于 <code>/var/lib/zabbix/mibs</code> 下。</td></tr><tr><td><strong>Zabbix proxy</strong></td><td></td></tr><tr><td><em>/usr/lib/zabbix/externalscripts</em></td><td>这个 volume 用于 <a href="https://www.zabbix.com/documentation/current/zh/manual/config/items/itemtypes/external" target="_blank" rel="noopener noreferrer">外部检查</a>。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_proxy" target="_blank" rel="noopener noreferrer">zabbix_proxy.conf</a> 中的 <code>ExternalScripts</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/modules</em></td><td>这个 volume 允许通过 <a href="https://www.zabbix.com/documentation/current/zh/manual/config/items/loadablemodules" target="_blank" rel="noopener noreferrer">LoadModule</a> 功能加载额外的模块以扩展 Zabbix server。</td></tr><tr><td><em>/var/lib/zabbix/enc</em></td><td>这个 volume 用于存放 TLS 相关的文件。这些文件名使用 <code>ZBX_TLSCAFILE</code>, <code>ZBX_TLSCRLFILE</code>, <code>ZBX_TLSKEY_FILE</code> ，<code>ZBX_TLSPSKFILE</code> 等环境变量指定。</td></tr><tr><td><em>/var/lib/zabbix/ssl/certs</em></td><td>这个 volume 用于存放客户端认证的 SSL 客户端认证文件。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_proxy" target="_blank" rel="noopener noreferrer">zabbix_proxy.conf</a> 中的 <code>SSLCertLocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/ssl/keys</em></td><td>这个 volume 用于存放客户端认证的 SSL 私钥文件。即 <a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_proxy" target="_blank" rel="noopener noreferrer">zabbix_proxy.conf</a> 中的 <code>SSLKeyLocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/ssl/ssl_ca</em></td><td>这个 volume 用于存放 SSL 服务器证书认证的证书颁发机构(CA)文件。即<a href="https://www.zabbix.com/documentation/current/zh/manual/appendix/config/zabbix_proxy" target="_blank" rel="noopener noreferrer">zabbix_proxy.conf</a> 中的 <code>SSLCALocation</code> 参数。</td></tr><tr><td><em>/var/lib/zabbix/snmptraps</em></td><td>这个 volume 用于存放 snmptraps.log 文件。它可由 zabbix-snmptraps 容器共享，并在创建 Zabbix server 新实例时使用 Docker 的 <code>--volumes-from</code> 选项继承。可以通过共享 volume ，并将 ZBX_ENABLE_SNMP_TRAPS 环境变量切换为 &#39;true&#39; 以启用 SNMP trap 处理功能。</td></tr><tr><td><em>/var/lib/zabbix/mibs</em></td><td>这个 volume 允许添加新的 MIB 文件。它不支持子目录，所有的 MIB 文件必须位于 <code>/var/lib/zabbix/mibs</code> 下。</td></tr><tr><td><strong>基于 Apache2 web 服务器的 Zabbix web 界面</strong></td><td></td></tr><tr><td><em>/etc/ssl/apache2</em></td><td>这个 volume 允许为 Zabbix Web 界面启用 HTTPS。这个 volume 必须包含为 Apache2 SSL 连接准备的 <code>ssl.crt</code> 和 <code>ssl.key</code> 两个文件。</td></tr><tr><td><strong>基于 Nginx web 服务器的 Zabbix web 界面</strong></td><td></td></tr><tr><td><em>/etc/ssl/nginx</em></td><td>这个 volume 允许为 Zabbix Web 接口启用 HTTPS。这个 volume 必须包含为 Nginx SSL 连接装备的 <code>ssl.crt</code> 和 <code>ssl.key</code> 两个文件。</td></tr><tr><td><strong>Zabbix snmptraps</strong></td><td></td></tr><tr><td><em>/var/lib/zabbix/snmptraps</em></td><td>这个 volume 包含了已接收到的 SNMP traps 命名的 <code>snmptraps.log</code>日志文件。</td></tr><tr><td><em>/var/lib/zabbix/mibs</em></td><td>这个 volume 允许添加新的 MIB 文件。它不支持子目录，所有的 MIB 文件必须位于 <code>/var/lib/zabbix/mibs</code> 下。</td></tr></tbody></table><h3 id="案例来自官网" tabindex="-1"><a class="header-anchor" href="#案例来自官网"><span>案例来自官网</span></a></h3><h4 id="示例1" tabindex="-1"><a class="header-anchor" href="#示例1"><span>示例1</span></a></h4><p>该示例示范了如何运行 MySQL 数据库支持的 Zabbix Server 、基于 Nginx Web 服务器的 Zabbix Web 界面和 Zabbix Java 网关。</p><ol><li>创建专用于 Zabbix 组件容器的网络：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker network create --subnet 172.20.0.0/16 --ip-range 172.20.240.0/20 zabbix-net</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>启动空的 MySQL 服务器实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name mysql-server -t \\</span></span>
<span class="line"><span>             -e MYSQL_DATABASE=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_ROOT_PASSWORD=&quot;root_pwd&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -d mysql:8.0 \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             --character-set-server=utf8 --collation-server=utf8_bin \\</span></span>
<span class="line"><span>             --default-authentication-plugin=mysql_native_password</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启动 Zabbix Java 网关实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-java-gateway -t \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-java-gateway:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>启动 Zabbix server 实例，并将其关联到已创建的 MySQL server 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-server-mysql -t \\</span></span>
<span class="line"><span>             -e DB_SERVER_HOST=&quot;mysql-server&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_DATABASE=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_ROOT_PASSWORD=&quot;root_pwd&quot; \\</span></span>
<span class="line"><span>             -e ZBX_JAVAGATEWAY=&quot;zabbix-java-gateway&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -p 10051:10051 \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-server-mysql:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Zabbix server 实例将 10051/TCP 端口（Zabbix trapper）暴露给主机。</p><ol start="5"><li>启动 Zabbix Web 界面，并将其关联到已创建的 MySQL server 和 Zabbix server 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-web-nginx-mysql -t \\</span></span>
<span class="line"><span>             -e ZBX_SERVER_HOST=&quot;zabbix-server-mysql&quot; \\</span></span>
<span class="line"><span>             -e DB_SERVER_HOST=&quot;mysql-server&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_DATABASE=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e MYSQL_ROOT_PASSWORD=&quot;root_pwd&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -p 80:8080 \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-web-nginx-mysql:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Zabbix web 界面实例将 80/TCP 端口（HTTP）暴露给主机。</p><h4 id="示例-2" tabindex="-1"><a class="header-anchor" href="#示例-2"><span><strong>示例 2</strong></span></a></h4><p>该示例示范了如何运行 PostgreSQL 数据库支持的 Zabbix server、基于 Nginx Web 服务器的 Zabbix Web 界面和 SNMP trap功能。</p><ol><li>创建专用于 Zabbix 组件容器的网络：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker network create --subnet 172.20.0.0/16 --ip-range 172.20.240.0/20 zabbix-net</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>启动空的 PostgreSQL server 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name postgres-server -t \\</span></span>
<span class="line"><span>             -e POSTGRES_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_DB=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d postgres:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启动 Zabbix snmptraps 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-snmptraps -t \\</span></span>
<span class="line"><span>             -v /zbx_instance/snmptraps:/var/lib/zabbix/snmptraps:rw \\</span></span>
<span class="line"><span>             -v /var/lib/zabbix/mibs:/usr/share/snmp/mibs:ro \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -p 162:1162/udp \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-snmptraps:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Zabbix snmptrap 实例将 162/UDP 端口（SNMP traps）暴露给主机。</p><ol start="4"><li>启动 Zabbix server 实例，并将其关联到已创建的 PostgreSQL server 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-server-pgsql -t \\</span></span>
<span class="line"><span>             -e DB_SERVER_HOST=&quot;postgres-server&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_DB=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e ZBX_ENABLE_SNMP_TRAPS=&quot;true&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -p 10051:10051 \\</span></span>
<span class="line"><span>             --volumes-from zabbix-snmptraps \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-server-pgsql:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Zabbix server 实例将 10051/TCP 端口（Zabbix trapper）暴露给主机。</p><ol start="5"><li>启动 Zabbix Web 界面，并将其关联到已创建的 PostgreSQL server 和 Zabbix server 实例：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># docker run --name zabbix-web-nginx-pgsql -t \\</span></span>
<span class="line"><span>             -e ZBX_SERVER_HOST=&quot;zabbix-server-pgsql&quot; \\</span></span>
<span class="line"><span>             -e DB_SERVER_HOST=&quot;postgres-server&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_USER=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_PASSWORD=&quot;zabbix_pwd&quot; \\</span></span>
<span class="line"><span>             -e POSTGRES_DB=&quot;zabbix&quot; \\</span></span>
<span class="line"><span>             --network=zabbix-net \\</span></span>
<span class="line"><span>             -p 443:8443 \\</span></span>
<span class="line"><span>             -p 80:8080 \\</span></span>
<span class="line"><span>             -v /etc/ssl/nginx:/etc/ssl/nginx:ro \\</span></span>
<span class="line"><span>             --restart unless-stopped \\</span></span>
<span class="line"><span>             -d zabbix/zabbix-web-nginx-pgsql:alpine-5.4-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Zabbix web 界面实例将 443/TCP 端口（HTTPS）暴露给主机。 <em>/etc/ssl/nginx</em> 目录必须包含具有所需名称的证书。</p><h2 id="zabbix-agent" tabindex="-1"><a class="header-anchor" href="#zabbix-agent"><span>Zabbix-Agent</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ZBX_HOSTNAME=&quot;some-hostname&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ZBX_SERVER_HOST=&quot;some-zabbix-server&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10050:10050</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix/zabbix-agent:5.0.15-ubuntu</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">some-hostname是主机名，是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Zabbix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 代理配置文件中的主机名参数，some-zabbix-server是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Zabbix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 服务器或代理的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 或</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 名称</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="一键部署" tabindex="-1"><a class="header-anchor" href="#一键部署"><span>一键部署</span></a></h2><h3 id="zabbix-server-5-2-mysql-8-0-23" tabindex="-1"><a class="header-anchor" href="#zabbix-server-5-2-mysql-8-0-23"><span>zabbix-server 5.2,mysql 8.0.23</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;3&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# web界面</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-web-nginx-mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix/zabbix-web-nginx-mysql:centos-5.2-latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DB_SERVER_HOST=zabbix-mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_DATABASE=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_USER=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_PASSWORD=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_ROOT_PASSWORD=123qwe</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_SERVER_HOST=zabbix-server-mysql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">8080:8080</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/localtime:/etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/data2/zabbix/fonts/DejaVuSans.ttf:/usr/share/zabbix/assets/fonts/DejaVuSans.ttf</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zbx_net</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix-server-mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix-mysql</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 数据库</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql:8.0.23</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3306:3306</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_DATABASE=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_USER=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_PASSWORD=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_ROOT_PASSWORD=123qwe</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysqld</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">--default-authentication-plugin=mysql_native_password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">--character-set-server=utf8</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">--collation-server=utf8_bin</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/localtime:/etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/data2/zabbix/db:/var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zbx_net</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #  Java 网关容器</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-java-gateway</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix/zabbix-java-gateway:centos-5.2-latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/localtime:/etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zbx_net</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Zabbix server容器</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-server-mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix/zabbix-server-mysql:centos-5.2-latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix-server-vol:/etc/zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/data2/zabbix/alertscripts:/usr/lib/zabbix/alertscripts</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/localtime:/etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">10051:10051</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DB_SERVER_HOST=zabbix-mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_DATABASE=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_USER=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_PASSWORD=zabbix</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MYSQL_ROOT_PASSWORD=123qwe</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_JAVAGATEWAY=zabbix-java-gateway</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_JAVAGATEWAY_ENABLE=true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_JAVAGATEWAYPORT=10052</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix-mysql</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zbx_net</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 探针</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-agent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zabbix/zabbix-agent:centos-5.2-latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">10050:10050</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_HOSTNAME=Zabbix server</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_SERVER_HOST=zabbix-server-mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ZBX_SERVER_PORT=10051</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zbx_net</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zbx_net</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    driver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">bridge</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  zabbix-server-vol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解决汉化bug</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alertscripts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> db</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fonts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fonts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://dl.cactifans.com/zabbix_docker/msty.ttf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> msty.ttf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DejaVuSans.ttf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><s>原x启动</s> 错台了，启动容器</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>访问浏览器8080端口</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">用户名Admin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">密码zabbix</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="agent" tabindex="-1"><a class="header-anchor" href="#agent"><span>Agent</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">version:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;3&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">services:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  zabbix-agent:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    container_name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    environment:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ZBX_HOSTNAME=some-hostname</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ZBX_SERVER_HOST=some-zabbix-server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ports:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10050:10050</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    image:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix/zabbix-agent:5.2-ubuntu-latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,53)]))}const d=i(l,[["render",t],["__file","zabbix使用容器方式部署.html.vue"]]),h=JSON.parse('{"path":"/note-book/Zabbix/zabbix%E4%BD%BF%E7%94%A8%E5%AE%B9%E5%99%A8%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2.html","title":"zabbix使用容器方式部署","lang":"zh-CN","frontmatter":{"description":"zabbix使用容器方式部署 近期做了一些民间项目，不需要极好的可靠性，要求快速部署和删除。所以做了个Docker方案。进行记录 参考资料： zabbix-docker镜像构建的文档在这里 https://github.com/zabbix/zabbix-docker 该页面所有资料来自官网 https://www.zabbix.com/documen...","head":[["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/Zabbix/zabbix%E4%BD%BF%E7%94%A8%E5%AE%B9%E5%99%A8%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"zabbix使用容器方式部署"}],["meta",{"property":"og:description","content":"zabbix使用容器方式部署 近期做了一些民间项目，不需要极好的可靠性，要求快速部署和删除。所以做了个Docker方案。进行记录 参考资料： zabbix-docker镜像构建的文档在这里 https://github.com/zabbix/zabbix-docker 该页面所有资料来自官网 https://www.zabbix.com/documen..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-19T08:31:50.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-19T08:31:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"zabbix使用容器方式部署\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-19T08:31:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"PaperDragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"]]},"git":{"createdTime":1704338647000,"updatedTime":1710837110000,"contributors":[{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":2,"url":"https://github.com/PaperDragon-SH"}]},"readingTime":{"minutes":7.81,"words":2344},"filePathRelative":"note-book/Zabbix/zabbix使用容器方式部署.md","localizedDate":"2024年1月4日","excerpt":"\\n<blockquote>\\n<p>近期做了一些民间项目，不需要极好的可靠性，要求快速部署和删除。所以做了个Docker方案。进行记录</p>\\n<p>参考资料：</p>\\n<ul>\\n<li>zabbix-docker镜像构建的文档在这里\\n<ul>\\n<li>https://github.com/zabbix/zabbix-docker</li>\\n</ul>\\n</li>\\n<li>该页面所有资料来自官网\\n<ul>\\n<li>https://www.zabbix.com/documentation/current/zh/manual/installation/containers</li>\\n</ul>\\n</li>\\n</ul>\\n</blockquote>","autoDesc":true}');export{d as comp,h as data};
