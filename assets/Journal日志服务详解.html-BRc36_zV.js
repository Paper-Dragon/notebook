import{a as i,c as a,g as n,o as l}from"./app-Cf8kexEb.js";const t={};function e(h,s){return l(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="journal日志服务详解" tabindex="-1"><a class="header-anchor" href="#journal日志服务详解"><span>Journal日志服务详解</span></a></h1><h2 id="journal日志服务" tabindex="-1"><a class="header-anchor" href="#journal日志服务"><span>Journal日志服务</span></a></h2><blockquote><p>journalctl 用来查询 systemd-journald 服务收集到的日志。systemd-journald 服务是 systemd init 系统提供的收集系统日志的服务。</p></blockquote><p>常用命令行</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看所有日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --disk-usage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 用于查看目前日志占用了多少磁盘空间</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看最新的4行日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --since=2020-06-23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看从2020-06-23开始的日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --since=13:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看从13:00开始的日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --until=2020-06-23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看截止到2020-06-23的日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --until=13:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看截止到13:00的日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --since</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --until</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看某一时间段内的日志</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> err</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看error级别的日志（同理可改为info、warning等级别）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> verbose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看日志详细信息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> _PID=num</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> _COMM=sshd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 查看特定pid和特定命令的日志信息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/var/log/journal/2019100817110995251777489178452/system.journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 清空当前正在记录的日志文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --vacuum-time=1m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 仅保留最近一个月的日志文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">journalctl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --vacuum-size=500M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 仅保留500MB大小的日志文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemd-journald</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 服务控制</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置文件参数详解" tabindex="-1"><a class="header-anchor" href="#配置文件参数详解"><span>配置文件参数详解</span></a></h2><blockquote><p>配置文件所在位置：/etc/systemd/journald.conf默认状态所有选项均为注释状态</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Journal]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Storage</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">auto</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           #存储日志文件位置（&quot;volatile&quot; 表示仅保存在内存中，路径：/run/log/journal 、&quot;persistent&quot; 表示优先保存在磁盘上，路径：优先保存在 /var/log/journal、&quot;auto&quot;默认值、&quot;none&quot;不保存任何日志）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Compress</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yes</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            #压缩存储大于特定阈值的对象</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Seal</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yes</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          #如果存在一个&quot;sealing key&quot;， 那么就为所有持久保存的日志文件启用 FSS验证</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SplitMode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uid</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #是否按用户进行日志分割（分割策略：&quot;uid&quot; 表示每个用户都有专属日志文件系统用户仍写进系统日志，&quot;none&quot; 不进行日志分割，所有用户日志均写进系统日志</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SyncIntervalSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">5m</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #向磁盘刷写日志时间间隔（error以上，不含error级别日志会立即刷写）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RateLimitInterval</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">30s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RateLimitBurst</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1000</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #上下两个选项表示在30s内每个服务最多纪录1000条日志，多余日志丢弃</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SystemMaxUse</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       #全部日志最大占用磁盘空间</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SystemKeepFree</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #除日志文件之外，至少保留多少空间给其他用途（磁盘）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SystemMaxFileSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #单个日志文件最大占用磁盘空间</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RuntimeMaxUse</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      #全部日志最大占用内存空间</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RuntimeKeepFree</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #除日志文件之外，至少保留多少空间给其他用途（内存）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">RuntimeMaxFileSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #单个日志文件最大占用内存大小</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxRetentionSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      #日志文件最大保留期限（超过该时间自动删除）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxFileSec</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1month</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #日志滚动时间间隔</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ForwardToSyslog</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yes</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #表示是否将接收到的日志消息转发给传统的 syslog 守护进程</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ForwardToKMsg</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">no</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #表示是否将接收到的日志消息转发给内核日志缓冲区(kmsg)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ForwardToConsole</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">no</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #表示是否将接收到的日志消息转发给系统控制台</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ForwardToWall</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yes</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      #表示是否将接收到的日志消息作为警告信息发送给所有已登录用户</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TTYPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/console</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxLevelStore</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">debug</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      #表示记录到日志中的最高日志等级</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxLevelSyslog</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">debug</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #转发给syslog进程的最高日志等级</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxLevelKMsg</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">notice</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #转发给内核日志缓冲区(kmsg)的最高日志等级</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxLevelConsole</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">info</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #转发给系统控制台的最高日志等级</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MaxLevelWall</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">emerg</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #置作为警告信息发送给所有已登录用户的最高日志等级</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LineMax</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">48K</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #每条日志记录最大的字节长度，超长部分自动打分割符进行分割</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">~</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8)])])}const p=i(t,[["render",e]]),r=JSON.parse('{"path":"/note-book/OperaSystems/Journal%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1%E8%AF%A6%E8%A7%A3.html","title":"Journal日志服务详解","lang":"zh-CN","frontmatter":{"description":"Journal日志服务详解 Journal日志服务 journalctl 用来查询 systemd-journald 服务收集到的日志。systemd-journald 服务是 systemd init 系统提供的收集系统日志的服务。 常用命令行 配置文件参数详解 配置文件所在位置：/etc/systemd/journald.conf默认状态所有选项均...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Journal日志服务详解\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-08-13T15:08:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/OperaSystems/Journal%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1%E8%AF%A6%E8%A7%A3.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"Journal日志服务详解"}],["meta",{"property":"og:description","content":"Journal日志服务详解 Journal日志服务 journalctl 用来查询 systemd-journald 服务收集到的日志。systemd-journald 服务是 systemd init 系统提供的收集系统日志的服务。 常用命令行 配置文件参数详解 配置文件所在位置：/etc/systemd/journald.conf默认状态所有选项均..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-08-13T15:08:38.000Z"}],["meta",{"property":"article:modified_time","content":"2023-08-13T15:08:38.000Z"}]]},"git":{"createdTime":1691939318000,"updatedTime":1691939318000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"}],"changelog":[{"hash":"392a519398b2e846f316619fbe831e100164de7c","time":1691939318000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"Create The Worid!"}]},"readingTime":{"minutes":2.99,"words":897},"filePathRelative":"note-book/OperaSystems/Journal日志服务详解.md","excerpt":"\\n<h2>Journal日志服务</h2>\\n<blockquote>\\n<p>journalctl 用来查询 systemd-journald 服务收集到的日志。systemd-journald 服务是 systemd init 系统提供的收集系统日志的服务。</p>\\n</blockquote>\\n<p>常用命令行</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看所有日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --disk-usage</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 用于查看目前日志占用了多少磁盘空间</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -n</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 4</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看最新的4行日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --since=2020-06-23</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看从2020-06-23开始的日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --since=13:00</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看从13:00开始的日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --until=2020-06-23</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看截止到2020-06-23的日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --until=13:00</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看截止到13:00的日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --since</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> time</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --until</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> time</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看某一时间段内的日志</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -p</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> err</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看error级别的日志（同理可改为info、warning等级别）</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -o</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> verbose</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看日志详细信息</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> _PID=num</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> _COMM=sshd</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 查看特定pid和特定命令的日志信息</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">echo</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&gt; </span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">/var/log/journal/2019100817110995251777489178452/system.journal</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 清空当前正在记录的日志文件</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --vacuum-time=1m</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 仅保留最近一个月的日志文件</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">journalctl</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --vacuum-size=500M</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 仅保留500MB大小的日志文件</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">systemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> restart</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> systemd-journald</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 服务控制</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{p as comp,r as data};
