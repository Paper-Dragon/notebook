import{ah as i,ai as a,ar as n,am as l}from"./app-BgSOjJC8.js";const e={};function h(k,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h1 id="docker打造最小容器minibash" tabindex="-1"><a class="header-anchor" href="#docker打造最小容器minibash"><span>Docker打造最小容器MiniBash</span></a></h1><h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h2><p>突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。</p><h2 id="制作方法" tabindex="-1"><a class="header-anchor" href="#制作方法"><span>制作方法</span></a></h2><p>这个最小化容器制作方法是</p><ul><li>找到目标程序</li><li>定位动态链接库</li><li>提取所有动态连接库</li><li>封装为docker</li><li>docker作为镜像导入</li></ul><h2 id="运行" tabindex="-1"><a class="header-anchor" href="#运行"><span>运行</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jockerdragon/mini_bash:5.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="构建" tabindex="-1"><a class="header-anchor" href="#构建"><span>构建</span></a></h2><p>克隆单个分支</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mini_bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --single-branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/Paper-Dragon/docker-sh.git</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docker-sh/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>打包为docker可识别的rootfs</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -cvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ../bash.tar</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ls</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -lh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>压缩包近3.5M</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3.5M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  4月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:25</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bash.tar</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>导入</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bash.tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jockerdragon/mini_bash:5.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sha256:7cc56da0013130d77639ffb0c137ac755d66dc39474d7321ae9642e7ebb1d0fb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>运行和测试</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># docker run -it jockerdragon/mini_bash:5.0 bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@71d003f24aed /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">!          ]]         break      command    coproc     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       esac       false      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   if</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">         local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      pushd</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      return</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">     source</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">     times</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      ulimit</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">     wait</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      builtin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    compgen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    declare</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       eval</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       fc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         getopts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         logout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     pwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        select</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     suspend</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    trap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       umask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      while</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          bash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       caller</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     complete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   dirs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       elif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       fg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         hash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       jobs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       mapfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        test</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       true</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       unalias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[          bg         case       compopt    disown     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       exit       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         help       kill       popd       readarray  shift      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       type       unset      }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[[         bind       cd         continue   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         enable     export     for        history    let        printf     readonly   shopt      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       typeset    until</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@71d003f24aed /]# pwd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@71d003f24aed /]# times</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0m0.016s 0m0.016s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0m0.002s 0m0.001s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@71d003f24aed /]#</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="制作过程" tabindex="-1"><a class="header-anchor" href="#制作过程"><span>制作过程</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/lib/terminfo/x/xterm:/lib/terminfo/x/xterm</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@k8s-master:~/bash-rootfs]# ldd */*/*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/terminfo/x:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ldd:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib/terminfo/x:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> regular</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libc-2.31.so:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f095b3dd000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffd18dad000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libc.so.6:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f5b66c6e000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffe385fc000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libdl-2.31.so:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffeaf278000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fafd2433000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fafd2634000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libdl.so.2:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fff1b3f6000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f6332566000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f6332767000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libtinfo.so.6:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffd91d81000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fa907fe9000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fa908214000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libtinfo.so.6.2:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffe46d77000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f461ee4c000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007f461f077000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usr/bin/bash:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffd49df6000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libtinfo.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libtinfo.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fd3a5d24000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libdl.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libdl.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fd3a5d1e000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fd3a5b2c000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fd3a5e89000)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@k8s-master:~/bash-rootfs]# docker run -it --rm  jockerdragon/bash:5.0 bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@d3af07f8866b /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@d3af07f8866b /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@k8s-master:~/bash-rootfs]# tar -cvf ../bash.tar *</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">etc/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">etc/bash.bashrc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libc-2.31.so</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libtinfo.so.6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libdl-2.31.so</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libtinfo.so.6.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libdl.so.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/x86_64-linux-gnu/libc.so.6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/terminfo/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/terminfo/x/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib/terminfo/x/xterm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lib64/ld-linux-x86-64.so.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usr/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usr/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">usr/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@k8s-master:~/bash-rootfs]# docker import ../bash.tar</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sha256:dfdc13f29846288fc47e830dd687e28978efc1fbf7888165a7fbf72560dcacbc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@k8s-master:~/bash-rootfs]#</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,21)]))}const p=i(e,[["render",h]]),d=JSON.parse('{"path":"/note-book/Docker/Docker%E6%89%93%E9%80%A0%E6%9C%80%E5%B0%8F%E5%AE%B9%E5%99%A8MiniBash.html","title":"Docker打造最小容器MiniBash","lang":"zh-CN","frontmatter":{"description":"Docker打造最小容器MiniBash 介绍 突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。 制作方法 这个最小化容器制作方法是 找到目标程序 定位动态链接库 提取所有动态连接库 封装为docker docker作为镜像导入 运行 构建 克隆单个分支 打包为docker...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker打造最小容器MiniBash\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-17T03:28:49.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/Docker/Docker%E6%89%93%E9%80%A0%E6%9C%80%E5%B0%8F%E5%AE%B9%E5%99%A8MiniBash.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"Docker打造最小容器MiniBash"}],["meta",{"property":"og:description","content":"Docker打造最小容器MiniBash 介绍 突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。 制作方法 这个最小化容器制作方法是 找到目标程序 定位动态链接库 提取所有动态连接库 封装为docker docker作为镜像导入 运行 构建 克隆单个分支 打包为docker..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-17T03:28:49.000Z"}],["meta",{"property":"article:modified_time","content":"2024-06-17T03:28:49.000Z"}]]},"git":{"createdTime":1713434796000,"updatedTime":1718594929000,"contributors":[{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":2,"url":"https://github.com/PaperDragon-SH"}],"changelog":[{"hash":"e62d801e02931b6acb97ded0454ab8b57b11e033","time":1718594929000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"解决一些用tab符合代替代码类型的markdown符号错误"},{"hash":"987844036d4fd868295c798aa33e2c3c41a44f44","time":1713434796000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"Docker打造最小容器MiniBash"}]},"readingTime":{"minutes":1.72,"words":517},"filePathRelative":"note-book/Docker/Docker打造最小容器MiniBash.md","excerpt":"\\n<h2>介绍</h2>\\n<p>突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。</p>\\n<h2>制作方法</h2>\\n<p>这个最小化容器制作方法是</p>\\n<ul>\\n<li>找到目标程序</li>\\n<li>定位动态链接库</li>\\n<li>提取所有动态连接库</li>\\n<li>封装为docker</li>\\n<li>docker作为镜像导入</li>\\n</ul>\\n<h2>运行</h2>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">docker</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> run</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -it</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> jockerdragon/mini_bash:5.0</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> bash</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{p as comp,d as data};
