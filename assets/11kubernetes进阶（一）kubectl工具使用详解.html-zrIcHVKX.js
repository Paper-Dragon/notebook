import{ah as s,ai as e,ar as a,am as n}from"./app-C4YHAxwb.js";const l="/assets/1034759-20191120162038299-1719142838-VJ9cE9JV.png",t="/assets/1034759-20191120163051927-1329056471-BKepF8BH.png",h="/assets/1034759-20191120163157819-1947277387-B77Ya2-3.png",d="/assets/1034759-20191120181727487-1964819809-CTD2qPR4.png",r="/assets/1034759-20191120182326063-1712655305-BUpqn5Az.png",p="/assets/1034759-20191120183446194-77387750-Czb89zJC.png",k="/assets/1034759-20191120184142792-1084906192-DrplFc-9.png",c="/assets/1034759-20191120184830277-1576468381-Bu55hvD0.png",o="/assets/1034759-20191120191239821-1469821172-B2yi-WdA.png",g="/assets/1034759-20191120191254127-1868023507-MIPNOnd9.png",b="/assets/1034759-20191120190417014-1885879823-B4Znx1SE.png",u="/assets/1034759-20191120190609614-39153588-B1nKpVuK.png",m="/assets/1034759-20191120190907800-107826727-Cd4LaOtG.png",v="/assets/1034759-20191120191007242-742957714-nTxaTdvP.png",A="/assets/1034759-20191120191351319-1327643689-vhJ9bvrI.png",y="/assets/1034759-20191120192527111-2002912807-Cjuv2viB.png",f="/assets/1034759-20191121151749735-1039780189-D-0p-i-c.png",F="/assets/1034759-20191121152848475-1793715531-CWM1Oxor.png",_="/assets/1034759-20191121183313312-407916940-noLP_BsO.png",E="/assets/1034759-20191121184355023-942641319-CxBWttji.png",B={};function x(C,i){return n(),e("div",null,i[0]||(i[0]=[a(`<h1 id="kubernetes进阶-一-kubectl工具使用详解" tabindex="-1"><a class="header-anchor" href="#kubernetes进阶-一-kubectl工具使用详解"><span>kubernetes进阶（一）kubectl工具使用详解</span></a></h1><h2 id="管理k8s核心资源的三种基本方法" tabindex="-1"><a class="header-anchor" href="#管理k8s核心资源的三种基本方法"><span>管理k8s核心资源的三种基本方法</span></a></h2><h3 id="_1-陈述式-主要依赖命令行工具" tabindex="-1"><a class="header-anchor" href="#_1-陈述式-主要依赖命令行工具"><span>1. 陈述式 - 主要依赖命令行工具</span></a></h3><ul><li>可以满足90%以上的使用场景，但是缺点也很明显：</li></ul><p>命令冗长，复杂，难以记忆</p><p>特定场景下，无法实现管理需求</p><p>对资源的增、删、查操作比较容易，改比较麻烦，需要patch来使用json串来更改。</p><h3 id="_1-1-查看名称空间" tabindex="-1"><a class="header-anchor" href="#_1-1-查看名称空间"><span>1.1 查看名称空间</span></a></h3><p>查询时，为了避免重名，需要指定名称空间。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get namespace</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">简写：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get ns</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+l+`" alt="img"></p><h3 id="_1-2-查询命名空间中的资源" tabindex="-1"><a class="header-anchor" href="#_1-2-查询命名空间中的资源"><span>1.2 查询命名空间中的资源</span></a></h3><p>使用-n 指定命名空间</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get all -n default</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get pods -n default</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get nodes -n default</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-创建命名空间" tabindex="-1"><a class="header-anchor" href="#_1-3-创建命名空间"><span>1.3 创建命名空间</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl create ns app</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+t+'" alt="img"></p><h3 id="_1-4-删除命名空间" tabindex="-1"><a class="header-anchor" href="#_1-4-删除命名空间"><span>1.4 删除命名空间</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl delete ns app</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+h+`" alt="img"></p><h3 id="_1-5-创建一个deployment类型的pod控制器" tabindex="-1"><a class="header-anchor" href="#_1-5-创建一个deployment类型的pod控制器"><span>1.5 创建一个deployment类型的pod控制器</span></a></h3><p>PS:1.16版本以后，控制器有变化，具体变化参考k8s官网。</p><p>pod控制器类型参考：<a href="https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/</a></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl create deployment nginx-dp --image=harbor.od.com/public/nginx:v1.7.9 -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get deploy -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+d+`" alt="img"></p><h3 id="_1-6-查看pod控制器或者pod概览信息" tabindex="-1"><a class="header-anchor" href="#_1-6-查看pod控制器或者pod概览信息"><span>1.6 查看pod控制器或者pod概览信息</span></a></h3><p>-o wide</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get deploy -o wide -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get pod -o wide -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+r+`" alt="img"></p><h3 id="_1-7-查看pod控制器、pod、service等资源的详细信息" tabindex="-1"><a class="header-anchor" href="#_1-7-查看pod控制器、pod、service等资源的详细信息"><span>1.7 查看pod控制器、pod、service等资源的详细信息</span></a></h3><p>describe</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl describe deploy nginx-dp -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl describe pod nginx-dp-5dfc689474-4bhfh -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl describe svc nginx-dp -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>详细信息太多，就不截图了。</p><h3 id="_1-8-进入pod容器" tabindex="-1"><a class="header-anchor" href="#_1-8-进入pod容器"><span>1.8 进入pod容器</span></a></h3><p>用法和docker exec一致，但是需要使用-n 指定命名空间</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl exec -ti nginx-dp-5dfc689474-4bhfh /bin/bash -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+p+'" alt="img"></p><h3 id="_1-9-删除pod容器" tabindex="-1"><a class="header-anchor" href="#_1-9-删除pod容器"><span>1.9 删除pod容器</span></a></h3><p>此删除，只是删除了pod容器，并没有删除pod控制器，所以此操作相当于删除pod后，pod控制器在拉起一个新的pod。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl delete pods nginx-dp-5dfc689474-4bhfh -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+k+'" alt="img"></p><p>可以看到我们删除pod以后，pod控制器又帮我们从新拉起了一个新的pod，想要完全删除，需要删除pod控制器。</p><h3 id="_1-10-删除pod控制器" tabindex="-1"><a class="header-anchor" href="#_1-10-删除pod控制器"><span>1.10 删除pod控制器</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl delete deploy nginx-dp -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+c+'" alt="img"></p><p>可以看到，当我们删除了pod控制器以后，pod容器也随之被删除了。</p><h3 id="_1-11-扩容pod" tabindex="-1"><a class="header-anchor" href="#_1-11-扩容pod"><span>1.11 扩容pod</span></a></h3><p>--replicas=数量</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl scale deployment nginx-dp --replicas=2 -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+o+'" alt="img"></p><p><img src="'+g+`" alt="img"></p><h3 id="_1-12-管理service资源" tabindex="-1"><a class="header-anchor" href="#_1-12-管理service资源"><span>1.12 管理service资源</span></a></h3><p>为pod资源提供稳定的接入点</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl create deploy nginx-dp --image=harbor.od.com/public/nginx:v1.7.9</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl expose deploy nginx-dp --port=80 -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+b+'" alt="img"></p><p>看到我们已经创建了一个service资源，可以通过192.168.234.234的80访问到后面pod，为了解决pod漂移导致IP变化的问题</p><p>可以使用ipvsadm -Ln来查看：nq为ipvs调度算法中的一种，其他调度算法请自行查阅。</p><p><img src="'+u+'" alt="img"></p><p>我们通过删除pod的方式，让pod漂移到另一台node节点，再来查看一下：</p><p><img src="'+m+'" alt="img"></p><p>可以看到，虽然pod漂移了，但是service资源提供的接入点是不变的，这得益于ipvs的强大。</p><p><img src="'+v+'" alt="img"></p><p><img src="'+A+`" alt="img"></p><h3 id="_1-13-查看资源配置清单详细信息" tabindex="-1"><a class="header-anchor" href="#_1-13-查看资源配置清单详细信息"><span>1.13 查看资源配置清单详细信息</span></a></h3><p>-o yaml</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get pod nginx-dp-5dfc689474-c5r9r -o yaml -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get deploy nginx-dp -o yaml -n kube-public</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get svc -o yaml -n kube-public</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-14-查看属性的定义及用法" tabindex="-1"><a class="header-anchor" href="#_1-14-查看属性的定义及用法"><span>1.14 查看属性的定义及用法</span></a></h3><p>例：查看service资源下metadata的定义及用法</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl explain service.metadata</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+y+`" alt="img"></p><h3 id="_2-声明式-依赖统一资源配置清单-manifest-yaml-json" tabindex="-1"><a class="header-anchor" href="#_2-声明式-依赖统一资源配置清单-manifest-yaml-json"><span>2. 声明式 - 依赖统一资源配置清单（manifest）yaml/json</span></a></h3><h3 id="_2-1-创建一个svc资源配置清单" tabindex="-1"><a class="header-anchor" href="#_2-1-创建一个svc资源配置清单"><span>2.1 创建一个svc资源配置清单</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vi nginx-ds-svc.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  labels</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx-ds</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx-ds</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">default</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">TCP</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    targetPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  selector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx-ds</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  sessionAffinity</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">None</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ClusterIP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl create -f nginx-ds-svc.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+f+'" alt="img"></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl get svc nginx-ds -o yaml -n default</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+F+`" alt="img"></p><h3 id="_2-2-离线修改资源配置清单" tabindex="-1"><a class="header-anchor" href="#_2-2-离线修改资源配置清单"><span>2.2 离线修改资源配置清单</span></a></h3><p>修改资源配置清单后可以使用apply应用。</p><p>这里增加一个知识点，就是kube-apiserver这个服务当中，有一个限制端口范围的参数：--service-node-port-range 10-29999，这个参数在使用apply修改资源配置清单的时候，会有作用</p><p>如果修改后的资源配置清单中的port不在这个范围，会报错，修改这个以后，重启kube-apiserver即可。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vi nginx-ds-svc.yaml #将对外暴露的端口改为881</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl apply -f nginx-ds-svc.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到端口从80变成了881</p><p><img src="`+_+'" alt="img"></p><p>修改资源配置清单分为在线修改和离线修改（推荐离线修改）：</p><h3 id="_2-3-在线修改" tabindex="-1"><a class="header-anchor" href="#_2-3-在线修改"><span>2.3 在线修改</span></a></h3><p>我这里使用在线修改，将端口修改为888</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl edit svc nginx-ds -n default</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+E+'" alt="img"></p><p>2.4 删除资源：</p><p>2.4.1 陈述式：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl delete svc nginx-ds -n default</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>2.4.2 声明式：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># kubectl delete -f nginx-ds-svc.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_3-gui式-主要依赖图形化操作界面-web界面" tabindex="-1"><a class="header-anchor" href="#_3-gui式-主要依赖图形化操作界面-web界面"><span>3. GUI式 - 主要依赖图形化操作界面（web界面）</span></a></h2><ul><li>推荐kubectl插件：Lens、K9s、Kuboard、Rancher等。</li></ul>',97)]))}const D=s(B,[["render",x]]),q=JSON.parse('{"path":"/note-book/Kubernetes/11kubernetes%E8%BF%9B%E9%98%B6%EF%BC%88%E4%B8%80%EF%BC%89kubectl%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3.html","title":"kubernetes进阶（一）kubectl工具使用详解","lang":"zh-CN","frontmatter":{"description":"kubernetes进阶（一）kubectl工具使用详解 管理k8s核心资源的三种基本方法 1. 陈述式 - 主要依赖命令行工具 可以满足90%以上的使用场景，但是缺点也很明显： 命令冗长，复杂，难以记忆 特定场景下，无法实现管理需求 对资源的增、删、查操作比较容易，改比较麻烦，需要patch来使用json串来更改。 1.1 查看名称空间 查询时，为了...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"kubernetes进阶（一）kubectl工具使用详解\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-19T06:16:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/Kubernetes/11kubernetes%E8%BF%9B%E9%98%B6%EF%BC%88%E4%B8%80%EF%BC%89kubectl%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"kubernetes进阶（一）kubectl工具使用详解"}],["meta",{"property":"og:description","content":"kubernetes进阶（一）kubectl工具使用详解 管理k8s核心资源的三种基本方法 1. 陈述式 - 主要依赖命令行工具 可以满足90%以上的使用场景，但是缺点也很明显： 命令冗长，复杂，难以记忆 特定场景下，无法实现管理需求 对资源的增、删、查操作比较容易，改比较麻烦，需要patch来使用json串来更改。 1.1 查看名称空间 查询时，为了..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-19T06:16:02.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-19T06:16:02.000Z"}]]},"git":{"createdTime":1691939318000,"updatedTime":1745043362000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"},{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":3,"url":"https://github.com/PaperDragon-SH"},{"name":"PaperDragon","username":"PaperDragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/PaperDragon"}],"changelog":[{"hash":"f07b24e1f3b68c2db155398861853eb1e2c0f786","time":1745043362000,"email":"2678885646@qq.com","author":"PaperDragon","message":"清理死链"},{"hash":"d9487231a8c7ade839488b74acab413e440a9cab","time":1709799304000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"sort"},{"hash":"329c05566875f8b7320455be7720e58a1b38ee9d","time":1709797247000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"kubernetes进阶（一）kubectl工具使用详解"},{"hash":"8b594e45afc037a9073e6cf46b3a057de0c3e3e7","time":1709797028000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"kubernetes进阶（一）kubectl工具使用详解"},{"hash":"392a519398b2e846f316619fbe831e100164de7c","time":1691939318000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"Create The Worid!"}]},"readingTime":{"minutes":4.84,"words":1452},"filePathRelative":"note-book/Kubernetes/11kubernetes进阶（一）kubectl工具使用详解.md","excerpt":"\\n<h2>管理k8s核心资源的三种基本方法</h2>\\n<h3>1. 陈述式 - 主要依赖命令行工具</h3>\\n<ul>\\n<li>可以满足90%以上的使用场景，但是缺点也很明显：</li>\\n</ul>\\n<p>命令冗长，复杂，难以记忆</p>\\n<p>特定场景下，无法实现管理需求</p>\\n<p>对资源的增、删、查操作比较容易，改比较麻烦，需要patch来使用json串来更改。</p>\\n<h3>1.1 查看名称空间</h3>\\n<p>查询时，为了避免重名，需要指定名称空间。</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># kubectl get namespace</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">简写：</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># kubectl get ns</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{D as comp,q as data};
