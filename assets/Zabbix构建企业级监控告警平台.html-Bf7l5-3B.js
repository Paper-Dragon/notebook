import{ah as i,ai as a,ar as n,am as h}from"./app-BsML8ihm.js";const l="/assets/image-20211111103246790-16365979687501-Cg7tL1dq.png",t="/assets/login-Dp21Asa0.png",e="/assets/maindashboard-BOhocraC.png",p="/assets/20201027190120585-CkRQywYs.png",k="/assets/changelanguage-GgefjxDr.png",r="/assets/cndashboard-DlfBK-wV.png",d="/assets/20210208165851713-DM9fgKNT.png",g="/assets/agentconfserver-pea-wmcq.png",A="/assets/activeServer-By1Ts7xZ.png",B="/assets/agenthostname-CU1q7oHb.png",c="/assets/hostgroup-X6nIHxuU.png",y="/assets/confighostgroup-CczBckt9.png",F="/assets/addhost-CzD7qlFn.png",o="/assets/hostlinkgroup-CmJxuH8d.png",b="/assets/linkmod01-CRJJY2QO.png",m="/assets/linkmodgraph-Pqn4Apic.png",u="/assets/linkmod02-D37szSLC.png",C="/assets/linkmod03-BeJCoQEO.png",E="/assets/linkmod04-ByxmwBwp.png",v="/assets/linkmod05-CwP6yoH2.png",x="/assets/linkmod06-Bo9nlO_b.png",f="/assets/linkmod07-Ce2k7RH4.png",_="/assets/checkmod01-I0UXSN7N.png",D="/assets/checkmod02-DF6L1J4-.png",z="/assets/whilefail-mwXZK1j9.png",q="/assets/20210208164134554-sY-sehWl.png",T="/assets/20210208164049758-D_tQ8E_9.png",w="/assets/pre-require-success-DcZ4HMAm.png",I="/assets/image-20211111154251931-D9bBPNQG.png",S="/assets/image-20211111154338090-BScj5AB0.png",N="/assets/image-20211111155148598-BIJOhEVo.png",P="/assets/image-20211111155541026-CdarNqLD.png",$="/assets/image-20211111160644405-ta_PcCZV.png",M="/assets/image-20211111170552282-B4kUaQJU.png",Z="/assets/image-20211111164757594-ReXfOTRN.png",R="/assets/image-20211111172407040-Bka5dKlW.png",V="/assets/image-20211111173426460-DKhk9BGq.png",H="/assets/image-20211111175038429-8Bx6KhdX.png",O="/assets/image-20211111184515078-CcqFbsrV.png",U="/assets/image-20211111185909781-163662835116850-3dbew7wh.png",G="/assets/image-20211111192234039-DJq1cepE.png",L="/assets/image-20211111201253785-CZxvtw88.png",W="/assets/linkemail01-CO_hhg3z.png",K="/assets/image-20211112075406077-163667484785953-4GpvJuhw.png",Y="/assets/image-20211112080619306-7lpoxGfH.png",Q="/assets/image-20211112081040025-Ck1juWAc.png",X="/assets/image-20211112081323188-CbAfj9DC.png",J="/assets/image-20211112081431474-N3kDPO9-.png",j="/assets/image-20211112081525726-BsegvWws.png",ss="/assets/image-20211112081716621-B3Q7xptB.png",is="/assets/image-20211112082124999-DphzUAwv.png",as="/assets/image-20211112082343476-DLOwNdKf.png",ns="/assets/image-20211112082514028-D6Zxairf.png",hs="/assets/image-20211112082950282-CfoJ6sbC.png",ls="/assets/image-20211112083224765-DvIOwKqf.png",ts="/assets/image-20211112092251314-Y2XvV_30.png",es="/assets/image-20211112092308452-CFovgbIk.png",ps="/assets/image-20211112101855500-BQEGuwV7.png",ks="/assets/image-20211112103325012-YzzOMclq.png",rs="/assets/image-20211112104449707-B89FIJot.png",ds="/assets/image-20211112104551488-DORE_3xE.png",gs="/assets/image-20211112113333108-CFh3Z832.png",As="/assets/image-20211112113513283-BuyAResd.png",Bs="/assets/image-20211112113741760-DXIw8LPe.png",cs="/assets/image-20211112113812492-DfRbZXKu.png",ys="/assets/image-20211112115030073-tU7ewnoq.png",Fs="/assets/image-20211112121444278-d_qYmWNQ.png",os="/assets/image-20211112121454147-BqQy8YJx.png",bs="/assets/image-20211112123239292-CXpyzCJ7.png",ms="/assets/image-20211112123249323-Ku8eun48.png",us="/assets/image-20211112123209567-DfNt6S2R.png",Cs="/assets/image-20211112135629262-cY1iU8MY.png",Es="/assets/image-20211112135854785-Dmh6RLaq.png",vs="/assets/image-20211112140423794-CI1D4SM0.png",xs="/assets/image-20211112141129553-CNcft47X.png",fs="/assets/image-20211112141400020-CV0u89XO.png",_s="/assets/image-20211112141542190-BEiA2a9p.png",Ds="/assets/image-20211112141644037-fdMgpqix.png",zs="/assets/image-20211112142240335-DpX20JC5.png",qs="/assets/image-20211112142443866-BD2Und5r.png",Ts="/assets/image-20211112143132350-DwcQjAJR.png",ws="/assets/image-20211112162317547-DN8bxdBH.png",Is="/assets/zabbix-serverconfig-DHpyFmKx.png",Ss={};function Ns(Ps,s){return h(),a("div",null,s[0]||(s[0]=[n(`<h1 id="zabbix构建企业级监控告警平台" tabindex="-1"><a class="header-anchor" href="#zabbix构建企业级监控告警平台"><span>Zabbix构建企业级监控告警平台</span></a></h1><h2 id="zabbix-构建企业级监控告警平台" tabindex="-1"><a class="header-anchor" href="#zabbix-构建企业级监控告警平台"><span>Zabbix 构建企业级监控告警平台</span></a></h2><h3 id="一-简介" tabindex="-1"><a class="header-anchor" href="#一-简介"><span>一. 简介</span></a></h3><p>Zabbix 是一个基于 WEB 界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。它能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。</p><h3 id="二-监控对象" tabindex="-1"><a class="header-anchor" href="#二-监控对象"><span>二.监控对象</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>源代码: *.html*.jsp *.php*.py</span></span>
<span class="line"><span>数据库： MySQL,MariaDB,Oracle,SQL Server,DB2</span></span>
<span class="line"><span>应用软件：Nginx,Apache,PHP,Tomcat agent</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>集群： LVS,Keepalived,HAproxy,RHCS,F5</span></span>
<span class="line"><span>虚拟化层/云层： VMware,KVM,XEN agent</span></span>
<span class="line"><span>操作系统：Linux,Unix,Windows性能参数</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>硬件： 服务器，存储 IPMI</span></span>
<span class="line"><span>网络： 网络环境（路由器，交换机，防火墙，内网环境，外网环境） SNMP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="三-监控收集信息方式" tabindex="-1"><a class="header-anchor" href="#三-监控收集信息方式"><span>三.监控收集信息方式</span></a></h3><ul><li>被动模式</li><li>主动模式</li></ul><h3 id="四-zabbix-部署" tabindex="-1"><a class="header-anchor" href="#四-zabbix-部署"><span>四.Zabbix 部署</span></a></h3><h4 id="zabbix-server-192-168-100-10" tabindex="-1"><a class="header-anchor" href="#zabbix-server-192-168-100-10"><span>zabbix-server(192.168.100.10)</span></a></h4><h5 id="_1-官网-我是链接" tabindex="-1"><a class="header-anchor" href="#_1-官网-我是链接"><span>1.官网：我是链接</span></a></h5><h5 id="_2-环境" tabindex="-1"><a class="header-anchor" href="#_2-环境"><span>2.环境</span></a></h5><p>IP 主机名 角色 192.168.100.10 zabbix_server 监控服务器 192.168.100.20 web1 业务主机</p><h5 id="_3-installing-zabbix-packages" tabindex="-1"><a class="header-anchor" href="#_3-installing-zabbix-packages"><span>3.Installing Zabbix packages</span></a></h5><p>①.设置主机名</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hostnamectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set-hostname</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix_server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②.防火墙</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③.selinux</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">永久关闭</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/^SELINUX/cSELINUX=disabled&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/selinux/config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>④.准备Zabbix-repo</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># rpm -Uvh https://repo.zabbix.com/zabbix/4.0/rhel/7/x86_64/zabbix-release-4.0-2.el7.noarch.rpm   </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Uvh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>国外镜像特别慢，可以使用阿里提供的zabbixYUM源。在epel中就有40版本 ⑤.安装Zabbix服务器</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-web-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-get.x86_64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>zabbix-server-mysql：数据库 zabbix-web-mysql：WEB zabbi-agent：代理程序（上报信息的程序）</p><h5 id="_4-creating-initial-database" tabindex="-1"><a class="header-anchor" href="#_4-creating-initial-database"><span>4. Creating initial database</span></a></h5><p>①.安装数据库</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb-server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②.启动数据库</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mariadb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③.授权zabbix账号</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mysql</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">create</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> database</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> zabbix</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> character</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> utf8 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">collate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> utf8_bin;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">create</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> user</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> zabbix</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">@localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> identified </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;123456&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">grant</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> all privileges </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zabbix.* </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">to</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zabbix</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">@localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">flush privileges;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_5-starting-zabbix-server-process" tabindex="-1"><a class="header-anchor" href="#_5-starting-zabbix-server-process"><span>5.Starting Zabbix server process</span></a></h5><p>①.配置sql账号密码</p><p>导入初始架构和数据，系统将提示您输入新创建的密码。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zcat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/doc/zabbix-server-mysql</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/create.sql.gz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uzabbix</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/zabbix_server.conf</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DBPassword</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">zxc123</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②.启动zabbix</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③.Editing PHP configuration for Zabbix frontend 默认值，只需要配置时区。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/httpd/conf.d/zabbix.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">php_value</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> date.timezone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Asia/Shanghai</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装后图形界面显示图形，文末有解决方案，php版本问题</p><p>升级php7.0即可，并重新安装zabbix-web</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix-server ~]# php -version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PHP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7.0.33</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (cli) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">built:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2018</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 22:30:44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) ( </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NTS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (c) 1997-2017 The PHP Group</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Zend</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Engine</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v3.0.0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (c) 1998-2017 Zend Technologies</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Zend</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OPcache</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v7.0.33,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (c) 1999-2017, by Zend Technologies</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix-server ~]# rpm -qa zabbix-web</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zabbix-web-4.0.28-1.el7.noarch</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="欢迎页面" tabindex="-1"><a class="header-anchor" href="#欢迎页面"><span>欢迎页面</span></a></h5><blockquote><p>在这里如果使用mysql 8.0的系统可能会报错 <strong>The server requested authentication method unknown to the client</strong></p><p>发生这个问题的原因是在 mysql 8.0 以后，caching_sha2_password是默认的身份验证插件，而不是以往的mysql_native_password。在 MySQL Command Line 工具下修改 mysql 的默认身份验证插件即可。</p><p>解决方法</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> USER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zabbix@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;localhost&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  IDENTIFIED </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WITH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mysql_native_password </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;passwd&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></blockquote><p><a href="http://zabbix-server-ip/zabbix" target="_blank" rel="noopener noreferrer">http://zabbix-server-ip/zabbix</a></p><p><img src="`+l+'" alt="image-20211111103246790"></p><h5 id="登录" tabindex="-1"><a class="header-anchor" href="#登录"><span>登录</span></a></h5><p>用户名： Admin 密码： zabbix</p><p><img src="'+t+'" alt="在这里插入图片描述"><img src="'+e+'" alt="在这里插入图片描述"></p><h5 id="语言和乱码" tabindex="-1"><a class="header-anchor" href="#语言和乱码"><span>语言和乱码</span></a></h5><p>administration&gt;users&gt;admin user 右上角用户图标，更换语言</p><p><img src="'+p+'" alt="在这里插入图片描述"></p><p><img src="'+k+'" alt="在这里插入图片描述"><img src="'+r+'" alt="在这里插入图片描述"></p><p>设置中文后，查看图形有乱码，文字变成了方块 解决方案 Win+R打开运行，输入fonts，回车进入Windows字体目录，找到微软雅黑-常规字体右键复制，找个文件夹，点击粘贴，复制出来将文件名修改为msyh.ttf，注意后缀ttf 只需要改一个</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">C:\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Windows</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Fonts</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+d+`" alt="在这里插入图片描述"></p><p>将msyh.ttf上传到服务器zabbix字体目录中：/usr/share/zabbix/assets/fonts/ 注意文件权限</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix_server fonts]# mv msyh.ttc msyh.ttf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 777</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /usr/share/zabbix/assets/fonts/msyh.ttf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看字体配置# grep FONT_NAME /usr/share/zabbix/include/defines.inc.php -n 执行快捷替换</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;s/graphfont/msyh/g&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/zabbix/include/defines.inc.php</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>确认是否替换成功</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FONT_NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/share/zabbix/include/defines.inc.php</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -n</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">45:define(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;ZBX_GRAPH_FONT_NAME&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &#39;msyh&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> font</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">93:define(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;ZBX_FONT_NAME&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;msyh&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>字体配置修改成功后，刷新图形界面即可看到图形字体显示正常了。</p><h4 id="zabbix-agent-192-168-100-20" tabindex="-1"><a class="header-anchor" href="#zabbix-agent-192-168-100-20"><span>zabbix-agent(192.168.100.20)</span></a></h4><h5 id="安装和配置" tabindex="-1"><a class="header-anchor" href="#安装和配置"><span>安装和配置</span></a></h5><p>①.设置主机名</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hostnamectl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set-hostname</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  web1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②.防火墙</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③.selinux</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>④.准备zabbix-repo</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Uvh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://repo.zabbix.com/zabbix/4.0/rhel/7/x86_64/zabbix-release-4.0-2.el7.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#rpm -ivh http://repo.zabbix.com/zabbix/4.4/rhel/7/x86_64/zabbix-release-4.4-1.el7.noarch.rpm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用epel源中的zabbix版本 ⑤.安装zabbix-agent</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>⑥.配置代理</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/zabbix_agentd.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>说明：192.168.100.10是zabbix服务器的地址</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Server</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">192.168.100.10,192.168.100.11</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 被动模式</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server-ip</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ServerActive</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">192.168.100.10,192.168.100.11</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 主动模式</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server-ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （谁从我这里采集数据。）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Hostname</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">web1</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 建议使用</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $HOSTNAME</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+g+'" alt="在这里插入图片描述"></p><p><img src="'+A+'" alt="在这里插入图片描述"></p><p><img src="'+B+`" alt="在这里插入图片描述"></p><p>⑦.启动zabbix-agent：10050</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -anlp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :10050</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>服务器是10051</p><p>7.命令行测试</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix_server fonts]# yum install zabbix-get</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix ~]# zabbix_get -s 10.11.67.137 -k system.uname</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3.10.0-693.el7.x86_64</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix ~]# zabbix_get -s 10.11.67.137 -k system.cpu.load[all,avg15]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0.050000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix ~]# zabbix_get -s 10.11.67.137 -k net.tcp.service[http]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>0假</li><li>1真</li></ul><h5 id="apache监控示例-图形监控" tabindex="-1"><a class="header-anchor" href="#apache监控示例-图形监控"><span>Apache监控示例（图形监控）</span></a></h5><h6 id="创建主机组-zabbix-server-192-168-100-10" tabindex="-1"><a class="header-anchor" href="#创建主机组-zabbix-server-192-168-100-10"><span>创建主机组 （zabbix-server-192.168.100.10）</span></a></h6><p><img src="`+c+'" alt="在这里插入图片描述"> 选择默认模板，模板就是zabbix推荐的监控参数。（这样可以缩小选择范围)</p><h6 id="创建主机-zabbix-server-192-168-100-10" tabindex="-1"><a class="header-anchor" href="#创建主机-zabbix-server-192-168-100-10"><span>创建主机（zabbix-server-192.168.100.10）</span></a></h6><p><img src="'+y+'" alt="在这里插入图片描述"></p><h6 id="选择群组" tabindex="-1"><a class="header-anchor" href="#选择群组"><span>选择群组</span></a></h6><p><img src="'+F+'" alt="在这里插入图片描述"><img src="'+o+'" alt="在这里插入图片描述"></p><p><img src="'+b+'" alt="在这里插入图片描述"></p><h6 id="创建图形-zabbix-server-192-168-100-10" tabindex="-1"><a class="header-anchor" href="#创建图形-zabbix-server-192-168-100-10"><span>创建图形（zabbix-server-192.168.100.10）</span></a></h6><p><img src="'+m+'" alt="在这里插入图片描述"></p><p><img src="'+u+'" alt="在这里插入图片描述"></p><p><img src="'+C+'" alt="在这里插入图片描述"></p><h6 id="模板template" tabindex="-1"><a class="header-anchor" href="#模板template"><span>模板Template</span></a></h6><p>应用集（app）：对监控项的分类</p><p>监控项（item）：具体监控的项目 比例。。大小。。</p><p>图形：监控项产生的连续数据用图形表示</p><p>聚合图形：多个图形在一个页面显示</p><p>自动发现：自动发现主机并添加到组中</p><p><img src="'+E+'" alt="在这里插入图片描述"></p><p><img src="'+v+'" alt="在这里插入图片描述"></p><p><img src="'+x+'" alt="在这里插入图片描述"></p><p><img src="'+f+'" alt="在这里插入图片描述"></p><p><img src="'+_+'" alt="在这里插入图片描述"></p><h4 id="报错及解决" tabindex="-1"><a class="header-anchor" href="#报错及解决"><span>报错及解决</span></a></h4><h5 id="安装zabbix4-0图形界面不显示图" tabindex="-1"><a class="header-anchor" href="#安装zabbix4-0图形界面不显示图"><span>安装zabbix4.0图形界面不显示图</span></a></h5><p><img src="'+D+`" alt="在这里插入图片描述"></p><p>解决： 大佬提示php版本问题，yum安装为5.4 ，升级为7的版本测试</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1.执行下面的命令升级软件仓库</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Uvh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://mirror.webtatic.com/yum/el7/epel-release.rpm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Uvh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2.删除PHP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remove</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php-common</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3.安装php</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5.6版本（php56w-devel不是必需）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-opcache</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-xml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-mcrypt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-gd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-intl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php56w-mbstring</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4.重启Apache</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">安装PHP7</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-fpm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-mysqli</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-opcache</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-gd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-intl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-mbstring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-exif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-mcrypt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php70w-openssl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="安装zabbix-后进入graph界面-显示fail" tabindex="-1"><a class="header-anchor" href="#安装zabbix-后进入graph界面-显示fail"><span>安装zabbix 后进入graph界面 显示Fail</span></a></h5><p><img src="`+z+`" alt="在这里插入图片描述"></p><p>依据提示修改</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/php.ini</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date.timezone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#重启php-fpm httpd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php-fpm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+q+'" alt="在这里插入图片描述"></p><p><img src="'+T+'" alt="在这里插入图片描述"></p><p><img src="'+w+`" alt="在这里插入图片描述"></p><h2 id="zabbix-构建企业级监控告警平台-2" tabindex="-1"><a class="header-anchor" href="#zabbix-构建企业级监控告警平台-2"><span>Zabbix 构建企业级监控告警平台 2</span></a></h2><h3 id="zabbix-items-监控项" tabindex="-1"><a class="header-anchor" href="#zabbix-items-监控项"><span>Zabbix Items 监控项</span></a></h3><p>获取监控数据方式</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zabbix-agent</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SNMP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 简单的网际发现协议</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>取值的数据类型、单位</p><p>监控key：是监控的内容 ，</p><p>获取数据的间隔：不能太小，1s 1m</p><p>历史数据保存的时间：</p><p>趋势数据保存时间：</p><h4 id="新建item监控项" tabindex="-1"><a class="header-anchor" href="#新建item监控项"><span>新建item监控项</span></a></h4><h4 id="监控项-服务器启动分区剩余空间" tabindex="-1"><a class="header-anchor" href="#监控项-服务器启动分区剩余空间"><span>监控项：服务器启动分区剩余空间</span></a></h4><p>1、新建模板</p><p><img src="`+I+'" alt="image-20211111154251931"></p><p>2、创建监控项</p><p><img src="'+S+'" alt="image-20211111154338090"></p><p><img src="'+N+'" alt="image-20211111155148598"></p><p>3、新建图形</p><p><img src="'+P+'" alt="image-20211111155541026"></p><p>添加模板到主机</p><p>然后在检测：最新数据：查看图形</p><p><img src="'+$+'" alt="image-20211111160644405"></p><h4 id="监控项-服务器网络进出口流量" tabindex="-1"><a class="header-anchor" href="#监控项-服务器网络进出口流量"><span>监控项：服务器网络进出口流量</span></a></h4><p>新建项 IN（新建项OUT，新建项all）</p><p><img src="'+M+'" alt="image-20211111170552282"></p><p><img src="'+Z+'" alt="image-20211111164757594"></p><h4 id="新建项mem" tabindex="-1"><a class="header-anchor" href="#新建项mem"><span>新建项mem</span></a></h4><p><img src="'+R+'" alt="image-20211111172407040"></p><p>创建图形</p><p>模板关联主机</p><p>最新数据</p><p>创建聚合图形</p><p><img src="'+V+'" alt="image-20211111173426460"></p><h4 id="监控项-监控ftp服务" tabindex="-1"><a class="header-anchor" href="#监控项-监控ftp服务"><span>监控项：监控ftp服务</span></a></h4><p><img src="'+H+`" alt="image-20211111175038429"></p><h4 id="自定义key" tabindex="-1"><a class="header-anchor" href="#自定义key"><span>自定义Key</span></a></h4><p>vim /etc/zabbix/zabbix_agentd.d/userparamenter_mysql.conf 以conf结尾即可</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix_server ~]# vim /etc/zabbix/zabbix_agentd.d/userparamenter_mysql.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UserParameter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql.questions.zhangshoulong,mysqladmin</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p123456</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $6}&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix_server ~]# zabbix_agentd -t mysql.questions.zhangshoulong</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql.questions.zhangshoulong</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                 [t|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">801689]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+O+'" alt="image-20211111184515078"></p><p><img src="'+U+`" alt="image-20211111185909781"></p><h3 id="zabbix-triger-触发器" tabindex="-1"><a class="header-anchor" href="#zabbix-triger-触发器"><span>Zabbix Triger 触发器</span></a></h3><p>触发器用于定义item的报警阈值</p><h4 id="触发器表达式" tabindex="-1"><a class="header-anchor" href="#触发器表达式"><span>触发器表达式</span></a></h4><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">&lt;server&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">&lt;key&gt;.&lt;function&gt;(&lt;parameter&gt;)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}&lt;operation&gt;&lt;constant&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">server: 可以是host 也可以是template</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">key: item 包括自定义的key</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">函数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">常用模板</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="例子-cpu负载超过2" tabindex="-1"><a class="header-anchor" href="#例子-cpu负载超过2"><span>例子：CPU负载超过2</span></a></h4><p><img src="`+G+'" alt="image-20211111192234039"></p><p><img src="'+L+'" alt="image-20211111201253785"></p><h3 id="zabbix-action-动作" tabindex="-1"><a class="header-anchor" href="#zabbix-action-动作"><span>Zabbix Action 动作</span></a></h3><p>动作Action</p><h4 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h4><p>当某个触发器状态发生改变(如Problem、OK)，可以采取相应的动作，如：</p><h4 id="邮件-短信-微信告警" tabindex="-1"><a class="header-anchor" href="#邮件-短信-微信告警"><span>邮件，短信，微信告警</span></a></h4><h5 id="告警实验简介" tabindex="-1"><a class="header-anchor" href="#告警实验简介"><span>告警实验简介</span></a></h5><ol><li>创建告警media type（发送消息的方式，例如使用某个mail user连接某个邮件服务器 smtp.126.com <a href="mailto:love_cloud@126.com" target="_blank" rel="noopener noreferrer">love_cloud@126.com</a> xxxx）</li><li>创建用户或组（接收消息的用户例如email address, 注意权限）</li><li>创建Action（使用之前定义好的media type 发送给之前定义好的用户或组） 邮件告警 准备告警信息 1.注册新邮箱</li></ol><p><a href="http://mail.126.com/" target="_blank" rel="noopener noreferrer">http://mail.126.com/</a> 或 &lt;mail.qq.com&gt; 2.开启POP3的授权码</p><p><img src="'+W+`" alt="在这里插入图片描述"> 3.zabbix设置邮箱</p><h5 id="zabbix服务器与邮箱服务器的连通性测试" tabindex="-1"><a class="header-anchor" href="#zabbix服务器与邮箱服务器的连通性测试"><span>zabbix服务器与邮箱服务器的连通性测试</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> smtp.126.com</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 25</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>连接成功</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix ~]# nc smtp.126.com -t 25</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">220</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 126.com</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Anti-spam</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Coremail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (126com[20140526])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="设置zabbix链接126邮箱信息" tabindex="-1"><a class="header-anchor" href="#设置zabbix链接126邮箱信息"><span>设置zabbix链接126邮箱信息</span></a></h5><p><img src="`+K+'" alt="image-20211112075406077"></p><p><img src="'+Y+'" alt="image-20211112080619306">4.创建</p><h6 id="用户组" tabindex="-1"><a class="header-anchor" href="#用户组"><span>用户组</span></a></h6><p>运维组 <img src="'+Q+'" alt="image-20211112081040025">用户kk <img src="'+X+'" alt="image-20211112081323188"> 密码自定义</p><p><img src="'+J+'" alt="image-20211112081431474"></p><p>告警类型 <img src="'+j+'" alt="image-20211112081525726"> 设置告警</p><p><img src="'+ss+'" alt="image-20211112081716621"></p><p>设置动作：触发器产生的告警</p><p><img src="'+is+'" alt="image-20211112082124999"><img src="'+as+'" alt="image-20211112082343476"> 多个条件会有逻辑关系</p><p><img src="'+ns+'" alt="image-20211112082514028"></p><p><img src="'+hs+'" alt="image-20211112082950282">设置一旦模板发生问题，每隔60秒就发送邮件给用户1</p><p><img src="'+ls+'" alt="image-20211112083224765"></p><p><img src="'+ts+'" alt="image-20211112092251314"></p><p><img src="'+es+`" alt="image-20211112092308452"></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{TRIGGER.STATUS}: {TRIGGER.NAME}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警主机:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{HOST.NAME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">主机地址:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{HOST.IP}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警时间:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{EVENT.DATE}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {EVENT.TIME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警等级:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{TRIGGER.SEVERITY}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警信息:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{TRIGGER.NAME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">问题详情:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{ITEM.NAME}</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{ITEM.VALUE}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">事件代码:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{EVENT.ID}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当事件升级，发送给更高级用户。</p><h5 id="微信告警" tabindex="-1"><a class="header-anchor" href="#微信告警"><span>微信告警</span></a></h5><p>获取企业ID： ww88cfc4e6401f9bb0 <a href="https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome" target="_blank" rel="noopener noreferrer">https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome</a></p><p><img src="`+ps+'" alt="image-20211112101855500"></p><p>AgentID：1000003</p><p>Secret： FrmpVSXIt8kokhQJ9neNSQwti-ZeTcFhWqzifvBWvuA</p><p><img src="'+ks+'" alt="image-20211112103325012"></p><p><img src="'+rs+'" alt="image-20211112104449707"></p><p><img src="'+ds+`" alt="image-20211112104551488"></p><p>vim /usr/lib/zabbix/alertscripts/wechat.py</p><p>chown zabbix:zabbix /usr/lib/zabbix/alertscripts/wechat.py</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/usr/bin/env python</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib,urllib2,json</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sys</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">reload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sys)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">setdefaultencoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">( </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;utf-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> WeChat</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">object</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        __token_id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # init attribute</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> url.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rstrip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__corpid </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;ww88cfc4e6401f9bb0&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__secret </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;FrmpVSXIt8kokhQJ9neNSQwti-ZeTcFhWqzifvBWvuA&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # Get TokenID</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> authID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                params </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;corpid&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__corpid, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;corpsecret&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__secret}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">urlencode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(params)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                content </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">getToken</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(data)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__token_id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> content[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;access_token&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # print content[&#39;access_token&#39;]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> KeyError</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        raise</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> KeyError</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # Establish a connection</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getToken</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">url_prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> url_prefix </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;gettoken?&#39;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                except</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> KeyError</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        raise</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;"> KeyError</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">urlopen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(response)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                content </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">loads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> content</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # Get sendmessage url</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> postData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">url_prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> url_prefix </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;message/send?access_token=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.__token_id</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                request </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(url,data)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">urlopen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(request)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                except</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib2.HTTPError </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        if</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> hasattr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(e,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;reason&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                                print</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;reason&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,e.reason</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        elif</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> hasattr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(e,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;code&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                                print</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;code&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,e.code</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        content </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">loads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                        result.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> content</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # send message</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sendMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">touser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">                self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">authID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">dumps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        &quot;touser&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;user&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,   </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        &quot;toparty&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;3&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,    </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        &quot;msgtype&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        &quot;agentid&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1000003&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        &quot;text&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       &#39;content&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:message</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                           },</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     &quot;safe&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;0&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                },</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">ensure_ascii</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">postData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(data)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> response</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        a </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> WeChat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;https://qyapi.weixin.qq.com/cgi-bin&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        a.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sendMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@zabbix_server alertscripts]# ./wechat.py Jocker test test</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{u&#39;msgid&#39;: u&#39;mrVtVXE39it1tWVvd57npNzElVA2MgYok9Pc-PiVh1kIAhi7-jUDlWEyhZ-7G_7CuSBmcdanBYORruEw_ycDdg&#39;, u&#39;invaliduser&#39;: u&#39;user&#39;, u&#39;errcode&#39;: 0, u&#39;errmsg&#39;: u&#39;ok&#39;}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[用户] [title] [内容]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+gs+'" alt="image-20211112113333108"></p><p><img src="'+As+'" alt="image-20211112113513283"></p><p><img src="'+Bs+'" alt="image-20211112113741760"></p><p><img src="'+cs+`" alt="image-20211112113812492"></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{TRIGGER.STATUS}: {TRIGGER.NAME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警主机:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{HOST.NAME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">主机地址:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{HOST.IP}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警时间:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{EVENT.DATE}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {EVENT.TIME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警等级:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{TRIGGER.SEVERITY}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">告警信息:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{TRIGGER.NAME}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">问题详情:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{ITEM.NAME}</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{ITEM.VALUE}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">事件代码:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{EVENT.ID}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="远程执行" tabindex="-1"><a class="header-anchor" href="#远程执行"><span>远程执行</span></a></h4><p>当问题发生时，可以通过远程执行命令的形式对目标主机进行控制</p><p><img src="`+ys+'" alt="image-20211112115030073"></p><p><img src="'+Fs+'" alt="image-20211112121444278"></p><p><img src="'+os+'" alt="image-20211112121454147"></p><p><img src="'+bs+'" alt="image-20211112123239292"></p><p><img src="'+ms+'" alt="image-20211112123249323"></p><p><img src="'+us+`" alt="image-20211112123209567"></p><h3 id="zabbix-macros-内置宏" tabindex="-1"><a class="header-anchor" href="#zabbix-macros-内置宏"><span>Zabbix Macros 内置宏</span></a></h3><p><a href="https://www.zabbix.com/documentation/5.0/zh/manual/config/notifications/action/operation/macros" target="_blank" rel="noopener noreferrer">https://www.zabbix.com/documentation/5.0/zh/manual/config/notifications/action/operation/macros</a></p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-php"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 主机相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">HOSTNAME1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">告警主机</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">HOST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">IP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">主机IP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">HOST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">METADATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}   </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">设备元数据（自动注册的时候会发这种宏的通知给你）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 时间相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">当前时间</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} {</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">TIME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">告警时间</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 触发器相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">TRIGGER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">SEVERITY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发器告警等级</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">TRIGGER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发器名</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">TRIGGER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">KEY1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发器告警项目</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">TRIGGER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发器状态</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 监控项相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ITEM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}:{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ITEM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">VALUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}   </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">监控项名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 动作（ Action）相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}     </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">动作</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">的数字标识</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}   </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">动作</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 自动发现相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DISCOVERY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DEVICE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">IPADDRESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">被发现的设备地址</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DISCOVERY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">DEVICE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">被发现设备的状态</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">可能是Up</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> 或</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> Down</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">## 事件（EVENT)相关</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ACK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">事件的确认状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">AGE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发动作的事件持续时间</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发动作的事件数字标识</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">EVENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">STATUS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">触发动作的事件状态</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="zabbix-自动发现" tabindex="-1"><a class="header-anchor" href="#zabbix-自动发现"><span>Zabbix 自动发现</span></a></h3><p><img src="`+Cs+'" alt="image-20211112135629262"></p><p><img src="'+Es+'" alt="image-20211112135854785"></p><p><img src="'+vs+'" alt="image-20211112140423794"></p><p>自动发现动作</p><p><img src="'+xs+'" alt="image-20211112141129553"></p><p><img src="'+fs+'" alt="image-20211112141400020"></p><p><img src="'+_s+'" alt="image-20211112141542190"></p><p>发现的主机在哪</p><p><img src="'+Ds+'" alt="image-20211112141644037"></p><h3 id="zabbix自动注册" tabindex="-1"><a class="header-anchor" href="#zabbix自动注册"><span>Zabbix自动注册</span></a></h3><p>由客户端主动发起，客户端必须安装Agentd。否则无法被自动注册添加至主机列表</p><p>zabbix_agent 配置</p><p>vim /etc/zabbix/zabbix_agentd.conf</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ServerActive</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">192.168.0.110</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 主动模式</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zabbix-server-ip</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>systemctl restart zabbix-agentd</p><p><img src="'+zs+'" alt="image-20211112142240335"></p><p><img src="'+qs+'" alt="image-20211112142443866"></p><p><img src="'+Ts+`" alt="image-20211112143132350"></p><h2 id="实战-tcp连接状态监控" tabindex="-1"><a class="header-anchor" href="#实战-tcp连接状态监控"><span>实战：TCP连接状态监控</span></a></h2><p>状态码：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">握手：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-SYN_SENT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 发送syn握手</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 监听</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> V</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-SYN_REVND</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 发送同步</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-ESTABLISHED</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 完成连接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-ESTABLISHED</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 完成连接</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">数据传输：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-write</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-read</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">挥手：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-FIN_WAIT-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 开始等待1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-CLOSE_WAIT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 关闭等待</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">V</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-LAST_ACK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 最后询问[若无回复,倒数秒表自动关闭]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-FIN_WAIT-2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 开始等待2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">V</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1-TIME_WAIT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2-TIME_WAIT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>工具</p><p>netstat an</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">多少个连接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -anpt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ESTABLISHED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>agent：</p><p>vim /etc/zabbix/zabbix_agentd.d/userparamenter_mysql.conf</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UserParameter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tcp.status.ESTABLISHED,netstat</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> -anpt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ESTABLISHED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UserParameter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tcp.status.TIME_WAIT,netstat</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> -anpt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TIME_WAIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="实战-tcp连接状态监控2" tabindex="-1"><a class="header-anchor" href="#实战-tcp连接状态监控2"><span>实战：TCP连接状态监控2</span></a></h2><p>agent:</p><p>vim /etc/zabbix/zabbix_agentd.d/userparamenter_mysql.conf</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UserParameter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tcp.status.[*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],netstat -anpt | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = 前方第一个[方括号里的内容]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+ws+`" alt="image-20211112162317547"></p><p>高级用法</p><p>vim /etc/zabbix/zabbix_agentd.conf中增加</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UserParameter</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tcp.status[*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],/etc/zabbix/scripts/tcp_conn_status.sh </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a+x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/zabbix/scripts/tcp_conn_status.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">case</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   closed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/CLOSED/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   listen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/LISTEN/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   synrecv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/SYN_RECV/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   synsent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/SYN_SENT/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   established</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/ESTABLISHED/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   timewait</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/TIME_WAIT/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   closing</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/CLOSING/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   closewait</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/CLOSE_WAIT/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   lastack</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/LAST_ACK/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   finwait1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/FIN_WAIT1/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         ;;  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">   finwait2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          output</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/FIN_WAIT2/{print $2}&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $tmp_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ];</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">             echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $output</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">          fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         ;;  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         *)  </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">          echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;\\e[033mUsage: sh  </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> [closed|closing|closewait|synrecv|synsent|finwait1|finwait2|listen|established|lastack|timewait]\\e[0m&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="一份生产配置" tabindex="-1"><a class="header-anchor" href="#一份生产配置"><span>一份生产配置</span></a></h2><p><img src="`+Is+'" alt="zabbix-serverconfig"></p>',270)]))}const Ms=i(Ss,[["render",Ns]]),Zs=JSON.parse('{"path":"/note-book/Zabbix/Zabbix%E6%9E%84%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%BA%A7%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6%E5%B9%B3%E5%8F%B0.html","title":"Zabbix构建企业级监控告警平台","lang":"zh-CN","frontmatter":{"description":"Zabbix构建企业级监控告警平台 Zabbix 构建企业级监控告警平台 一. 简介 Zabbix 是一个基于 WEB 界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。它能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。 二.监控对象 三.监控收集信息方式 被动模式 主动模式 ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Zabbix构建企业级监控告警平台\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-19T06:16:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Paper-Dragon\\",\\"url\\":\\"https://github.com/Paper-Dragon\\",\\"email\\":\\"2678885646@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.geekery.cn/note-book/Zabbix/Zabbix%E6%9E%84%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%BA%A7%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6%E5%B9%B3%E5%8F%B0.html"}],["meta",{"property":"og:site_name","content":"运维开发绿皮书"}],["meta",{"property":"og:title","content":"Zabbix构建企业级监控告警平台"}],["meta",{"property":"og:description","content":"Zabbix构建企业级监控告警平台 Zabbix 构建企业级监控告警平台 一. 简介 Zabbix 是一个基于 WEB 界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。它能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。 二.监控对象 三.监控收集信息方式 被动模式 主动模式 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-19T06:16:02.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-19T06:16:02.000Z"}]]},"git":{"createdTime":1691939318000,"updatedTime":1745043362000,"contributors":[{"name":"Paper-Dragon","username":"Paper-Dragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/Paper-Dragon"},{"name":"PaperDragon-SH","username":"PaperDragon-SH","email":"2678885646@qq.com","commits":2,"url":"https://github.com/PaperDragon-SH"},{"name":"PaperDragon","username":"PaperDragon","email":"2678885646@qq.com","commits":1,"url":"https://github.com/PaperDragon"}],"changelog":[{"hash":"cae2bec446d701a6add8cbc5d7ffd49a5aff8550","time":1745043362000,"email":"2678885646@qq.com","author":"PaperDragon","message":"清理死链"},{"hash":"dcc5afc783afbb65df491d9def53ac30acb04817","time":1710837110000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"zabbix规范化标题"},{"hash":"be5f863d06c7e0b602728a995af5b86df0a43c35","time":1697699528000,"email":"2678885646@qq.com","author":"PaperDragon-SH","message":"增加zabbix server生产案例"},{"hash":"392a519398b2e846f316619fbe831e100164de7c","time":1691939318000,"email":"2678885646@qq.com","author":"Paper-Dragon","message":"Create The Worid!"}]},"readingTime":{"minutes":12.03,"words":3610},"filePathRelative":"note-book/Zabbix/Zabbix构建企业级监控告警平台.md","excerpt":"\\n<h2>Zabbix 构建企业级监控告警平台</h2>\\n<h3>一. 简介</h3>\\n<p>Zabbix 是一个基于 WEB 界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。它能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。</p>\\n<h3>二.监控对象</h3>\\n<div class=\\"language-text line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"text\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-text\\"><span class=\\"line\\"><span>源代码: *.html*.jsp *.php*.py</span></span>\\n<span class=\\"line\\"><span>数据库： MySQL,MariaDB,Oracle,SQL Server,DB2</span></span>\\n<span class=\\"line\\"><span>应用软件：Nginx,Apache,PHP,Tomcat agent</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{Ms as comp,Zs as data};
