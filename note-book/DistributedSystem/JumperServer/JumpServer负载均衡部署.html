<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <!-- 添加百度搜索验证代码 -->
    <meta name="baidu-site-verification" content="codeva-udZGoBkoXj" />
    <!-- end 添加百度搜索验证代码 -->
    
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://www.geekery.cn/note-book/DistributedSystem/JumperServer/JumpServer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%83%A8%E7%BD%B2.html"><meta property="og:site_name" content="运维开发绿皮书"><meta property="og:title" content="JumpServer负载均衡部署"><meta property="og:description" content="JumpServer负载均衡部署 环境说明 除 JumpServer 自身组件外，其他组件的高可用请参考对应的官方文档进行部署 按照此方式部署后，后续只需要根据需要扩容 JumpServer 节点然后添加节点到 HAProxy 即可 如果已经有 HLB 或者 SLB 可以跳过 HAProxy 部署，第三方 LB 要注意 session 和 websoc..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-03-19T09:11:46.000Z"><meta property="article:modified_time" content="2024-03-19T09:11:46.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JumpServer负载均衡部署","image":[""],"dateModified":"2024-03-19T09:11:46.000Z","author":[{"@type":"Person","name":"PaperDragon","url":"https://github.com/Paper-Dragon","email":"2678885646@qq.com"}]}</script><script>
      /*禁用F12*/
      document.onkeydown = function(){
          if(window.event.keyCode==123) {
              var x;
              var r=confirm('大佬，别扒了！不妨加个友链？\n点击确认键跳转到友链！\n\n执意要做？亦或是双击F12可调出控制台\n');
              if (r==true){
                //x="你按下的是\"确定\"按钮。";
                window.location.replace("/about/friend.html");
              }
              else{
                x="你按下的是\"取消\"按钮。";
              }
              // document.write(x)
              event.preventDefault(); // 阻止默认事件行为
              event.keyCode=0;
              event.returnValue=false;
          }
      }
      </script><link rel="alternate" type="application/rss+xml" href="https://www.geekery.cn/rss.xml" title="运维开发绿皮书 RSS Feed"><title>JumpServer负载均衡部署 | 运维开发绿皮书</title><meta name="description" content="JumpServer负载均衡部署 环境说明 除 JumpServer 自身组件外，其他组件的高可用请参考对应的官方文档进行部署 按照此方式部署后，后续只需要根据需要扩容 JumpServer 节点然后添加节点到 HAProxy 即可 如果已经有 HLB 或者 SLB 可以跳过 HAProxy 部署，第三方 LB 要注意 session 和 websoc...">
    <link rel="preload" href="/assets/style-CldDG_oh.css" as="style"><link rel="stylesheet" href="/assets/style-CldDG_oh.css">
    <link rel="modulepreload" href="/assets/app-BkQX7AVe.js"><link rel="modulepreload" href="/assets/JumpServer负载均衡部署.html-C1LMgDMv.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">运维开发绿皮书</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="主页" iconsizing="height"><!--[--><iconify-icon class="vp-icon" icon="line-md:home-twotone" height="1em" sizing="height"></iconify-icon><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/note-book/" aria-label="使用指南" iconsizing="height"><!--[--><iconify-icon class="vp-icon" icon="openmoji:light-bulb" height="1em" sizing="height"></iconify-icon><!--]-->使用指南<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="小项目"><!--[--><iconify-icon class="vp-icon" icon="solar:box-line-duotone" height="1em" sizing="height"></iconify-icon>小项目<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/cloudflare-warp.html" aria-label="Cloudflare Warp 团队服务" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="simple-icons:cloudflare" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->Cloudflare Warp 团队服务<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/code-diff.html" aria-label="代码差异对比" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="icon-park-twotone:difference-set" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->代码差异对比<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/cron.html" aria-label="Cron在线表达式生成器" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="eos-icons:cronjob" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->Cron在线表达式生成器<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/docker-hub-mirror.html" aria-label="DockerHub镜像加速" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="grommet-icons:docker" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->DockerHub镜像加速<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/github-direct.html" aria-label="GitHub加速下载" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="mdi:github" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->GitHub加速下载<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/mobaxterm-crack.html" aria-label="Mobaxterm破解" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="gg:terminal" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->Mobaxterm破解<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/nvidia-mirror.html" aria-label="Nvidia镜像站" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="bi:nvidia" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->Nvidia镜像站<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/radeon-mirror.html" aria-label="Radeon镜像站" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="bi:amd" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->Radeon镜像站<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/random-password.html" aria-label="密码生成器" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="ph:password" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->密码生成器<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/SSLGenerate.html" aria-label="SSL 证书生成" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="ph:certificate-duotone" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->SSL 证书生成<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/text-reverse.html" aria-label="文本字符串倒序" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="system-uicons:reverse-alt" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->文本字符串倒序<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/tools.html" aria-label="小工具" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="material-symbols-light:tools-ladder" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->小工具<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="时间线" iconsizing="height"><!--[--><iconify-icon class="vp-icon" icon="ic:twotone-view-timeline" height="1em" sizing="height"></iconify-icon><!--]-->时间线<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about/friend.html" aria-label="友链" iconsizing="height"><!--[--><iconify-icon class="vp-icon" icon="fa-solid:user-friends" height="1em" sizing="height"></iconify-icon><!--]-->友链<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="博客联盟"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:comment-nodes" height="1em" sizing="height"></iconify-icon>博客联盟<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.travellings.cn/go.html" aria-label="开往" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="fa:subway" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->开往<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="https://cloudflare-cloudnative-pages.geekery.cn/" aria-label="内容分发网络部署状态" rel="noopener noreferrer" target="_blank" iconsizing="height"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:hexagon-nodes-bolt" height="1em" sizing="height"></iconify-icon><!--]-->内容分发<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Paper-Dragon/notebook" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="主页" iconsizing="both"><!--[--><iconify-icon class="vp-icon" icon="line-md:home-twotone" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->主页<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><iconify-icon class="vp-icon" icon="ic:twotone-book" width="1em" height="1em" sizing="both"></iconify-icon><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/note-book/" aria-label="note-book" iconsizing="both"><!---->note-book<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">AI Training</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Anaconda</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Android</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Baidu Net Disk</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Btrfs</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Core DNS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">CVE</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Database System</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Distributed System</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ansible</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Jumper Server</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/note-book/DistributedSystem/JumperServer/JumperServer%E6%A6%82%E8%A7%88.html" aria-label="JumperServer概览" iconsizing="both"><!---->JumperServer概览<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/note-book/DistributedSystem/JumperServer/JumperServer%E7%9A%84Docker%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2.html" aria-label="JumperServer的Docker容器部署" iconsizing="both"><!---->JumperServer的Docker容器部署<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/note-book/DistributedSystem/JumperServer/JumpServer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%83%A8%E7%BD%B2.html" aria-label="JumpServer负载均衡部署" iconsizing="both"><!---->JumpServer负载均衡部署<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Open Stack</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">DNS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ebook</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ELK</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Esxi</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Fossology</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Frp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Git</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Gitlab</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Goaccess</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">GRUB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">HA LVS Keepalived</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Harbor</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Iptables</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jenkins</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kafka</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kubernetes</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux From Scratch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux Opera System</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux三剑客</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Memcache Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Midjourney</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Min IO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Misc</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx Open Resty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nodejs</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Opera Systems</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Photo Shop</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Physical Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Portainer</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prometheus</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rabbit MQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rancher</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Research Develop</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Router OS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Security</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ssh</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SSL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Tomcat</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Traefik</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Vim</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Virtual Private Network</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">VMware</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Windows</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">WSL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Zabbix</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">交换机</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">币圈的那些事</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">洋垃圾主机</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">生活</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="ic:twotone-book" width="1em" height="1em" sizing="both"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/" aria-label="PyQt5快速上手-王铭东" iconsizing="both"><!---->PyQt5快速上手-王铭东<!----></a><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->JumpServer负载均衡部署</h1><!----><hr></div><!----><!----><div class="theme-hope-content" vp-content><h1 id="jumpserver负载均衡部署" tabindex="-1"><a class="header-anchor" href="#jumpserver负载均衡部署"><span>JumpServer负载均衡部署</span></a></h1><h2 id="环境说明" tabindex="-1"><a class="header-anchor" href="#环境说明"><span>环境说明</span></a></h2><ul><li>除 JumpServer 自身组件外，其他组件的高可用请参考对应的官方文档进行部署</li><li>按照此方式部署后，后续只需要根据需要扩容 JumpServer 节点然后添加节点到 HAProxy 即可</li><li>如果已经有 HLB 或者 SLB 可以跳过 HAProxy 部署，第三方 LB 要注意 session 和 websocket 问题</li><li>如果已经有 云存储 (* S3/Ceph/Swift/OSS/Azure) 可以跳过 MinIO 部署，MySQL Redis 也一样</li><li>生产环境中，应该使用 Ceph 等替代 NFS，或者部署高可用的 NFS 防止单点故障</li><li><a href="https://github.com/wojiushixiaobai/redis-sentinel" target="_blank" rel="noopener noreferrer">Redis 高可用快速部署可以参考此项目</a></li></ul><table><thead><tr><th>DB</th><th>Version</th><th></th><th>Cache</th><th>Version</th></tr></thead><tbody><tr><td>MySQL</td><td>&gt;= 5.7</td><td></td><td>Redis</td><td>&gt;= 5.0</td></tr><tr><td>MariaDB</td><td>&gt;= 10.2</td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>Server Name</th><th>IP</th><th>Port</th><th>Use</th><th>Minimize Hardware</th><th>Standard Hardware</th></tr></thead><tbody><tr><td>NFS</td><td>192.168.100.11</td><td></td><td>Core</td><td>2Core/8GB RAM/100G HDD</td><td>4Core/16GB RAM/1T SSD</td></tr><tr><td>MySQL</td><td>192.168.100.11</td><td>3306</td><td>Core</td><td>2Core/8GB RAM/90G HDD</td><td>4Core/16GB RAM/1T SSD</td></tr><tr><td>Redis</td><td>192.168.100.11</td><td>6379</td><td>Core, Koko, Lion</td><td>2Core/8GB RAM/90G HDD</td><td>4Core/16GB RAM/1T SSD</td></tr><tr><td>HAProxy</td><td>192.168.100.100</td><td>80,443,2222,33060,33061</td><td>All</td><td>2Core/4GB RAM/60G HDD</td><td>4Core/8GB RAM/60G SSD</td></tr><tr><td>JumpServer 01</td><td>192.168.100.21</td><td>80,2222,33060,33061</td><td>HAProxy</td><td>2Core/8GB RAM/60G HDD</td><td>4Core/8GB RAM/90G SSD</td></tr><tr><td>JumpServer 02</td><td>192.168.100.22</td><td>80,2222,33060,33061</td><td>HAProxy</td><td>2Core/8GB RAM/60G HDD</td><td>4Core/8GB RAM/90G SSD</td></tr><tr><td>JumpServer 03</td><td>192.168.100.23</td><td>80,2222,33060,33061</td><td>HAProxy</td><td>2Core/8GB RAM/60G HDD</td><td>4Core/8GB RAM/90G SSD</td></tr><tr><td>JumpServer 04</td><td>192.168.100.24</td><td>80,2222,33060,33061</td><td>HAProxy</td><td>2Core/8GB RAM/60G HDD</td><td>4Core/8GB RAM/90G SSD</td></tr><tr><td>MinIO</td><td>192.168.100.41</td><td>9000,9001</td><td>Core, KoKo, Lion</td><td>2Core/4GB RAM/100G HDD</td><td>4Core/8GB RAM/1T SSD</td></tr><tr><td>Elasticsearch</td><td>192.168.100.51</td><td>9200,9300</td><td>Core, KoKo</td><td>2Core/4GB RAM/100G HDD</td><td>4Core/8GB RAM/1T SSD</td></tr></tbody></table><table><thead><tr><th>Server Name</th><th>Check Health</th><th>Example</th></tr></thead><tbody><tr><td>Core</td><td>http://core:8080/api/health/</td><td>https://demo.jumpserver.org/api/health/</td></tr><tr><td>KoKo</td><td>http://koko:5000/koko/health/</td><td>https://demo.jumpserver.org/koko/health/</td></tr><tr><td>Lion</td><td>http://lion:8081/lion/health/</td><td>https://demo.jumpserver.org/lion/health/</td></tr></tbody></table><h2 id="部署-nfs-服务" tabindex="-1"><a class="header-anchor" href="#部署-nfs-服务"><span>部署 NFS 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>服务器: 192.168.100.11</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装依赖</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install epel-release</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install nfs-utils rpcbind</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启动 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable rpcbind nfs-server nfs-lock nfs-idmap</span></span>
<span class="line"><span>systemctl start rpcbind nfs-server nfs-lock nfs-idmap</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置防火墙</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>firewall-cmd --add-service=nfs --permanent --zone=public</span></span>
<span class="line"><span>firewall-cmd --add-service=mountd --permanent --zone=public</span></span>
<span class="line"><span>firewall-cmd --add-service=rpc-bind --permanent --zone=public</span></span>
<span class="line"><span>firewall-cmd --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir /data</span></span>
<span class="line"><span>chmod 777 -R /data</span></span>
<span class="line"><span></span></span>
<span class="line"><span>vi /etc/exports</span></span>
<span class="line"><span># 设置 NFS 访问权限, /data 是刚才创建的将被共享的目录, 192.168.100.* 表示整个 192.168.100.* 的资产都有括号里面的权限</span></span>
<span class="line"><span># 也可以写具体的授权对象 /data 192.168.100.30(rw,sync,no_root_squash) 192.168.100.31(rw,sync,no_root_squash)</span></span>
<span class="line"><span>/data 192.168.100.*(rw,sync,all_squash,anonuid=0,anongid=0)</span></span>
<span class="line"><span>exportfs -a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-mysql-服务" tabindex="-1"><a class="header-anchor" href="#部署-mysql-服务"><span>部署 MySQL 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.11</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 Repo</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y localinstall http://mirrors.ustc.edu.cn/mysql-repo/mysql57-community-release-el7.rpm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装 MySQL</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y mysql-community-server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>配置 MySQL</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>if [ ! &quot;$(cat /usr/bin/mysqld_pre_systemd | grep -v ^\# | grep initialize-insecure )&quot; ]; then</span></span>
<span class="line"><span>    sed -i &quot;s@--initialize @--initialize-insecure @g&quot; /usr/bin/mysqld_pre_systemd</span></span>
<span class="line"><span>fi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 MySQL</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable mysqld</span></span>
<span class="line"><span>systemctl start mysqld</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>数据库授权</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mysql -uroot</span></span>
<span class="line"><span>Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span>
<span class="line"><span>Your MySQL connection id is 2</span></span>
<span class="line"><span>Server version: 5.7.32 MySQL Community Server (GPL)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Oracle is a registered trademark of Oracle Corporation and/or its</span></span>
<span class="line"><span>affiliates. Other names may be trademarks of their respective</span></span>
<span class="line"><span>owners.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; create database jumpserver default charset &#39;utf8&#39;;</span></span>
<span class="line"><span>Query OK, 1 row affected (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; set global validate_password_policy=LOW;</span></span>
<span class="line"><span>Query OK, 0 rows affected (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; create user &#39;jumpserver&#39;@&#39;%&#39; identified by &#39;KXOeyNgDeTdpeu9q&#39;;</span></span>
<span class="line"><span>Query OK, 0 rows affected (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; grant all on jumpserver.* to &#39;jumpserver&#39;@&#39;%&#39;;</span></span>
<span class="line"><span>Query OK, 0 rows affected, 1 warning (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; flush privileges;</span></span>
<span class="line"><span>Query OK, 0 rows affected (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; exit</span></span>
<span class="line"><span>Bye</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置防火墙</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>firewall-cmd --permanent --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.100.0/24&quot; port protocol=&quot;tcp&quot; port=&quot;3306&quot; accept&quot;</span></span>
<span class="line"><span>firewall-cmd --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-redis-服务" tabindex="-1"><a class="header-anchor" href="#部署-redis-服务"><span>部署 Redis 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.11</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 Repo</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install epel-release https://repo.ius.io/ius-release-el7.rpm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装 Redis</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y redis5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>配置 Redis</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>sed -i &quot;s/bind 127.0.0.1/bind 0.0.0.0/g&quot; /etc/redis.conf</span></span>
<span class="line"><span>sed -i &quot;561i maxmemory-policy allkeys-lru&quot; /etc/redis.conf</span></span>
<span class="line"><span>sed -i &quot;481i requirepass KXOeyNgDeTdpeu9q&quot; /etc/redis.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 Redis</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable redis</span></span>
<span class="line"><span>systemctl start redis</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置防火墙</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>firewall-cmd --permanent --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.100.0/24&quot; port protocol=&quot;tcp&quot; port=&quot;6379&quot; accept&quot;</span></span>
<span class="line"><span>firewall-cmd --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-jumpserver-01" tabindex="-1"><a class="header-anchor" href="#部署-jumpserver-01"><span>部署 JumpServer 01</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.21</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install nfs-utils</span></span>
<span class="line"><span>showmount -e 192.168.100.11</span></span>
<span class="line"><span># 将 Core 持久化目录挂载到 NFS, 默认 /opt/jumpserver/core/data, 请根据实际情况修改</span></span>
<span class="line"><span># JumpServer 持久化目录定义相关参数为 VOLUME_DIR, 在安装 JumpServer 过程中会提示</span></span>
<span class="line"><span>mkdir /opt/jumpserver/core/data</span></span>
<span class="line"><span>mount -t nfs 192.168.100.11:/data /opt/jumpserver/core/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 可以写入到 /etc/fstab, 重启自动挂载. 注意: 设置后如果 nfs 损坏或者无法连接该服务器将无法启动</span></span>
<span class="line"><span>echo &quot;192.168.100.11:/data /opt/jumpserver/core/data nfs defaults 0 0&quot; &gt;&gt; /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 jumpserver-install</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /opt</span></span>
<span class="line"><span>yum -y install wget</span></span>
<span class="line"><span>wget https://github.com/jumpserver/installer/releases/download/v2.21.0/jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>tar -xf jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>cd jumpserver-installer-v2.21.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改配置文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi config-example.txt</span></span>
<span class="line"><span># 修改下面选项, 其他保持默认, 请勿直接复制此处内容</span></span>
<span class="line"><span>### 注意: SECRET_KEY 和要其他 JumpServer 服务器一致, 加密的数据将无法解密</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 安装配置</span></span>
<span class="line"><span>### 注意持久化目录 VOLUME_DIR, 如果上面 NFS 挂载其他目录, 此处也要修改. 如: NFS 挂载到 /data/jumpserver/core/data, 则 VOLUME_DIR=/data/jumpserver</span></span>
<span class="line"><span>VOLUME_DIR=/opt/jumpserver</span></span>
<span class="line"><span>DOCKER_DIR=/var/lib/docker</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Core 配置</span></span>
<span class="line"><span>### 启动后不能再修改，否则密码等等信息无法解密, 请勿直接复制下面的字符串</span></span>
<span class="line"><span>SECRET_KEY=kWQdmdCQKjaWlHYpPhkNQDkfaRulM6YnHctsHLlSPs8287o2kW    # 要其他 JumpServer 服务器一致 (*)</span></span>
<span class="line"><span>BOOTSTRAP_TOKEN=KXOeyNgDeTdpeu9q                                 # 要其他 JumpServer 服务器一致 (*)</span></span>
<span class="line"><span>LOG_LEVEL=ERROR                                                  # 日志等级</span></span>
<span class="line"><span># SESSION_COOKIE_AGE=86400</span></span>
<span class="line"><span>SESSION_EXPIRE_AT_BROWSER_CLOSE=true                             # 关闭浏览器 session 过期</span></span>
<span class="line"><span></span></span>
<span class="line"><span># MySQL 配置</span></span>
<span class="line"><span>USE_EXTERNAL_MYSQL=1                                             # 使用外置 MySQL</span></span>
<span class="line"><span>DB_HOST=192.168.100.11</span></span>
<span class="line"><span>DB_PORT=3306</span></span>
<span class="line"><span>DB_USER=jumpserve</span></span>
<span class="line"><span>DB_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>DB_NAME=jumpserver</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Redis 配置</span></span>
<span class="line"><span>USE_EXTERNAL_REDIS=1                                             # 使用外置 Redis</span></span>
<span class="line"><span>REDIS_HOST=192.168.100.11</span></span>
<span class="line"><span>REDIS_PORT=6379</span></span>
<span class="line"><span>REDIS_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span></span></span>
<span class="line"><span># KoKo Lion 配置</span></span>
<span class="line"><span>SHARE_ROOM_TYPE=redis                                            # KoKo Lion 使用 redis 共享</span></span>
<span class="line"><span>REUSE_CONNECTION=false                                           # Koko 禁用连接复用</span></span>
<span class="line"><span>./jmsctl.sh install</span></span>
<span class="line"><span>       ██╗██╗   ██╗███╗   ███╗██████╗ ███████╗███████╗██████╗ ██╗   ██╗███████╗██████╗</span></span>
<span class="line"><span>       ██║██║   ██║████╗ ████║██╔══██╗██╔════╝██╔════╝██╔══██╗██║   ██║██╔════╝██╔══██╗</span></span>
<span class="line"><span>       ██║██║   ██║██╔████╔██║██████╔╝███████╗█████╗  ██████╔╝██║   ██║█████╗  ██████╔╝</span></span>
<span class="line"><span>  ██   ██║██║   ██║██║╚██╔╝██║██╔═══╝ ╚════██║██╔══╝  ██╔══██╗╚██╗ ██╔╝██╔══╝  ██╔══██╗</span></span>
<span class="line"><span>  ╚█████╔╝╚██████╔╝██║ ╚═╝ ██║██║     ███████║███████╗██║  ██║ ╚████╔╝ ███████╗██║  ██║</span></span>
<span class="line"><span>   ╚════╝  ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚══════╝╚══════╝╚═╝  ╚═╝  ╚═══╝  ╚══════╝╚═╝  ╚═╝</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                                                                     Version:  v2.21.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. 检查配置文件</span></span>
<span class="line"><span>配置文件位置: /opt/jumpserver/config</span></span>
<span class="line"><span>/opt/jumpserver/config/config.txt  [ √ ]</span></span>
<span class="line"><span>/opt/jumpserver/config/nginx/lb_rdp_server.conf  [ √ ]</span></span>
<span class="line"><span>/opt/jumpserver/config/nginx/lb_ssh_server.conf  [ √ ]</span></span>
<span class="line"><span>/opt/jumpserver/config/nginx/cert/server.crt  [ √ ]</span></span>
<span class="line"><span>/opt/jumpserver/config/nginx/cert/server.key  [ √ ]</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 备份配置文件</span></span>
<span class="line"><span>备份至 /opt/jumpserver/config/backup/config.txt.2021-07-15_22-26-13</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; 安装配置 Docker</span></span>
<span class="line"><span>1. 安装 Docker</span></span>
<span class="line"><span>开始下载 Docker 程序 ...</span></span>
<span class="line"><span>开始下载 Docker Compose 程序 ...</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 配置 Docker</span></span>
<span class="line"><span>是否需要自定义 docker 存储目录, 默认将使用目录 /var/lib/docker? (y/n)  (默认为 n): n</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. 启动 Docker</span></span>
<span class="line"><span>Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /etc/systemd/system/docker.service.</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; 加载 Docker 镜像</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/core:v2.21.0        [ OK ]</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/koko:v2.21.0        [ OK ]</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/web:v2.21.0         [ OK ]</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/redis:6-alpine      [ OK ]</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/mysql:5             [ OK ]</span></span>
<span class="line"><span>Docker: Pulling from jumpserver/lion:v2.21.0        [ OK ]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; 安装配置 JumpServer</span></span>
<span class="line"><span>1. 配置网络</span></span>
<span class="line"><span>是否需要支持 IPv6? (y/n)  (默认为 n): n</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 配置加密密钥</span></span>
<span class="line"><span>SECRETE_KEY:     YTE2YTVkMTMtMGE3MS00YzI5LWFlOWEtMTc2OWJlMmIyMDE2</span></span>
<span class="line"><span>BOOTSTRAP_TOKEN: YTE2YTVkMTMtMGE3</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. 配置持久化目录</span></span>
<span class="line"><span>是否需要自定义持久化存储, 默认将使用目录 /opt/jumpserver? (y/n)  (默认为 n): n</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. 配置 MySQL</span></span>
<span class="line"><span>是否使用外部 MySQL? (y/n)  (默认为 n): y</span></span>
<span class="line"><span>请输入 MySQL 的主机地址 (无默认值): 192.168.100.11</span></span>
<span class="line"><span>请输入 MySQL 的端口 (默认为3306): 3306</span></span>
<span class="line"><span>请输入 MySQL 的数据库(事先做好授权) (默认为jumpserver): jumpserver</span></span>
<span class="line"><span>请输入 MySQL 的用户名 (无默认值): jumpserver</span></span>
<span class="line"><span>请输入 MySQL 的密码 (无默认值): KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>5. 配置 Redis</span></span>
<span class="line"><span>是否使用外部 Redis? (y/n)  (默认为 n): y</span></span>
<span class="line"><span>请输入 Redis 的主机地址 (无默认值): 192.168.100.11</span></span>
<span class="line"><span>请输入 Redis 的端口 (默认为6379): 6379</span></span>
<span class="line"><span>请输入 Redis 的密码 (无默认值): KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>6. 配置对外端口</span></span>
<span class="line"><span>是否需要配置 JumpServer 对外访问端口? (y/n)  (默认为 n): n</span></span>
<span class="line"><span>完成</span></span>
<span class="line"><span></span></span>
<span class="line"><span>7. 初始化数据库</span></span>
<span class="line"><span>Creating network &quot;jms_net&quot; with driver &quot;bridge&quot;</span></span>
<span class="line"><span>Creating jms_redis ... done</span></span>
<span class="line"><span>2021-07-15 22:39:52 Collect static files</span></span>
<span class="line"><span>2021-07-15 22:39:52 Collect static files done</span></span>
<span class="line"><span>2021-07-15 22:39:52 Check database structure change ...</span></span>
<span class="line"><span>2021-07-15 22:39:52 Migrate model change to database ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>475 static files copied to &#39;/opt/jumpserver/data/static&#39;.</span></span>
<span class="line"><span>Operations to perform:</span></span>
<span class="line"><span>  Apply all migrations: acls, admin, applications, assets, audits, auth, authentication, captcha, common, contenttypes, django_cas_ng, django_celery_beat, jms_oidc_rp, notifications, ops, orgs, perms, sessions, settings, terminal, tickets, users</span></span>
<span class="line"><span>Running migrations:</span></span>
<span class="line"><span>  Applying contenttypes.0001_initial... OK</span></span>
<span class="line"><span>  Applying contenttypes.0002_remove_content_type_name... OK</span></span>
<span class="line"><span>  Applying auth.0001_initial... OK</span></span>
<span class="line"><span>  Applying auth.0002_alter_permission_name_max_length... OK</span></span>
<span class="line"><span>  Applying auth.0003_alter_user_email_max_length... OK</span></span>
<span class="line"><span>  Applying auth.0004_alter_user_username_opts... OK</span></span>
<span class="line"><span>  Applying auth.0005_alter_user_last_login_null... OK</span></span>
<span class="line"><span>  Applying auth.0006_require_contenttypes_0002... OK</span></span>
<span class="line"><span>  Applying auth.0007_alter_validators_add_error_messages... OK</span></span>
<span class="line"><span>  Applying auth.0008_alter_user_username_max_length... OK</span></span>
<span class="line"><span>  ...</span></span>
<span class="line"><span>  Applying sessions.0001_initial... OK</span></span>
<span class="line"><span>  Applying terminal.0032_auto_20210302_1853... OK</span></span>
<span class="line"><span>  Applying terminal.0033_auto_20210324_1008... OK</span></span>
<span class="line"><span>  Applying terminal.0034_auto_20210406_1434... OK</span></span>
<span class="line"><span>  Applying terminal.0035_auto_20210517_1448... OK</span></span>
<span class="line"><span>  Applying terminal.0036_auto_20210604_1124... OK</span></span>
<span class="line"><span>  Applying terminal.0037_auto_20210623_1748... OK</span></span>
<span class="line"><span>  Applying tickets.0008_auto_20210311_1113... OK</span></span>
<span class="line"><span>  Applying tickets.0009_auto_20210426_1720... OK</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; 安装完成了</span></span>
<span class="line"><span>1. 可以使用如下命令启动, 然后访问</span></span>
<span class="line"><span>cd /root/jumpserver-installer-v2.21.0</span></span>
<span class="line"><span>./jmsctl.sh start</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 其它一些管理命令</span></span>
<span class="line"><span>./jmsctl.sh stop</span></span>
<span class="line"><span>./jmsctl.sh restart</span></span>
<span class="line"><span>./jmsctl.sh backup</span></span>
<span class="line"><span>./jmsctl.sh upgrade</span></span>
<span class="line"><span>更多还有一些命令, 你可以 ./jmsctl.sh --help 来了解</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. Web 访问</span></span>
<span class="line"><span>http://192.168.100.212:80</span></span>
<span class="line"><span>默认用户: admin  默认密码: admin</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4. SSH/SFTP 访问</span></span>
<span class="line"><span>ssh -p2222 admin@192.168.100.212</span></span>
<span class="line"><span>sftp -P2222 admin@192.168.100.212</span></span>
<span class="line"><span></span></span>
<span class="line"><span>5. 更多信息</span></span>
<span class="line"><span>我们的官网: https://www.jumpserver.org/</span></span>
<span class="line"><span>我们的文档: https://docs.jumpserver.org/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 JumpServer</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>./jmsctl.sh start</span></span>
<span class="line"><span>Creating network &quot;jms_net&quot; with driver &quot;bridge&quot;</span></span>
<span class="line"><span>Creating jms_core      ... done</span></span>
<span class="line"><span>Creating jms_celery    ... done</span></span>
<span class="line"><span>Creating jms_lion      ... done</span></span>
<span class="line"><span>Creating jms_koko      ... done</span></span>
<span class="line"><span>Creating jms_magnus    ... done</span></span>
<span class="line"><span>Creating jms_web       ... done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-jumpserver-02" tabindex="-1"><a class="header-anchor" href="#部署-jumpserver-02"><span>部署 JumpServer 02</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.22</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install nfs-utils</span></span>
<span class="line"><span>showmount -e 192.168.100.11</span></span>
<span class="line"><span># 将 Core 持久化目录挂载到 NFS, 默认 /opt/jumpserver/core/data, 请根据实际情况修改</span></span>
<span class="line"><span># JumpServer 持久化目录定义相关参数为 VOLUME_DIR, 在安装 JumpServer 过程中会提示</span></span>
<span class="line"><span>mkdir /opt/jumpserver/core/data</span></span>
<span class="line"><span>mount -t nfs 192.168.100.11:/data /opt/jumpserver/core/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 可以写入到 /etc/fstab, 重启自动挂载. 注意: 设置后如果 nfs 损坏或者无法连接该服务器将无法启动</span></span>
<span class="line"><span>echo &quot;192.168.100.11:/data /opt/jumpserver/core/data nfs defaults 0 0&quot; &gt;&gt; /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 jumpserver-install</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /opt</span></span>
<span class="line"><span>yum -y install wget</span></span>
<span class="line"><span>wget https://github.com/jumpserver/installer/releases/download/v2.21.0/jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>tar -xf jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>cd jumpserver-installer-v2.21.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改配置文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi config-example.txt</span></span>
<span class="line"><span># 修改下面选项, 其他保持默认, 请勿直接复制此处内容</span></span>
<span class="line"><span>### 注意: SECRET_KEY 和要其他 JumpServer 服务器一致, 加密的数据将无法解密</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 安装配置</span></span>
<span class="line"><span>### 注意持久化目录 VOLUME_DIR, 如果上面 NFS 挂载其他目录, 此处也要修改. 如: NFS 挂载到/data/jumpserver/core/data, 则 DOCKER_DIR=/data/jumpserver</span></span>
<span class="line"><span>VOLUME_DIR=/opt/jumpserver</span></span>
<span class="line"><span>DOCKER_DIR=/var/lib/docker</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Core 配置</span></span>
<span class="line"><span>### 启动后不能再修改，否则密码等等信息无法解密, 请勿直接复制下面的字符串</span></span>
<span class="line"><span>SECRET_KEY=kWQdmdCQKjaWlHYpPhkNQDkfaRulM6YnHctsHLlSPs8287o2kW</span></span>
<span class="line"><span>BOOTSTRAP_TOKEN=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>LOG_LEVEL=ERROR</span></span>
<span class="line"><span># SESSION_COOKIE_AGE=86400</span></span>
<span class="line"><span>SESSION_EXPIRE_AT_BROWSER_CLOSE=true</span></span>
<span class="line"><span></span></span>
<span class="line"><span># MySQL 配置</span></span>
<span class="line"><span>USE_EXTERNAL_MYSQL=1</span></span>
<span class="line"><span>DB_HOST=192.168.100.11</span></span>
<span class="line"><span>DB_PORT=3306</span></span>
<span class="line"><span>DB_USER=jumpserver</span></span>
<span class="line"><span>DB_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>DB_NAME=jumpserver</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Redis 配置</span></span>
<span class="line"><span>USE_EXTERNAL_REDIS=1</span></span>
<span class="line"><span>REDIS_HOST=192.168.100.11</span></span>
<span class="line"><span>REDIS_PORT=6379</span></span>
<span class="line"><span>REDIS_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span></span></span>
<span class="line"><span># KoKo Lion 配置</span></span>
<span class="line"><span>SHARE_ROOM_TYPE=redis</span></span>
<span class="line"><span>./jmsctl.sh install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 JumpServer</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>./jmsctl.sh start</span></span>
<span class="line"><span>Creating network &quot;jms_net&quot; with driver &quot;bridge&quot;</span></span>
<span class="line"><span>Creating jms_core      ... done</span></span>
<span class="line"><span>Creating jms_celery    ... done</span></span>
<span class="line"><span>Creating jms_lion      ... done</span></span>
<span class="line"><span>Creating jms_koko      ... done</span></span>
<span class="line"><span>Creating jms_magnus    ... done</span></span>
<span class="line"><span>Creating jms_web       ... done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-jumpserver-03" tabindex="-1"><a class="header-anchor" href="#部署-jumpserver-03"><span>部署 JumpServer 03</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.23</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install nfs-utils</span></span>
<span class="line"><span>showmount -e 192.168.100.11</span></span>
<span class="line"><span># 将 Core 持久化目录挂载到 NFS, 默认 /opt/jumpserver/core/data, 请根据实际情况修改</span></span>
<span class="line"><span># JumpServer 持久化目录定义相关参数为 VOLUME_DIR, 在安装 JumpServer 过程中会提示</span></span>
<span class="line"><span>mkdir /opt/jumpserver/core/data</span></span>
<span class="line"><span>mount -t nfs 192.168.100.11:/data /opt/jumpserver/core/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 可以写入到 /etc/fstab, 重启自动挂载. 注意: 设置后如果 nfs 损坏或者无法连接该服务器将无法启动</span></span>
<span class="line"><span>echo &quot;192.168.100.11:/data /opt/jumpserver/core/data nfs defaults 0 0&quot; &gt;&gt; /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 jumpserver-install</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /opt</span></span>
<span class="line"><span>yum -y install wget</span></span>
<span class="line"><span>wget https://github.com/jumpserver/installer/releases/download/v2.21.0/jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>tar -xf jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>cd jumpserver-installer-v2.21.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改配置文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi config-example.txt</span></span>
<span class="line"><span># 修改下面选项, 其他保持默认, 请勿直接复制此处内容</span></span>
<span class="line"><span>### 注意: SECRET_KEY 和要其他 JumpServer 服务器一致, 加密的数据将无法解密</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 安装配置</span></span>
<span class="line"><span>### 注意持久化目录 VOLUME_DIR, 如果上面 NFS 挂载其他目录, 此处也要修改. 如: NFS 挂载到/data/jumpserver/core/data, 则 DOCKER_DIR=/data/jumpserver</span></span>
<span class="line"><span>VOLUME_DIR=/opt/jumpserver</span></span>
<span class="line"><span>DOCKER_DIR=/var/lib/docker</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Core 配置</span></span>
<span class="line"><span>### 启动后不能再修改，否则密码等等信息无法解密, 请勿直接复制下面的字符串</span></span>
<span class="line"><span>SECRET_KEY=kWQdmdCQKjaWlHYpPhkNQDkfaRulM6YnHctsHLlSPs8287o2kW</span></span>
<span class="line"><span>BOOTSTRAP_TOKEN=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>LOG_LEVEL=ERROR</span></span>
<span class="line"><span># SESSION_COOKIE_AGE=86400</span></span>
<span class="line"><span>SESSION_EXPIRE_AT_BROWSER_CLOSE=true</span></span>
<span class="line"><span></span></span>
<span class="line"><span># MySQL 配置</span></span>
<span class="line"><span>USE_EXTERNAL_MYSQL=1</span></span>
<span class="line"><span>DB_HOST=192.168.100.11</span></span>
<span class="line"><span>DB_PORT=3306</span></span>
<span class="line"><span>DB_USER=jumpserver</span></span>
<span class="line"><span>DB_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>DB_NAME=jumpserver</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Redis 配置</span></span>
<span class="line"><span>USE_EXTERNAL_REDIS=1</span></span>
<span class="line"><span>REDIS_HOST=192.168.100.11</span></span>
<span class="line"><span>REDIS_PORT=6379</span></span>
<span class="line"><span>REDIS_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span></span></span>
<span class="line"><span># KoKo Lion 配置</span></span>
<span class="line"><span>SHARE_ROOM_TYPE=redis</span></span>
<span class="line"><span>REUSE_CONNECTION=false</span></span>
<span class="line"><span>./jmsctl.sh install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 JumpServer</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>./jmsctl.sh start</span></span>
<span class="line"><span>Creating network &quot;jms_net&quot; with driver &quot;bridge&quot;</span></span>
<span class="line"><span>Creating jms_core      ... done</span></span>
<span class="line"><span>Creating jms_lion      ... done</span></span>
<span class="line"><span>Creating jms_koko      ... done</span></span>
<span class="line"><span>Creating jms_celery    ... done</span></span>
<span class="line"><span>Creating jms_magnus    ... done</span></span>
<span class="line"><span>Creating jms_web       ... done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-jumpserver-04" tabindex="-1"><a class="header-anchor" href="#部署-jumpserver-04"><span>部署 JumpServer 04</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.24</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 NFS</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install nfs-utils</span></span>
<span class="line"><span>showmount -e 192.168.100.11</span></span>
<span class="line"><span># 将 Core 持久化目录挂载到 NFS, 默认 /opt/jumpserver/core/data, 请根据实际情况修改</span></span>
<span class="line"><span># JumpServer 持久化目录定义相关参数为 VOLUME_DIR, 在安装 JumpServer 过程中会提示</span></span>
<span class="line"><span>mkdir /opt/jumpserver/core/data</span></span>
<span class="line"><span>mount -t nfs 192.168.100.11:/data /opt/jumpserver/core/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 可以写入到 /etc/fstab, 重启自动挂载. 注意: 设置后如果 nfs 损坏或者无法连接该服务器将无法启动</span></span>
<span class="line"><span>echo &quot;192.168.100.11:/data /opt/jumpserver/core/data nfs defaults 0 0&quot; &gt;&gt; /etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 jumpserver-install</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /opt</span></span>
<span class="line"><span>yum -y install wget</span></span>
<span class="line"><span>wget https://github.com/jumpserver/installer/releases/download/v2.21.0/jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>tar -xf jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>cd jumpserver-installer-v2.21.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改配置文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi config-example.txt</span></span>
<span class="line"><span># 修改下面选项, 其他保持默认, 请勿直接复制此处内容</span></span>
<span class="line"><span>### 注意: SECRET_KEY 和要其他 JumpServer 服务器一致, 加密的数据将无法解密</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 安装配置</span></span>
<span class="line"><span>### 注意持久化目录 VOLUME_DIR, 如果上面 NFS 挂载其他目录, 此处也要修改. 如: NFS 挂载到/data/jumpserver/core/data, 则 DOCKER_DIR=/data/jumpserver</span></span>
<span class="line"><span>VOLUME_DIR=/opt/jumpserver</span></span>
<span class="line"><span>DOCKER_DIR=/var/lib/docker</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Core 配置</span></span>
<span class="line"><span>### 启动后不能再修改，否则密码等等信息无法解密, 请勿直接复制下面的字符串</span></span>
<span class="line"><span>SECRET_KEY=kWQdmdCQKjaWlHYpPhkNQDkfaRulM6YnHctsHLlSPs8287o2kW</span></span>
<span class="line"><span>BOOTSTRAP_TOKEN=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>LOG_LEVEL=ERROR</span></span>
<span class="line"><span># SESSION_COOKIE_AGE=86400</span></span>
<span class="line"><span>SESSION_EXPIRE_AT_BROWSER_CLOSE=true</span></span>
<span class="line"><span></span></span>
<span class="line"><span># MySQL 配置</span></span>
<span class="line"><span>USE_EXTERNAL_MYSQL=1</span></span>
<span class="line"><span>DB_HOST=192.168.100.11</span></span>
<span class="line"><span>DB_PORT=3306</span></span>
<span class="line"><span>DB_USER=jumpserver</span></span>
<span class="line"><span>DB_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span>DB_NAME=jumpserver</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Redis 配置</span></span>
<span class="line"><span>USE_EXTERNAL_REDIS=1</span></span>
<span class="line"><span>REDIS_HOST=192.168.100.11</span></span>
<span class="line"><span>REDIS_PORT=6379</span></span>
<span class="line"><span>REDIS_PASSWORD=KXOeyNgDeTdpeu9q</span></span>
<span class="line"><span></span></span>
<span class="line"><span># KoKo Lion 配置</span></span>
<span class="line"><span>SHARE_ROOM_TYPE=redis</span></span>
<span class="line"><span>REUSE_CONNECTION=false</span></span>
<span class="line"><span>./jmsctl.sh install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 JumpServer</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>./jmsctl.sh start</span></span>
<span class="line"><span>Creating network &quot;jms_net&quot; with driver &quot;bridge&quot;</span></span>
<span class="line"><span>Creating jms_core      ... done</span></span>
<span class="line"><span>Creating jms_celery    ... done</span></span>
<span class="line"><span>Creating jms_lion      ... done</span></span>
<span class="line"><span>Creating jms_koko      ... done</span></span>
<span class="line"><span>Creating jms_magnus    ... done</span></span>
<span class="line"><span>Creating jms_web       ... done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-haproxy-服务" tabindex="-1"><a class="header-anchor" href="#部署-haproxy-服务"><span>部署 HAProxy 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>安装依赖</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum -y install epel-release</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>安装 HAProxy</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y haproxy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>配置 HAProxy</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vi /etc/haproxy/haproxy.cfg</span></span>
<span class="line"><span>global</span></span>
<span class="line"><span>    # to have these messages end up in /var/log/haproxy.log you will</span></span>
<span class="line"><span>    # need to:</span></span>
<span class="line"><span>    #</span></span>
<span class="line"><span>    # 1) configure syslog to accept network log events.  This is done</span></span>
<span class="line"><span>    #    by adding the &#39;-r&#39; option to the SYSLOGD_OPTIONS in</span></span>
<span class="line"><span>    #    /etc/sysconfig/syslog</span></span>
<span class="line"><span>    #</span></span>
<span class="line"><span>    # 2) configure local2 events to go to the /var/log/haproxy.log</span></span>
<span class="line"><span>    #   file. A line like the following can be added to</span></span>
<span class="line"><span>    #   /etc/sysconfig/syslog</span></span>
<span class="line"><span>    #</span></span>
<span class="line"><span>    #    local2.*                       /var/log/haproxy.log</span></span>
<span class="line"><span>    #</span></span>
<span class="line"><span>    log         127.0.0.1 local2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    chroot      /var/lib/haproxy</span></span>
<span class="line"><span>    pidfile     /var/run/haproxy.pid</span></span>
<span class="line"><span>    maxconn     4000</span></span>
<span class="line"><span>    user        haproxy</span></span>
<span class="line"><span>    group       haproxy</span></span>
<span class="line"><span>    daemon</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # turn on stats unix socket</span></span>
<span class="line"><span>    stats socket /var/lib/haproxy/stats</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#---------------------------------------------------------------------</span></span>
<span class="line"><span># common defaults that all the &#39;listen&#39; and &#39;backend&#39; sections will</span></span>
<span class="line"><span># use if not designated in their block</span></span>
<span class="line"><span>#---------------------------------------------------------------------</span></span>
<span class="line"><span>defaults</span></span>
<span class="line"><span>    log                     global</span></span>
<span class="line"><span>    option                  dontlognull</span></span>
<span class="line"><span>    option                  redispatch</span></span>
<span class="line"><span>    retries                 3</span></span>
<span class="line"><span>    timeout http-request    10s</span></span>
<span class="line"><span>    timeout queue           1m</span></span>
<span class="line"><span>    timeout connect         10s</span></span>
<span class="line"><span>    timeout client          1m</span></span>
<span class="line"><span>    timeout server          1m</span></span>
<span class="line"><span>    timeout http-keep-alive 10s</span></span>
<span class="line"><span>    timeout check           10s</span></span>
<span class="line"><span>    maxconn                 3000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen stats</span></span>
<span class="line"><span>    bind *:8080</span></span>
<span class="line"><span>    mode http</span></span>
<span class="line"><span>    stats enable</span></span>
<span class="line"><span>    stats uri /haproxy                      # 监控页面, 请自行修改. 访问地址为 http://192.168.100.100:8080/haproxy</span></span>
<span class="line"><span>    stats refresh 5s</span></span>
<span class="line"><span>    stats realm haproxy-status</span></span>
<span class="line"><span>    stats auth admin:KXOeyNgDeTdpeu9q       # 账户密码, 请自行修改. 访问 http://192.168.100.100:8080/haproxy 会要求输入</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#---------------------------------------------------------------------</span></span>
<span class="line"><span># check  检活参数说明</span></span>
<span class="line"><span># inter  间隔时间, 单位: 毫秒</span></span>
<span class="line"><span># rise   连续成功的次数, 单位: 次</span></span>
<span class="line"><span># fall   连续失败的次数, 单位: 次</span></span>
<span class="line"><span># 例: inter 2s rise 2 fall 3</span></span>
<span class="line"><span># 表示 2 秒检查一次状态, 连续成功 2 次服务正常, 连续失败 3 次服务异常</span></span>
<span class="line"><span>#</span></span>
<span class="line"><span># server 服务参数说明</span></span>
<span class="line"><span># server 192.168.100.21 192.168.100.21:80 weight 1 cookie web01</span></span>
<span class="line"><span># 第一个 192.168.100.21 做为页面展示的标识, 可以修改为其他任意字符串</span></span>
<span class="line"><span># 第二个 192.168.100.21:80 是实际的后端服务端口</span></span>
<span class="line"><span># weight 为权重, 多节点时安装权重进行负载均衡</span></span>
<span class="line"><span># cookie 用户侧的 cookie 会包含此标识, 便于区分当前访问的后端节点</span></span>
<span class="line"><span># 例: server db01 192.168.100.21:3306 weight 1 cookie db_01</span></span>
<span class="line"><span>#---------------------------------------------------------------------</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-web</span></span>
<span class="line"><span>    bind *:80                               # 监听 80 端口</span></span>
<span class="line"><span>    mode http</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    # redirect scheme https if !{ ssl_fc }  # 重定向到 https</span></span>
<span class="line"><span>    # bind *:443 ssl crt /opt/ssl.pem       # https 设置</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option httpclose</span></span>
<span class="line"><span>    option forwardfor</span></span>
<span class="line"><span>    option httpchk GET /api/health/         # Core 检活接口</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    cookie SERVERID insert indirect</span></span>
<span class="line"><span>    hash-type consistent</span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance leastconn</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:80 weight 1 cookie web01 check inter 2s rise 2 fall 3  # JumpServer 服务器</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:80 weight 1 cookie web02 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.24:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-ssh</span></span>
<span class="line"><span>    bind *:2222</span></span>
<span class="line"><span>    mode tcp</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option tcp-check</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance source</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:2222 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:2222 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:2222 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.24 192.168.100.23:2222 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-koko</span></span>
<span class="line"><span>    mode http</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option httpclose</span></span>
<span class="line"><span>    option forwardfor</span></span>
<span class="line"><span>    option httpchk GET /koko/health/ HTTP/1.1\r\nHost:\ 192.168.100.100  # KoKo 检活接口, host 填写 HAProxy 的 ip 地址</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    cookie SERVERID insert indirect</span></span>
<span class="line"><span>    hash-type consistent</span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance leastconn</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:80 weight 1 cookie web01 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:80 weight 1 cookie web02 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.24 192.168.100.23:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-lion</span></span>
<span class="line"><span>    mode http</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option httpclose</span></span>
<span class="line"><span>    option forwardfor</span></span>
<span class="line"><span>    option httpchk GET /lion/health/ HTTP/1.1\r\nHost:\ 192.168.100.100  # Lion 检活接口, host 填写 HAProxy 的 ip 地址</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    cookie SERVERID insert indirect</span></span>
<span class="line"><span>    hash-type consistent</span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance leastconn</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:80 weight 1 cookie web01 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:80 weight 1 cookie web02 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span>    server 192.168.100.24 192.168.100.23:80 weight 1 cookie web03 check inter 2s rise 2 fall 3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-mysql</span></span>
<span class="line"><span>    bind *:33060</span></span>
<span class="line"><span>    mode tcp</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option tcp-check</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance source</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:33060 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:33060 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:33060 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.24 192.168.100.23:33060 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listen jms-mariadb</span></span>
<span class="line"><span>    bind *:33061</span></span>
<span class="line"><span>    mode tcp</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    option tcp-check</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    fullconn 500</span></span>
<span class="line"><span>    balance source</span></span>
<span class="line"><span>    server 192.168.100.21 192.168.100.21:33061 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.22 192.168.100.22:33061 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.23 192.168.100.23:33061 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span>
<span class="line"><span>    server 192.168.100.24 192.168.100.23:33061 weight 1 check inter 2s rise 2 fall 3 send-proxy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 Selinux</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>setsebool -P haproxy_connect_any 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启动 HAProxy</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable haproxy</span></span>
<span class="line"><span>systemctl start haproxy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>配置防火墙</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>firewall-cmd --permanent --zone=public --add-port=80/tcp</span></span>
<span class="line"><span>firewall-cmd --permanent --zone=public --add-port=443/tcp</span></span>
<span class="line"><span>firewall-cmd --permanent --zone=public --add-port=2222/tcp</span></span>
<span class="line"><span>firewall-cmd --permanent --zone=public --add-port=33060/tcp</span></span>
<span class="line"><span>firewall-cmd --permanent --zone=public --add-port=33061/tcp</span></span>
<span class="line"><span>firewall-cmd --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="部署-minio-服务" tabindex="-1"><a class="header-anchor" href="#部署-minio-服务"><span>部署 MinIO 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.41</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 集群部署请参考 (http://docs.minio.org.cn/docs/master/minio-erasure-code-quickstart-guide)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y yum-utils device-mapper-persistent-data lvm2</span></span>
<span class="line"><span>yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"><span>sed -i &#39;s+download.docker.com+mirrors.aliyun.com/docker-ce+&#39; /etc/yum.repos.d/docker-ce.repo</span></span>
<span class="line"><span>yum makecache fast</span></span>
<span class="line"><span>yum -y install docker-ce</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir /etc/docker/</span></span>
<span class="line"><span>vi /etc/docker/daemon.json</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;live-restore&quot;: true,</span></span>
<span class="line"><span>  &quot;registry-mirrors&quot;: [&quot;https://hub-mirror.c.163.com&quot;, &quot;https://bmtrgdvx.mirror.aliyuncs.com&quot;, &quot;http://f1361db2.m.daocloud.io&quot;],</span></span>
<span class="line"><span>  &quot;log-driver&quot;: &quot;json-file&quot;,</span></span>
<span class="line"><span>  &quot;log-opts&quot;: {&quot;max-file&quot;: &quot;3&quot;, &quot;max-size&quot;: &quot;10m&quot;}</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable docker</span></span>
<span class="line"><span>systemctl start docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 MinIO 镜像</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker pull minio/minio:latest</span></span>
<span class="line"><span>latest: Pulling from minio/minio</span></span>
<span class="line"><span>a591faa84ab0: Pull complete</span></span>
<span class="line"><span>76b9354adec6: Pull complete</span></span>
<span class="line"><span>f9d8746550a4: Pull complete</span></span>
<span class="line"><span>890b1dd95baa: Pull complete</span></span>
<span class="line"><span>3a8518c890dc: Pull complete</span></span>
<span class="line"><span>8053f0501aed: Pull complete</span></span>
<span class="line"><span>506c41cb8532: Pull complete</span></span>
<span class="line"><span>Digest: sha256:e7a725edb521dd2af07879dad88ee1dfebd359e57ad8d98104359ccfbdb92024</span></span>
<span class="line"><span>Status: Downloaded newer image for minio/minio:latest</span></span>
<span class="line"><span>docker.io/minio/minio:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>持久化数据目录</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir -p /opt/jumpserver/minio/data /opt/jumpserver/minio/config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启动 MinIO</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>## 请自行修改账号密码并牢记，丢失后可以删掉容器后重新用新密码创建，数据不会丢失</span></span>
<span class="line"><span># 9000                                  # api     访问端口</span></span>
<span class="line"><span># 9001                                  # console 访问端口</span></span>
<span class="line"><span># MINIO_ROOT_USER=minio                 # minio 账号</span></span>
<span class="line"><span># MINIO_ROOT_PASSWORD=KXOeyNgDeTdpeu9q  # minio 密码</span></span>
<span class="line"><span>docker run --name jms_minio -d -p 9000:9000 -p 9001:9001 -e MINIO_ROOT_USER=minio -e MINIO_ROOT_PASSWORD=KXOeyNgDeTdpeu9q -v /opt/jumpserver/minio/data:/data -v /opt/jumpserver/minio/config:/root/.minio --restart=always minio/minio:latest server /data --console-address &quot;:9001&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 MinIO</p><ul><li>访问 http://192.168.100.41:9000，输入刚才设置的 MinIO 账号密码登录</li><li>点击左侧菜单的 Buckets，选择 Create Bucket 创建桶，Bucket Name 输入 jumpserver，然后点击 Save 保存</li></ul><p>设置 JumpServer</p><ul><li>访问 JumpServer Web 页面并使用管理员账号进行登录</li><li>点击左侧菜单栏的 [终端管理]，在页面的上方选择 [存储配置]，在 [录像存储] 下方选择 [创建] 选择 [Ceph]</li><li>根据下方的说明进行填写，保存后在 [终端管理] 页面对所有组件进行 [更新]，录像存储选择 [jms-mino]，提交</li></ul><table><thead><tr><th>选项</th><th>参考值</th><th>说明</th></tr></thead><tbody><tr><td>名称 (Name)</td><td>jms-minio</td><td>标识, 不可重复</td></tr><tr><td>类型 (Type)</td><td>Ceph</td><td>固定, 不可更改</td></tr><tr><td>桶名称 (Bucket)</td><td>jumpserver</td><td>Bucket Name</td></tr><tr><td>Access key</td><td>minio</td><td>MINIO_ROOT_USER</td></tr><tr><td>Secret key</td><td>KXOeyNgDeTdpeu9q</td><td>MINIO_ROOT_PASSWORD</td></tr><tr><td>端点 (Endpoint)</td><td>http://192.168.100.41:9000</td><td>minio 服务访问地址</td></tr><tr><td>默认存储</td><td></td><td>新组件将自动使用该存储</td></tr></tbody></table><h2 id="部署-elasticsearch-服务" tabindex="-1"><a class="header-anchor" href="#部署-elasticsearch-服务"><span>部署 Elasticsearch 服务</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>服务器: 192.168.100.51</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 集群部署请参考 (https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>yum install -y yum-utils device-mapper-persistent-data lvm2</span></span>
<span class="line"><span>yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"><span>sed -i &#39;s+download.docker.com+mirrors.aliyun.com/docker-ce+&#39; /etc/yum.repos.d/docker-ce.repo</span></span>
<span class="line"><span>yum makecache fast</span></span>
<span class="line"><span>yum -y install docker-ce</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir /etc/docker/</span></span>
<span class="line"><span>vi /etc/docker/daemon.json</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  &quot;live-restore&quot;: true,</span></span>
<span class="line"><span>  &quot;registry-mirrors&quot;: [&quot;https://hub-mirror.c.163.com&quot;, &quot;https://bmtrgdvx.mirror.aliyuncs.com&quot;, &quot;http://f1361db2.m.daocloud.io&quot;],</span></span>
<span class="line"><span>  &quot;log-driver&quot;: &quot;json-file&quot;,</span></span>
<span class="line"><span>  &quot;log-opts&quot;: {&quot;max-file&quot;: &quot;3&quot;, &quot;max-size&quot;: &quot;10m&quot;}</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 Docker</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl enable docker</span></span>
<span class="line"><span>systemctl start docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 Elasticsearch 镜像</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker pull docker.elastic.co/elasticsearch/elasticsearch:7.16.1</span></span>
<span class="line"><span>7a0437f04f83: Pull complete</span></span>
<span class="line"><span>7718d2f58c47: Pull complete</span></span>
<span class="line"><span>cc5c16bd8bb9: Pull complete</span></span>
<span class="line"><span>e3d829b4b297: Pull complete</span></span>
<span class="line"><span>1ad944c92c79: Pull complete</span></span>
<span class="line"><span>373fb8fbaf74: Pull complete</span></span>
<span class="line"><span>5908d3eb2989: Pull complete</span></span>
<span class="line"><span>Digest: sha256:81c126e4eddbc5576285670cb3e23d7ef7892ee5e757d6d9ba870b6fe99f1219</span></span>
<span class="line"><span>Status: Downloaded newer image for docker.elastic.co/elasticsearch/elasticsearch:7.16.1</span></span>
<span class="line"><span>docker.elastic.co/elasticsearch/elasticsearch:7.16.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>持久化数据目录</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir -p /opt/jumpserver/elasticsearch/data /opt/jumpserver/elasticsearch/logs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启动 Elasticsearch</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>## 请自行修改账号密码并牢记，丢失后可以删掉容器后重新用新密码创建，数据不会丢失</span></span>
<span class="line"><span># 9200                                  # Web 访问端口</span></span>
<span class="line"><span># 9300                                  # 集群通信</span></span>
<span class="line"><span># discovery.type=single-node            # 单节点</span></span>
<span class="line"><span># bootstrap.memory_lock=&quot;true&quot;          # 锁定物理内存, 不使用 swap</span></span>
<span class="line"><span># xpack.security.enabled=&quot;true&quot;         # 开启安全模块</span></span>
<span class="line"><span># TAKE_FILE_OWNERSHIP=&quot;true&quot;            # 自动修改挂载文件夹的所属用户</span></span>
<span class="line"><span># ES_JAVA_OPTS=&quot;-Xms512m -Xmx512m&quot;      # JVM 内存大小, 推荐设置为主机内存的一半</span></span>
<span class="line"><span># elastic                               # Elasticsearch 账号</span></span>
<span class="line"><span># ELASTIC_PASSWORD=KXOeyNgDeTdpeu9q     # Elasticsearch 密码</span></span>
<span class="line"><span>docker run --name jms_es -d -p 9200:9200 -p 9300:9300 -e cluster.name=docker-cluster -e discovery.type=single-node -e network.host=0.0.0.0 -e bootstrap.memory_lock=&quot;true&quot; -e xpack.security.enabled=&quot;true&quot; -e TAKE_FILE_OWNERSHIP=&quot;true&quot; -e ES_JAVA_OPTS=&quot;-Xms512m -Xmx512m&quot; -e ELASTIC_PASSWORD=KXOeyNgDeTdpeu9q -v /opt/jumpserver/elasticsearch/data:/usr/share/elasticsearch/data -v /opt/jumpserver/elasticsearch/logs:/usr/share/elasticsearch/logs --restart=always docker.elastic.co/elasticsearch/elasticsearch:7.16.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 JumpServer</p><ul><li>访问 JumpServer Web 页面并使用管理员账号进行登录</li><li>点击左侧菜单栏的 [终端管理]，在页面的上方选择 [存储配置]，在 [命令存储] 下方选择 [创建] 选择 [Elasticsearch]</li><li>根据下方的说明进行填写，保存后在 [终端管理] 页面对所有组件进行 [更新]，命令存储选择 [jms-es]，提交</li></ul><table><thead><tr><th>选项</th><th>参考值</th><th>说明</th></tr></thead><tbody><tr><td>名称 (Name)</td><td>jms-es</td><td>标识, 不可重复</td></tr><tr><td>类型 (Type)</td><td>Elasticsearch</td><td>固定, 不可更改</td></tr><tr><td>主机 (Hosts)</td><td>http://elastic:KXOeyNgDeTdpeu9q@192.168.100.51:9200</td><td>http://es_host:es_port</td></tr><tr><td>索引 (Index)</td><td>jumpserver</td><td>索引</td></tr><tr><td>忽略证书认证</td><td></td><td>https 自签 ssl 需要勾选</td></tr><tr><td>默认存储</td><td></td><td>新组件将自动使用该存储</td></tr></tbody></table><h2 id="升级-注意事项" tabindex="-1"><a class="header-anchor" href="#升级-注意事项"><span>升级 注意事项</span></a></h2><p>更新前请一定要做好备份工作</p><ul><li>升级前请关闭所有 JumpServer 节点</li><li>在任意一个 JumpServer 节点按照升级文档完成升级操作</li><li>仔细检查该节点升级过程确保无异常</li><li>然后按照升级文档对其他 JumpServer 节点升级即可</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /opt</span></span>
<span class="line"><span>wget https://github.com/jumpserver/installer/releases/download/v2.21.0/jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>tar -xf jumpserver-installer-v2.21.0.tar.gz</span></span>
<span class="line"><span>cd jumpserver-installer-v2.21.0</span></span>
<span class="line"><span># 额外节点可以设置 SKIP_BACKUP_DB=1 跳过数据库备份, 第一个升级节点不要跳过备份</span></span>
<span class="line"><span>export SKIP_BACKUP_DB=1</span></span>
<span class="line"><span>./jmsctl.sh upgrade</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2024/3/19 09:11:46</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2678885646@qq.com">PaperDragon</span>,<!--]--><!--[--><span class="vp-meta-info" title="email: 2678885646@qq.com">PaperDragon-SH</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/note-book/DistributedSystem/JumperServer/JumperServer%E7%9A%84Docker%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2.html" aria-label="JumperServer的Docker容器部署" iconsizing="both"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->JumperServer的Docker容器部署</div></a><!----></nav><div id="comment" class="waline-wrapper vp-comment" vp-comment darkmode="false" style="display:block;"><!----></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">运维开发绿皮书</div><div class="vp-copyright">copyleft 2023-至今 PaperDragon</div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BkQX7AVe.js" defer></script>


  </body>
</html>