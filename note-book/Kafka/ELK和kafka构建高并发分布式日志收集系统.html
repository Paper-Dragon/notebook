<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    
    <!-- æ·»åŠ ç™¾åº¦æœç´¢éªŒè¯ä»£ç  -->
    <meta name="baidu-site-verification" content="codeva-udZGoBkoXj" />
    <!-- end æ·»åŠ ç™¾åº¦æœç´¢éªŒè¯ä»£ç  -->
    
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ","image":[""],"dateModified":"2025-04-11T02:13:31.000Z","author":[{"@type":"Person","name":"Paper-Dragon","url":"https://github.com/Paper-Dragon","email":"2678885646@qq.com"}]}</script><meta property="og:url" content="https://www.geekery.cn/note-book/Kafka/ELK%E5%92%8Ckafka%E6%9E%84%E5%BB%BA%E9%AB%98%E5%B9%B6%E5%8F%91%E5%88%86%E5%B8%83%E5%BC%8F%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F.html"><meta property="og:site_name" content="è¿ç»´å¼€å‘ç»¿çš®ä¹¦"><meta property="og:title" content="ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ"><meta property="og:description" content="ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ ELK+Kafkaé›†ç¾¤ å‰è¨€ å‰è¨€ ä¸šåŠ¡å±‚å¯ä»¥ç›´æ¥å†™å…¥åˆ°kafkaé˜Ÿåˆ—ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒelasticsearchçš„å†™å…¥æ•ˆç‡é—®é¢˜ã€‚ å›¾ç¤º åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° Kafka Apache kafkaæ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸€ç§ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„ï¼ŒåŸºäºå‘å¸ƒ/è®¢é˜…çš„æ¶ˆæ¯ç³»ç»Ÿã€‚èƒ½å®ç°ä¸€ä¸ªä¸ºå¤„ç†å®æ—¶æ•°æ®æä¾›ä¸€ä¸ªç»Ÿä¸€ã€é«˜ååã€ä½å»¶è¿Ÿçš„å¹³..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-04-11T02:13:31.000Z"><meta property="article:modified_time" content="2025-04-11T02:13:31.000Z"><script>
      /*ç¦ç”¨F12*/
      document.onkeydown = function(){
          if(window.event.keyCode==123) {
              var x;
              var r=confirm('å¤§ä½¬ï¼Œåˆ«æ‰’äº†ï¼ä¸å¦¨åŠ ä¸ªå‹é“¾ï¼Ÿ\nç‚¹å‡»ç¡®è®¤é”®è·³è½¬åˆ°å‹é“¾ï¼\n\næ‰§æ„è¦åšï¼Ÿäº¦æˆ–æ˜¯åŒå‡»F12å¯è°ƒå‡ºæ§åˆ¶å°\n');
              if (r==true){
                //x="ä½ æŒ‰ä¸‹çš„æ˜¯\"ç¡®å®š\"æŒ‰é’®ã€‚";
                window.location.replace("/about/friend.html");
              }
              else{
                x="ä½ æŒ‰ä¸‹çš„æ˜¯\"å–æ¶ˆ\"æŒ‰é’®ã€‚";
              }
              // document.write(x)
              event.preventDefault(); // é˜»æ­¢é»˜è®¤äº‹ä»¶è¡Œä¸º
              event.keyCode=0;
              event.returnValue=false;
          }
      }
      </script><link rel="alternate" type="application/rss+xml" href="https://www.geekery.cn/rss.xml" title="è¿ç»´å¼€å‘ç»¿çš®ä¹¦ RSS Feed"><title>ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ | è¿ç»´å¼€å‘ç»¿çš®ä¹¦</title><meta name="description" content="ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ ELK+Kafkaé›†ç¾¤ å‰è¨€ å‰è¨€ ä¸šåŠ¡å±‚å¯ä»¥ç›´æ¥å†™å…¥åˆ°kafkaé˜Ÿåˆ—ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒelasticsearchçš„å†™å…¥æ•ˆç‡é—®é¢˜ã€‚ å›¾ç¤º åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° Kafka Apache kafkaæ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸€ç§ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„ï¼ŒåŸºäºå‘å¸ƒ/è®¢é˜…çš„æ¶ˆæ¯ç³»ç»Ÿã€‚èƒ½å®ç°ä¸€ä¸ªä¸ºå¤„ç†å®æ—¶æ•°æ®æä¾›ä¸€ä¸ªç»Ÿä¸€ã€é«˜ååã€ä½å»¶è¿Ÿçš„å¹³...">
    <link rel="preload" href="/assets/style-B0yhR6Eh.css" as="style"><link rel="stylesheet" href="/assets/style-B0yhR6Eh.css">
    <link rel="modulepreload" href="/assets/app-8jdLjcXP.js"><link rel="modulepreload" href="/assets/ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ.html-CriAKB9o.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">è¿ç»´å¼€å‘ç»¿çš®ä¹¦</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="line-md:home-twotone" sizing="height" height="1em"></iconify-icon><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/note-book/" aria-label="ä½¿ç”¨æŒ‡å—"><!--[--><iconify-icon class="vp-icon" icon="openmoji:light-bulb" sizing="height" height="1em"></iconify-icon><!--]-->ä½¿ç”¨æŒ‡å—<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å…è´¹æœåŠ¡"><!--[--><iconify-icon class="vp-icon" icon="solar:box-line-duotone" sizing="height" height="1em"></iconify-icon>å…è´¹æœåŠ¡<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/base64.html" aria-label="Base64åœ¨çº¿ç¼–ç è§£ç "><!--[--><iconify-icon class="vp-icon" icon="streamline:device-database-encryption-1-solid" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Base64åœ¨çº¿ç¼–ç è§£ç <!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/cloudflare-warp.html" aria-label="Cloudflare Warp å›¢é˜ŸæœåŠ¡"><!--[--><iconify-icon class="vp-icon" icon="simple-icons:cloudflare" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Cloudflare Warp å›¢é˜ŸæœåŠ¡<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/code-diff.html" aria-label="ä»£ç å·®å¼‚å¯¹æ¯”"><!--[--><iconify-icon class="vp-icon" icon="icon-park-twotone:difference-set" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->ä»£ç å·®å¼‚å¯¹æ¯”<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/cron.html" aria-label="Cronåœ¨çº¿è¡¨è¾¾å¼ç”Ÿæˆå™¨"><!--[--><iconify-icon class="vp-icon" icon="eos-icons:cronjob" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Cronåœ¨çº¿è¡¨è¾¾å¼ç”Ÿæˆå™¨<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/docker-hub-mirror.html" aria-label="DockerHubé•œåƒåŠ é€Ÿ"><!--[--><iconify-icon class="vp-icon" icon="grommet-icons:docker" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->DockerHubé•œåƒåŠ é€Ÿ<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/github-direct.html" aria-label="GitHubåŠ é€Ÿä¸‹è½½"><!--[--><iconify-icon class="vp-icon" icon="mdi:github" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->GitHubåŠ é€Ÿä¸‹è½½<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/nvidia-mirror.html" aria-label="Nvidiaé•œåƒç«™"><!--[--><iconify-icon class="vp-icon" icon="bi:nvidia" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Nvidiaé•œåƒç«™<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/radeon-mirror.html" aria-label="Radeoné•œåƒç«™"><!--[--><iconify-icon class="vp-icon" icon="bi:amd" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Radeoné•œåƒç«™<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/random-password.html" aria-label="å¯†ç ç”Ÿæˆå™¨"><!--[--><iconify-icon class="vp-icon" icon="ph:password" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->å¯†ç ç”Ÿæˆå™¨<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/SSLGenerate.html" aria-label="SSL è¯ä¹¦ç”Ÿæˆ"><!--[--><iconify-icon class="vp-icon" icon="ph:certificate-duotone" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->SSL è¯ä¹¦ç”Ÿæˆ<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/text-reverse.html" aria-label="æ–‡æœ¬å­—ç¬¦ä¸²å€’åº"><!--[--><iconify-icon class="vp-icon" icon="system-uicons:reverse-alt" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->æ–‡æœ¬å­—ç¬¦ä¸²å€’åº<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/free-service/tools.html" aria-label="å°å·¥å…·"><!--[--><iconify-icon class="vp-icon" icon="material-symbols-light:tools-ladder" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->å°å·¥å…·<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="æˆ‘çš„é¡¹ç›®"><!--[--><iconify-icon class="vp-icon" icon="openmoji:man-technologist" sizing="height" height="1em"></iconify-icon>æˆ‘çš„é¡¹ç›®<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Chiptune/" aria-label="Chiptune"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:music" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Chiptune<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/MobaXterm-Cracker/" aria-label="Mobaxterm Crack"><!--[--><img class="vp-icon" src="/MobaXterm-Cracker/README.assets/xterm_logo.png" alt aria-hidden no-view sizing="both" width="1em" height="1em"><!--]-->Mobaxterm Crack<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/projects.html" aria-label="å…¶ä»–é¡¹ç›®"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:folder" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->å…¶ä»–é¡¹ç›®<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="æ—¶é—´çº¿"><!--[--><iconify-icon class="vp-icon" icon="ic:twotone-view-timeline" sizing="height" height="1em"></iconify-icon><!--]-->æ—¶é—´çº¿<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about/friend.html" aria-label="å‹é“¾"><!--[--><iconify-icon class="vp-icon" icon="fa-solid:user-friends" sizing="height" height="1em"></iconify-icon><!--]-->å‹é“¾<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="åšå®¢è”ç›Ÿ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:comment-nodes" sizing="height" height="1em"></iconify-icon>åšå®¢è”ç›Ÿ<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://www.travellings.cn/go.html" aria-label="å¼€å¾€" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="vp-icon" icon="fa:subway" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->å¼€å¾€<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://webteleporter.top" aria-label="WebTeleporter" rel="noopener noreferrer" target="_blank"><!--[--><img class="vp-icon" src="https://webteleporter.top/favicon.ico" alt aria-hidden no-view sizing="both" width="1em" height="1em"><!--]-->WebTeleporter<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="https://cloudflare-cloudnative-pages.geekery.cn/" aria-label="å†…å®¹åˆ†å‘ç½‘ç»œéƒ¨ç½²çŠ¶æ€" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:hexagon-nodes-bolt" sizing="height" height="1em"></iconify-icon><!--]-->å†…å®¹åˆ†å‘<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Paper-Dragon/notebook" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><!----></div><!--[--><div id="docsearch-container" style="display:none;"></div><div class="docsearch-placeholder"><button type="button" aria-label="æœç´¢æ–‡æ¡£" aria-keyshortcuts="Control+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><svg width="20" height="20" viewBox="0 0 24 24" aria-hidden="true" class="DocSearch-Search-Icon"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key DocSearch-Button-Key--ctrl">Ctrl</kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="line-md:home-twotone" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><iconify-icon class="vp-icon" icon="ic:twotone-book" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/note-book/" aria-label="note-book"><!---->note-book<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">AI Training</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Anaconda</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Android</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ansible</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Baidu Net Disk</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Btrfs</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Core DNS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">CVE</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">DNS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ebook</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ELK</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Esxi</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Etcd</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Fossology</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Frp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Git</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Gitlab</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Goaccess</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">GRUB</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">HA LVS Keepalived</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Harbor</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Iptables</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jenkins</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jumper Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Kafka</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/note-book/Kafka/ELK%E5%92%8Ckafka%E6%9E%84%E5%BB%BA%E9%AB%98%E5%B9%B6%E5%8F%91%E5%88%86%E5%B8%83%E5%BC%8F%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F.html" aria-label="ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ"><!---->ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kubernetes</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux From Scratch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linux Opera System</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Linuxä¸‰å‰‘å®¢</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Midjourney</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Min IO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Misc</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">My SQL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx Open Resty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nodejs</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ollama</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Open Stack</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Opera Systems</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Photo Shop</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Physical Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Portainer</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Prometheus</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rabbit MQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rancher</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Research Develop</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Router OS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Security</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Ssh</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SSL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Tomcat</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Traefik</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Vim</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Virtual Private Network</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">VMware</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Vue</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Windows</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">WSL</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Zabbix</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">äº¤æ¢æœº</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¸åœˆçš„é‚£äº›äº‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">æœåŠ¡å™¨</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">æ´‹åƒåœ¾ä¸»æœº</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ç”Ÿæ´»</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="ic:twotone-book" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/" aria-label="PyQt5å¿«é€Ÿä¸Šæ‰‹-ç‹é“­ä¸œ"><!---->PyQt5å¿«é€Ÿä¸Šæ‰‹-ç‹é“­ä¸œ<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="ic:twotone-book" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/ostep-note/" aria-label="Operating Systems: Three Easy Pieces å­¦ä¹ ç¬”è®°"><!---->Operating Systems: Three Easy Pieces å­¦ä¹ ç¬”è®°<!----></a><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Paper-Dragon" target="_blank" rel="noopener noreferrer">Paper-Dragon</a></span><span property="author" content="Paper-Dragon"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023/8/13</span><meta property="datePublished" content="2023-08-13T15:08:38.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon" name="eye"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/note-book/Kafka/ELK%E5%92%8Ckafka%E6%9E%84%E5%BB%BA%E9%AB%98%E5%B9%B6%E5%8F%91%E5%88%86%E5%B8%83%E5%BC%8F%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F.html" data-page-key="/note-book/Kafka/ELK%E5%92%8Ckafka%E6%9E%84%E5%BB%BA%E9%AB%98%E5%B9%B6%E5%8F%91%E5%88%86%E5%B8%83%E5%BC%8F%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E7%B3%BB%E7%BB%9F.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 15 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT15M"></span><!----><!----></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="elkå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#elkå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ"><span>ELKå’Œkafkaæ„å»ºé«˜å¹¶å‘åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿ</span></a></h1><h1 id="elk-kafkaé›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#elk-kafkaé›†ç¾¤"><span>ELK+Kafkaé›†ç¾¤</span></a></h1><h2 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€"><span>å‰è¨€</span></a></h2><h3 id="å‰è¨€-1" tabindex="-1"><a class="header-anchor" href="#å‰è¨€-1"><span>å‰è¨€</span></a></h3><p>ä¸šåŠ¡å±‚å¯ä»¥ç›´æ¥å†™å…¥åˆ°kafkaé˜Ÿåˆ—ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒelasticsearchçš„å†™å…¥æ•ˆç‡é—®é¢˜ã€‚ å›¾ç¤º</p><p><img src="/assets/%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84-Cja0Tjk6.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="kafka" tabindex="-1"><a class="header-anchor" href="#kafka"><span>Kafka</span></a></h1><p>Apache kafkaæ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸€ç§ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„ï¼ŒåŸºäºå‘å¸ƒ/è®¢é˜…çš„æ¶ˆæ¯ç³»ç»Ÿã€‚èƒ½å®ç°ä¸€ä¸ªä¸ºå¤„ç†å®æ—¶æ•°æ®æä¾›ä¸€ä¸ªç»Ÿä¸€ã€é«˜ååã€ä½å»¶è¿Ÿçš„å¹³å°ï¼Œä¸”æ‹¥æœ‰åˆ†å¸ƒå¼çš„ï¼Œå¯åˆ’åˆ†çš„ï¼Œå†—ä½™å¤‡ä»½çš„æŒä¹…æ€§çš„æ—¥å¿—æœåŠ¡ç­‰ç‰¹ç‚¹ã€‚</p><h2 id="æœ¯è¯­" tabindex="-1"><a class="header-anchor" href="#æœ¯è¯­"><span>æœ¯è¯­</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>1ã€kafkaæ˜¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ã€‚kafkaæœåŠ¡ç§°ä¸ºbrokerï¼ˆä¸­é—´äººï¼‰, æ¶ˆæ¯å‘é€è€…ç§°ä¸ºproducerï¼ˆç”Ÿäº§è€…ï¼‰, æ¶ˆæ¯æ¥æ”¶è€…ç§°ä¸ºconsumerï¼ˆæ¶ˆè´¹è€…ï¼‰;é€šå¸¸æˆ‘ä»¬éƒ¨ç½²å¤šä¸ªbrokerä»¥æä¾›é«˜å¯ç”¨æ€§çš„æ¶ˆæ¯æœåŠ¡é›†ç¾¤.å…¸å‹çš„æ˜¯3ä¸ªbroker;æ¶ˆæ¯ä»¥topicçš„å½¢å¼å‘é€åˆ°broker,æ¶ˆè´¹è€…è®¢é˜…topic,å®ç°æŒ‰éœ€å–ç”¨çš„æ¶ˆè´¹æ¨¡å¼;åˆ›å»ºtopicéœ€è¦æŒ‡å®šreplication-factor(å¤åˆ¶æ•°ç›®, é€šå¸¸=brokeræ•°ç›®);æ¯ä¸ªtopicå¯èƒ½æœ‰å¤šä¸ªåˆ†åŒº(partition), æ¯ä¸ªåˆ†åŒºçš„æ¶ˆæ¯å†…å®¹ä¸ä¼šé‡å¤</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2ã€kafka-broker-ä¸­é—´äºº</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3ã€webserver/logstash-producer[prÉ™Ëˆdu:sÉ™Â®]-æ¶ˆæ¯ç”Ÿäº§è€…/æ¶ˆæ¯å‘é€è€…</span></span>
<span class="line"><span>Producerï¼š</span></span>
<span class="line"><span>kafkaé›†ç¾¤ä¸­çš„ä»»ä½•ä¸€ä¸ªbrokeréƒ½å¯ä»¥å‘produceræä¾›metadataä¿¡æ¯,è¿™äº›metadataä¸­åŒ…å«&quot;é›†ç¾¤ä¸­å­˜æ´»çš„serversåˆ—è¡¨&quot;/â€œpartitions leaderåˆ—è¡¨&quot;ç­‰ä¿¡æ¯ï¼›</span></span>
<span class="line"><span>å½“producerè·å–åˆ°metadataä¿¡æ¯ä¹‹å, producerå°†ä¼šå’ŒTopicä¸‹æ‰€æœ‰partition leaderä¿æŒsocketè¿æ¥ï¼›</span></span>
<span class="line"><span>æ¶ˆæ¯ç”±producerç›´æ¥é€šè¿‡socketå‘é€åˆ°brokerï¼Œä¸­é—´ä¸ä¼šç»è¿‡ä»»ä½•&quot;è·¯ç”±å±‚â€ï¼Œäº‹å®ä¸Šï¼Œæ¶ˆæ¯è¢«è·¯ç”±åˆ°å“ªä¸ªpartitionä¸Šç”±producerå®¢æˆ·ç«¯å†³å®šï¼›æ¯”å¦‚å¯ä»¥é‡‡ç”¨&quot;random&quot;â€œkey-hashâ€&quot;è½®è¯¢&quot;ç­‰,å¦‚æœä¸€ä¸ªtopicä¸­æœ‰å¤šä¸ªpartitions,é‚£ä¹ˆåœ¨producerç«¯å®ç°&quot;æ¶ˆæ¯å‡è¡¡åˆ†å‘&quot;æ˜¯å¿…è¦çš„ã€‚</span></span>
<span class="line"><span>åœ¨producerç«¯çš„é…ç½®æ–‡ä»¶ä¸­,å¼€å‘è€…å¯ä»¥æŒ‡å®špartitionè·¯ç”±çš„æ–¹å¼ã€‚</span></span>
<span class="line"><span>Produceræ¶ˆæ¯å‘é€çš„åº”ç­”æœºåˆ¶è®¾ç½®å‘é€æ•°æ®æ˜¯å¦éœ€è¦æœåŠ¡ç«¯çš„åé¦ˆ,æœ‰ä¸‰ä¸ªå€¼0,1,-1</span></span>
<span class="line"><span>0:producerä¸ä¼šç­‰å¾…brokerå‘é€ack</span></span>
<span class="line"><span>1:å½“leaderæ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åå‘é€ack</span></span>
<span class="line"><span>-1:å½“æ‰€æœ‰çš„followeréƒ½åŒæ­¥æ¶ˆæ¯æˆåŠŸåå‘é€ack</span></span>
<span class="line"><span></span></span>
<span class="line"><span>4ã€elasticsearch-consumer-æ¶ˆè´¹è€…</span></span>
<span class="line"><span></span></span>
<span class="line"><span>5ã€logs-topic-è¯é¢˜</span></span>
<span class="line"><span></span></span>
<span class="line"><span>6ã€replication-facter-å¤åˆ¶æ•°ç›®-ä¸­é—´äººå­˜å‚¨æ¶ˆæ¯çš„å‰¯æœ¬æ•°=brokeræ•°ç›®</span></span>
<span class="line"><span></span></span>
<span class="line"><span>7ã€ä¸€ä¸ªtopicæœ‰å¤šä¸ªåˆ†åŒºpartition</span></span>
<span class="line"><span>partitionï¼š</span></span>
<span class="line"><span>ï¼ˆ1ï¼‰ã€Partitionï¼šä¸ºäº†å®ç°æ‰©å±•æ€§ï¼Œä¸€ä¸ªéå¸¸å¤§çš„topicå¯ä»¥åˆ†å¸ƒåˆ°å¤šä¸ªbrokerï¼ˆå³æœåŠ¡å™¨ï¼‰ä¸Šï¼Œä¸€ä¸ªtopicå¯ä»¥åˆ†ä¸ºå¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionæ˜¯ä¸€ä¸ªæœ‰åºçš„é˜Ÿåˆ—ã€‚partitionä¸­çš„æ¯æ¡æ¶ˆæ¯éƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ªæœ‰åºçš„idï¼ˆoffsetï¼‰ã€‚kafkaåªä¿è¯æŒ‰ä¸€ä¸ªpartitionä¸­çš„é¡ºåºå°†æ¶ˆæ¯å‘ç»™consumerï¼Œä¸ä¿è¯ä¸€ä¸ªtopicçš„æ•´ä½“ï¼ˆå¤šä¸ªpartitioné—´ï¼‰çš„é¡ºåºã€‚</span></span>
<span class="line"><span>ï¼ˆ2ï¼‰ã€åœ¨kafkaä¸­,ä¸€ä¸ªpartitionä¸­çš„æ¶ˆæ¯åªä¼šè¢«groupä¸­çš„ä¸€ä¸ªconsumeræ¶ˆè´¹(åŒä¸€æ—¶åˆ»)ï¼›ä¸€ä¸ªTopicä¸­çš„æ¯ä¸ªpartionsï¼Œåªä¼šè¢«ä¸€ä¸ªconsumeræ¶ˆè´¹ï¼Œä¸è¿‡ä¸€ä¸ªconsumerå¯ä»¥åŒæ—¶æ¶ˆè´¹å¤šä¸ªpartitionsä¸­çš„æ¶ˆæ¯ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®æˆ˜" tabindex="-1"><a class="header-anchor" href="#å®æˆ˜"><span>å®æˆ˜</span></a></h2><h3 id="æ‹“æ‰‘" tabindex="-1"><a class="header-anchor" href="#æ‹“æ‰‘"><span>æ‹“æ‰‘</span></a></h3><p><img src="/assets/%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84-Cja0Tjk6.png" alt="åŸºæœ¬æ¶æ„"></p><h3 id="è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#è¯´æ˜"><span>è¯´æ˜</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">è¯´æ˜</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1ã€ä½¿ç”¨ä¸€å°Nginxä»£ç†è®¿é—®kibanaçš„è¯·æ±‚</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2ã€ä¸¤å°esç»„æˆesé›†ç¾¤ï¼Œå¹¶ä¸”åœ¨ä¸¤å°esä¸Šé¢éƒ½å®‰è£…kibana</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ï¼ˆ</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ä»¥ä¸‹å¯¹elasticsearchç®€ç§°es</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3ã€ä¸­é—´ä¸‰å°æœåŠ¡å™¨å°±æ˜¯æˆ‘çš„kafka(zookeeper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)é›†ç¾¤å•¦; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ä¸Šé¢å†™çš„</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> æ¶ˆè´¹è€…/ç”Ÿäº§è€…</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> è¿™æ˜¯kafka</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zookeeper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ä¸­çš„æ¦‚å¿µ</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4ã€æœ€åé¢çš„å°±æ˜¯ä¸€å¤§å †çš„ç”Ÿäº§æœåŠ¡å™¨å•¦ï¼Œä¸Šé¢ä½¿ç”¨çš„æ˜¯logstashï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">å½“ç„¶é™¤äº†logstashä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å·¥å…·æ¥æ”¶é›†ä½ çš„åº”ç”¨ç¨‹åºçš„æ—¥å¿—ï¼Œä¾‹å¦‚ï¼šFlumeï¼ŒScribeï¼ŒRsyslogï¼ŒScriptsâ€¦â€¦</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§’è‰²" tabindex="-1"><a class="header-anchor" href="#è§’è‰²"><span>è§’è‰²</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1ã€nginx-proxy(ç•¥</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)ï¼š172.16.100.25</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2ã€es1ï¼š172.16.100.21</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3ã€es2ï¼š172.16.100.24</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4ã€kafka1ï¼š172.16.100.26</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5ã€kafka2ï¼š172.16.100.27</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6ã€kafka3ï¼š172.16.100.32</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">7ã€webserverï¼š172.16.100.33</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è½¯ä»¶è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#è½¯ä»¶è¯´æ˜"><span>è½¯ä»¶è¯´æ˜</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1ã€elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1.7.3.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2ã€Logstash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2.0.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3ã€kibana</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4.1.2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ç•¥</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ä»¥ä¸Šè½¯ä»¶éƒ½å¯ä»¥ä»å®˜ç½‘ä¸‹è½½</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> //www.elastic.co/downloads</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4ã€java</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.8.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ï¼Œ</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> é‡‡ç”¨</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> å®‰è£…</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤"><span>æ­¥éª¤</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1ã€ESé›†ç¾¤å®‰è£…é…ç½®</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2ã€Logstashå®¢æˆ·ç«¯é…ç½®(ç›´æ¥å†™å…¥æ•°æ®åˆ°ESé›†ç¾¤ï¼Œå†™å…¥ç³»ç»Ÿmessagesæ—¥å¿—</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3ã€Kafka(zookeeper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)é›†ç¾¤é…ç½®;(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logstashå†™å…¥æ•°æ®åˆ°Kafkaæ¶ˆæ¯ç³»ç»Ÿ</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4ã€Kibanaéƒ¨ç½²</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5ã€Nginxè´Ÿè½½å‡è¡¡Kibanaè¯·æ±‚</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¼”ç¤º" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º"><span>æ¼”ç¤º</span></a></h3><h4 id="_1ã€esé›†ç¾¤å®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€esé›†ç¾¤å®‰è£…é…ç½®"><span>1ã€ESé›†ç¾¤å®‰è£…é…ç½®</span></a></h4><p>es1ï¼š ï¼ˆ1ï¼‰ã€å®‰è£…java-1.8.0ä»¥åŠä¾èµ–åŒ…ï¼ˆæ¯å°æœåŠ¡å™¨éƒ½å®‰è£…JAVAï¼‰</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum -y install epel-release</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum -y install java-1.8.0 git wget lrzsz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ç¼“å­˜è¿™ä¸ªjavaçš„åŒ…</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å¯ä»¥ä½¿ç”¨åªä¸‹è½½ä¸å®‰è£…ï¼Œç¼“å­˜è¿™äº›åŒ…</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum -y install java-1.8.0 git wget lrzsz --downloadonly --downloaddir=./</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼š --downloadonly åªä¸‹è½½ä¸å®‰è£…  downloaddir  ç›®å½•</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ2ï¼‰ã€è·å–esè½¯ä»¶åŒ…</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># wget https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.3.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># tar -xf elasticsearch-1.7.3.tar.gz -C /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ln -sv /usr/local/elasticsearch-1.7.3/ /usr/local/elasticsearch</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰ã€ä¿®æ”¹é…ç½®æ–‡ä»¶</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/elasticsearch/config/elasticsearch.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cluster.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> es-cluster</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         #ç»„æ’­çš„åç§°åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">node.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;es-node1&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            #èŠ‚ç‚¹åç§°ï¼Œä¸èƒ½å’Œå…¶ä»–èŠ‚ç‚¹é‡å¤</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">node.master:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                #èŠ‚ç‚¹èƒ½å¦è¢«é€‰ä¸¾ä¸ºmaster</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">node.data:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  #èŠ‚ç‚¹æ˜¯å¦å­˜å‚¨æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index.number_of_shards:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        #ç´¢å¼•åˆ†ç‰‡çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index.number_of_replicas:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    #åˆ†ç‰‡çš„å‰¯æœ¬ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.conf:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/elasticsearch/config</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       #é…ç½®æ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.data:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/es/data</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         #æ•°æ®ç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.work:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/es/worker</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       #å·¥ä½œç›®å½•è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.logs:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/elasticsearch/logs</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         #æ—¥å¿—æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path.plugins:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/es/plugins</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   #æ’ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bootstrap.mlockall:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             #å†…å­˜ä¸å‘swapäº¤æ¢</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http.enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               #å¯ç”¨http</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ4ï¼‰ã€åˆ›å»ºç›¸å…³ç›®å½•</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mkdir -p /data/es/{data,worker,plugins}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šdataï¼šæ”¾æ•°æ®çš„æ–‡ä»¶ workerï¼šå·¥ä½œä¸´æ—¶æ–‡ä»¶ pluginsï¼šæ’ä»¶ æ—¥å¿—æ–‡ä»¶ä¼šè‡ªå·±å»ºç«‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ5ï¼‰ã€è·å–esæœåŠ¡ç®¡ç†è„šæœ¬</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä¸ºäº†æ–¹ä¾¿é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># git clone https://github.com/elastic/elasticsearch-servicewrapper.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mv elasticsearch-servicewrapper/service/ /usr/local/elasticsearch/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#åœ¨/etc/init.d/ç›®å½•ä¸‹ï¼Œè‡ªåŠ¨å®‰è£…ä¸Šesçš„ç®¡ç†è„šæœ¬å•¦</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/elasticsearch/bin/service/elasticsearch install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ6ï¼‰ã€å¯åŠ¨esï¼Œå¹¶æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># systemctl start elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># systemctl enable elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ss -nptl |grep -E &quot;9200|9300&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">LISTEN</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      50</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          :::9200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   users:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;java&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=10020,fd=104</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">LISTEN</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      50</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          :::9300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   users:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;java&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=10020,fd=66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¿é—®192.168.88.153:9200</p><p><img src="/assets/web-api-DBxie1Ur.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ï¼ˆ3ï¼‰ã€å®‰è£…esçš„ç®¡ç†æ’ä»¶ ï¼ˆ1ï¼‰ã€è¯´æ˜ï¼šeså®˜æ–¹æä¾›ä¸€ä¸ªç”¨äºç®¡ç†esçš„æ’ä»¶ï¼Œå¯æ¸…æ™°ç›´è§‚çœ‹åˆ°esé›†ç¾¤çš„çŠ¶æ€ï¼Œä»¥åŠå¯¹é›†ç¾¤çš„æ“ä½œç®¡ç†ï¼Œå®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š ï¼ˆ2ï¼‰ã€æç¤ºï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/elasticsearch/bin/plugin -i mobz/elasticsearch-head</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å¥½ä¹‹åï¼Œè®¿é—®æ–¹å¼ä¸ºï¼š <a href="http://192.168.0.110:9200/_plugin/head%EF%BC%8C" target="_blank" rel="noopener noreferrer">http://192.168.0.110:9200/_plugin/headï¼Œ</a> ç”±äºé›†ç¾¤ä¸­ç°åœ¨æš‚æ—¶æ²¡æœ‰æ•°æ®ï¼Œæ‰€ä»¥æ˜¾ç¤ºä¸ºç©º, <img src="/assets/web-B_yYqqVI.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="_2ã€logstashå®¢æˆ·ç«¯å®‰è£…é…ç½®-åœ¨webserver1ä¸Šå®‰è£…logstassh-ç”¨äºé‡‡é›†æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#_2ã€logstashå®¢æˆ·ç«¯å®‰è£…é…ç½®-åœ¨webserver1ä¸Šå®‰è£…logstassh-ç”¨äºé‡‡é›†æ—¥å¿—"><span>2ã€Logstashå®¢æˆ·ç«¯å®‰è£…é…ç½®ï¼ˆåœ¨webserver1ä¸Šå®‰è£…logstasshï¼Œç”¨äºé‡‡é›†æ—¥å¿—ï¼‰</span></a></h4><p>ï¼ˆ1ï¼‰ã€downloads è½¯ä»¶åŒ…</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum -y install java-1.8.0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># wget https://download.elastic.co/logstash/logstash/logstash-2.0.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># tar -xf logstash-2.0.0.tar.gz -C /usr/local</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># cd /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ln -sv logstash-2.0.0 logstash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mkdir /usr/local/logstash/{logs,etc}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ2ï¼‰ã€Logstash å‘esé›†ç¾¤å†™æ•°æ® ç¼–å†™é…ç½®æ–‡ä»¶;</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/logstash/etc/logstash.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">input</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                #æ•°æ®çš„è¾“å…¥ä»æ ‡å‡†è¾“å…¥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stdin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              #æ•°æ®çš„è¾“å‡ºæˆ‘ä»¬æŒ‡å‘äº†esé›†ç¾¤</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hosts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.168.0.110:9200&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;192.168.0.111:9200&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ]</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #es ä¸»æœºçš„ ip åŠç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash.conf --configtest --verbose</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">è¾“å‡ºæç¤ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Configuration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  è¯­æ³•æ­£ç¡®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰ã€å¯åŠ¨logstash å¯åŠ¨;</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3ã€kafkaé›†ç¾¤å®‰è£…é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3ã€kafkaé›†ç¾¤å®‰è£…é…ç½®"><span>3ã€Kafkaé›†ç¾¤å®‰è£…é…ç½®</span></a></h4><p>ï¼ˆ1ï¼‰ã€æç¤ºï¼šåœ¨æ­å»ºkafkaé›†ç¾¤æ—¶ï¼Œéœ€è¦æå‰å®‰è£…zookeeperé›†ç¾¤ï¼Œå½“ç„¶kafkaå·²ç»è‡ªå¸¦zookeeperç¨‹åºåªéœ€è¦è§£å‹å¹¶ä¸”å®‰è£…é…ç½®å°±è¡Œäº† ï¼ˆ2ï¼‰ã€Kafka1 è·å–è½¯ä»¶åŒ…ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">å®˜ç½‘ï¼š</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://kafka.apache.org</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum install -y java-1.8.0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># wget http://mirror.rise.ph/apache/kafka/0.8.2.1/kafka_2.11-0.8.2.1.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http://mirror.rise.ph/apache/kafka/2.6.2/kafka_2.12-2.6.2.tgz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># tar -xf kafka_2.12-2.6.2.tgz -C /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># cd /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ln -sv kafka_2.12-2.6.2 kafka</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®zookeeperé›†ç¾¤ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/kafka/config/zookeeper.properties</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dataDir</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/data/zookeeper</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">clientPort</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2181</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tickTime</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2000</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼štickTime : è¿™ä¸ªæ—¶é—´æ˜¯ä½œä¸º Zookeeper æœåŠ¡å™¨ä¹‹é—´æˆ–å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª tickTime æ—¶é—´å°±ä¼šå‘é€ä¸€ä¸ªå¿ƒè·³ã€‚</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">initLimit</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">20</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šinitLimitï¼šLFåˆå§‹é€šä¿¡æ—¶é™</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#é›†ç¾¤ä¸­çš„followeræœåŠ¡å™¨(F)ä¸leaderæœåŠ¡å™¨(L)ä¹‹é—´ åˆå§‹è¿æ¥ æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ­¤é…ç½®è¡¨ç¤ºï¼Œå…è®¸ follower ï¼ˆç›¸å¯¹äº leader è€Œè¨€çš„â€œå®¢æˆ·ç«¯â€ï¼‰è¿æ¥ å¹¶åŒæ­¥åˆ°  leader çš„åˆå§‹åŒ–è¿æ¥æ—¶é—´ï¼Œå®ƒä»¥ tickTime çš„å€æ•°æ¥è¡¨ç¤ºã€‚å½“è¶…è¿‡è®¾ç½®å€æ•°çš„ tickTime æ—¶é—´ï¼Œåˆ™è¿æ¥å¤±è´¥</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">syncLimit</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">10</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šsyncLimitï¼šLFåŒæ­¥é€šä¿¡æ—¶é™</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#é›†ç¾¤ä¸­çš„followeræœåŠ¡å™¨(F)ä¸leaderæœåŠ¡å™¨(L)ä¹‹é—´ è¯·æ±‚å’Œåº”ç­” ä¹‹é—´èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ­¤é…ç½®è¡¨ç¤ºï¼Œ leader ä¸ follower ä¹‹é—´å‘é€æ¶ˆæ¯ï¼Œè¯·æ±‚ å’Œ åº”ç­” æ—¶é—´é•¿åº¦ã€‚å¦‚æœ follower åœ¨è®¾ç½®çš„æ—¶é—´å†…ä¸èƒ½ä¸leader è¿›è¡Œé€šä¿¡ï¼Œé‚£ä¹ˆæ­¤ follower å°†è¢«ä¸¢å¼ƒã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server.2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.0.112:2888:3888</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#2888 ç«¯å£ï¼šè¡¨ç¤ºçš„æ˜¯è¿™ä¸ªæœåŠ¡å™¨ä¸é›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ï¼›</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#3888 ç«¯å£ï¼šè¡¨ç¤ºçš„æ˜¯ä¸‡ä¸€é›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨æŒ‚äº†ï¼Œéœ€è¦ä¸€ä¸ªç«¯å£æ¥é‡æ–°è¿›è¡Œé€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„ Leader ï¼Œè€Œè¿™ä¸ªç«¯å£å°±æ˜¯ç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server.3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.0.113:2888:3888</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server.4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.0.115:2888:3888</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxClientCnxns</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Š:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#maxClientCnxnsé€‰é¡¹ï¼Œå¦‚æœä¸è®¾ç½®æˆ–è€…è®¾ç½®ä¸º0ï¼Œåˆ™æ¯ä¸ªipè¿æ¥zookeeperæ—¶çš„è¿æ¥æ•°æ²¡æœ‰é™åˆ¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºzookeeperæ‰€éœ€è¦çš„ç›®å½•ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mkdir /data/zookeeper</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åˆ›å»ºmyidæ–‡ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#åœ¨/data/zookeeperç›®å½•ä¸‹åˆ›å»ºmyidæ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹ä¸ºæ•°å­—ï¼Œç”¨äºæ ‡è¯†ä¸»æœºï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶æ²¡æœ‰çš„è¯ï¼Œzookeeperæ˜¯æ²¡æ³•å¯åŠ¨çš„</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># echo 2 &gt; /data/zookeeper/myid</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å¦å¤–ä¸¤å°ï¼Œåˆ†åˆ«æ˜¯3,4ã€‚ä»¥ä¸Šå°±æ˜¯zookeeperé›†ç¾¤çš„é…ç½®ï¼Œä¸‹é¢ç­‰æˆ‘é…ç½®å¥½kafkaä¹‹åç›´æ¥å¤åˆ¶åˆ°å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹å³å¯</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Kafkaé…ç½®ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/kafka/config/server.properties</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">broker.id</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šå”¯ä¸€ï¼Œå¡«æ•°å­—ï¼Œæœ¬æ–‡ä¸­åˆ†åˆ«ä¸º 2 / 3 / 4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">prot</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">9092</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šè¿™ä¸ª broker ç›‘å¬çš„ç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">host.name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.0.112</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šå”¯ä¸€ï¼Œå¡«æœåŠ¡å™¨ IP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log.dir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=/data/kafka-logs</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šè¯¥ç›®å½•å¯ä»¥ä¸ç”¨æå‰åˆ›å»ºï¼Œåœ¨å¯åŠ¨æ—¶è‡ªå·±ä¼šåˆ›å»º</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zookeeper.connect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.0.112:2181,192.168.0.113:2181,192.168.0.115:2181</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šè¿™ä¸ªå°±æ˜¯ zookeeper çš„ ip åŠç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">num.partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=16</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šéœ€è¦é…ç½®è¾ƒå¤§ åˆ†ç‰‡å½±å“è¯»å†™é€Ÿåº¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log.dirs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=/data/kafka-logs</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šæ•°æ®ç›®å½•ä¹Ÿè¦å•ç‹¬é…ç½®ç£ç›˜è¾ƒå¤§çš„åœ°æ–¹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log.retention.hours</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=168</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼šæ—¶é—´æŒ‰éœ€æ±‚ä¿ç•™è¿‡æœŸæ—¶é—´ é¿å…ç£ç›˜æ»¡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ—¥å¿—ä¿å­˜çš„æ—¶é—´ï¼Œå¯ä»¥é€‰æ‹©hours,minuteså’Œms  168(7day)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰ã€Kafka3&amp;Kafka3 å°†Kafkaï¼ˆzookeeperï¼‰çš„ç¨‹åºç›®å½•å…¨éƒ¨æ‹·è´åˆ°å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># scp -r /usr/local/kafka 192.168.0.113:/usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># scp -r /usr/local/kafka 192.168.0.115:/usr/local/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹ä¸¤ä¸ªèŠ‚ç‚¹é…ç½®ï¼ˆè¿™é‡ŒåŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯æ³¨æ„ä¸åŒä½ç½®ï¼‰ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ï¼ˆ</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ï¼‰</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zookeeper</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> çš„é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#kafka2å’Œkafka3</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mkdir /data/zookeeper -p</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># echo &quot;x&quot; &gt;    /data/zookeeper/myid   #xä¸º3æˆ–4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ï¼ˆ</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ï¼‰</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kafka</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> çš„é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#kafka2å’Œkafka3</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/kafka/config/server.properties</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">broker.id</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=x</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       #xä¸º3æˆ–4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">host.name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=192.168.x.xx</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #xä¸ºKafka2å’ŒKafka3çš„ip</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ï¼Œå…ˆå¯åŠ¨zookeeperé›†ç¾¤ï¼Œæ‰èƒ½å¯åŠ¨Kafka</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">8.å¯åŠ¨ï¼Œå…ˆå¯åŠ¨zookeeperé›†ç¾¤ï¼Œæ‰èƒ½å¯åŠ¨kafka</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æç¤ºï¼šæŒ‰ç…§é¡ºåºæ¥ï¼Œkafka1 â€“&gt; kafka2 â€“&gt;kafka3</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#zookeeperå¯åŠ¨å‘½ä»¤ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/kafka/bin/zookeeper-server-start.sh /usr/local/kafka/config/zookeeper.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/kafka/bin/zookeeper-server-start.sh /usr/local/kafka/config/zookeeper.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/kafka/bin/zookeeper-server-start.sh /usr/local/kafka/config/zookeeper.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼š/usr/local/kafka/bin/zookeeper-server-stop.sh  #zookeeperåœæ­¢çš„å‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å¦‚æœzookeeperæœ‰é—®é¢˜ nohupçš„æ—¥å¿—æ–‡ä»¶ä¼šéå¸¸å¤§ï¼ŒæŠŠç£ç›˜å æ»¡ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¿™ä¸ªzookeeperæœåŠ¡å¯ä»¥é€šè¿‡è‡ªå·±äº›æœåŠ¡è„šæœ¬æ¥ç®¡ç†æœåŠ¡çš„å¯åŠ¨ä¸å…³é—­ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#åé¢ä¸¤å°æ‰§è¡Œç›¸åŒæ“ä½œï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹å½“ä¸­ä¼šå‡ºç°ä»¥ä¸‹æŠ¥é”™ä¿¡æ¯ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#WARN Cannot open channel to 3 at election address / 192.168.0.113 : 3888</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ç”±äºzookeeperé›†ç¾¤åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œæ¯ä¸ªç»“ç‚¹éƒ½è¯•å›¾å»è¿æ¥é›†ç¾¤ä¸­çš„å…¶å®ƒç»“ç‚¹ï¼Œå…ˆå¯åŠ¨çš„è‚¯å®šè¿ä¸ä¸Šåé¢è¿˜æ²¡å¯åŠ¨çš„ï¼Œæ‰€ä»¥ä¸Šé¢æ—¥å¿—å‰é¢éƒ¨åˆ†çš„å¼‚å¸¸æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚é€šè¿‡åé¢éƒ¨åˆ†å¯ä»¥çœ‹åˆ°ï¼Œé›†ç¾¤åœ¨é€‰å‡ºä¸€ä¸ªLeaderåï¼Œæœ€åç¨³å®šäº†ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å…¶ä»–èŠ‚ç‚¹ä¹Ÿå¯èƒ½ä¼šå‡ºç°ç±»ä¼¼çš„æƒ…å†µï¼Œå±äºæ­£å¸¸ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>zookeeperæœåŠ¡æ£€æŸ¥ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># netstat -nlpt | grep -E &quot;2181|2888|3888&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¾“å‡ºæç¤ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.0.112:3888</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1722/java</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :::2181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1722/java</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># netstat -nlpt | grep -E &quot;2181|2888|3888&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¾“å‡ºæç¤º</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.0.113:3888</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1713/java</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :::2181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1713/java</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.0.113:2888</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1713/java</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å¦‚æœå“ªå°æ˜¯Leader,é‚£ä¹ˆå®ƒå°±æ‹¥æœ‰2888è¿™ä¸ªç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># netstat -nlpt | grep -E &quot;2181|2888|3888&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¾“å‡ºæç¤º</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.0.115:3888</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1271/java</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :::2181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1271/java</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éªŒè¯ã€å¯åŠ¨Kafkaï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#å¯åŠ¨ï¼ˆåœ¨ä¸‰å°KafkaæœåŠ¡å™¨ä¸Šï¼‰ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># nohup /usr/local/kafka/bin/kafka-server-start.sh /usr/local/kafka/config/server.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># nohup /usr/local/kafka/bin/kafka-server-start.sh /usr/local/kafka/config/server.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># nohup /usr/local/kafka/bin/kafka-server-start.sh /usr/local/kafka/config/server.properties &amp;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æ³¨é‡Šï¼š/usr/local/kafka/bin/kafka-server-stop.sh   #kafkaåœæ­¢çš„å‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è·ŸzookeeperæœåŠ¡ä¸€æ ·ï¼Œå¦‚æœkafkaæœ‰é—®é¢˜ nohupçš„æ—¥å¿—æ–‡ä»¶ä¼šéå¸¸å¤§,æŠŠç£ç›˜å æ»¡ï¼Œè¿™ä¸ªkafkaæœåŠ¡åŒæ ·å¯ä»¥é€šè¿‡è‡ªå·±äº›æœåŠ¡è„šæœ¬æ¥ç®¡ç†æœåŠ¡çš„å¯åŠ¨ä¸å…³é—­ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#æµ‹è¯•ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä¸‹é¢æˆ‘ä»¬å°†webserver1ä¸Šé¢çš„logstashçš„è¾“å‡ºæ”¹åˆ°kafkaä¸Šé¢</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ä¿®æ”¹webserver1ä¸Šé¢çš„logstashé…ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  vim /usr/local/logstash/etc/logstash3.conf </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">input</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;system-message&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/var/log/messages&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">start_position</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;beginning&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kafka</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bootstrap_servers</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;192.168.0.112:9092,192.168.0.113:9092,192.168.0.115:9092&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">topic_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;system-messages&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #è¿™ä¸ªå°†ä½œä¸ºä¸»é¢˜çš„åç§°ï¼Œå°†ä¼šè‡ªåŠ¨åˆ›å»º</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compression_type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;snappy&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #å‹ç¼©ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">é…ç½®æ£€æµ‹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash3.conf  --configtest --verbose</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¾“å‡ºæç¤ºï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Configuration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OK</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">å¯åŠ¨Logstash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash3.conf </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">éªŒè¯æ•°æ®æ˜¯å¦å†™å…¥åˆ°kafkaï¼Œæ£€æŸ¥æ˜¯å¦ç”Ÿæˆä¸€ä¸ªsystem-messagesçš„ä¸»é¢˜</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  /usr/local/kafka/bin/kafka-topics.sh --list --zookeeper 172.16.100.26:2181</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è¾“å‡ºä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">summer</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> messages</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¸»é¢˜å·²ç»ç”Ÿæˆäº†</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">æŸ¥çœ‹system-messagesä¸»é¢˜çš„è¯¦æƒ…</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/kafka/bin/kafka-topics.sh --describe --zookeeper 172.16.100.26:2181 --topic system-message</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºä¿¡æ¯ï¼š</p><p><img src="/assets/queue-Bn7vAWLx.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªä¸»é¢˜ç”Ÿæˆäº†16ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰å¯¹åº”è‡ªå·±çš„Leader</p><p>æ‰©å±•æç¤ºï¼š æˆ‘æƒ³è¦æœ‰10ä¸ªåˆ†åŒºï¼Œ3ä¸ªå‰¯æœ¬å¦‚ä½•åŠï¼Ÿè¿˜æ˜¯è·Ÿæˆ‘ä»¬ä¸Šé¢ä¸€æ ·å‘½ä»¤è¡Œæ¥åˆ›å»ºä¸»é¢˜å°±è¡Œï¼Œ å½“ç„¶å¯¹äºlogstashè¾“å‡ºçš„æˆ‘ä»¬ä¹Ÿå¯ä»¥æå‰å…ˆå®šä¹‰ä¸»é¢˜ï¼Œç„¶åå¯åŠ¨logstash ç›´æ¥å¾€å®šä¹‰å¥½çš„ä¸»é¢˜å†™æ•°æ®å°±è¡Œå•¦ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/kafka/bin/kafka-topics.sh --create --zookeeper 192.168.2.22:2181 --replication-factor 3 --partitions 10 --topic TOPIC_NAME</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Kafkaé›†ç¾¤éƒ¨ç½²logstashï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1ã€kafka</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3å®‰è£…logstash:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># wget https://download.elastic.co/logstash/logstash/logstash-2.0.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># tar -xf logstash-2.0.0.tar.gz -C /usr/local</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># cd /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ln -sv logstash-2.0.0 logstash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mkdir /usr/local/logstash/{logs,etc}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2ã€ä¸‰å°kafakç¼–å†™logstashé…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /usr/local/logstash/etc/logstash.conf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#2181åé¢ä¸èƒ½æœ‰ç©ºæ ¼</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#decorate_events =&gt; trueï¼šæ­¤å±æ€§ä¼šå°†å½“å‰topicã€offsetã€groupã€partitionç­‰ä¿¡æ¯ä¹Ÿå¸¦åˆ°messageä¸­  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">input</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">kafka</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zk_connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;172.16.100.26:2181,172.16.100.27:2181,172.16.100.32:2181&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #æ¶ˆè´¹è€…ä»¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">topic_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;system-message&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">codec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">plain</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">reset_beginning</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">consumer_threads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">decorate_events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hosts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;172.16.100.21:9200&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;172.16.100.24:9200&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;test-system-messages-%{+YYYY-MM}&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #åŒºåˆ†ä¹‹å‰å®éªŒï¼Œæ–°åå­—â€œtest-system-messages-%{+YYYY-MM}â€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3ã€webserver1ä¸Šå†™å…¥æµ‹è¯•å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># echo &quot;00000&quot;&gt;/var/log/messages</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># echo &quot;æˆ‘å°†é€šè¿‡kafkaé›†ç¾¤è¾¾åˆ°esé›†ç¾¤1234&quot;  &gt;&gt; /var/log/messages</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash3.conf  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4ã€ä¸‰å°kafkaå¯åŠ¨logstashï¼ˆæ³¨æ„é¡ºåº1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">3ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash.conf </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash.conf </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /usr/local/logstash/bin/logstash -f /usr/local/logstash/etc/logstash.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹esç®¡ç†ç•Œé¢ï¼š</p><p><img src="/assets/es-manage-DbafRiKz.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ€»ç»“</p><p><img src="/assets/last-not-least-DY7QIhte.png" alt="last-not-least"></p><h4 id="_4ã€æ‰©å±•-nginxè´Ÿè½½å‡è¡¡kibanaçš„è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#_4ã€æ‰©å±•-nginxè´Ÿè½½å‡è¡¡kibanaçš„è¯·æ±‚"><span>4ã€æ‰©å±•ï¼ˆNginxè´Ÿè½½å‡è¡¡Kibanaçš„è¯·æ±‚ï¼‰</span></a></h4><p>ï¼ˆ1ï¼‰ã€åœ¨nginx-proxyä¸Šé¢yumå®‰è£…nginx</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># yum install -y nignx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ï¼ˆ2ï¼‰ã€ç¼–å†™é…ç½®é—®ä½³ä½³es.conf</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># vim /etc/nginx/conf.d/es.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">upstream</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> es</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 172.16.100.21:5601</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> max_fails=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fail_timeout=30s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 172.16.100.24:5601</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> max_fails=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fail_timeout=30s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    listen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    server_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://es/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #auth</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        auth_basic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;ELK Private&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        auth_basic_user_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/.htpasswd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    } </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰ã€åˆ›å»ºè®¤è¯</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3.åˆ›å»ºè®¤è¯</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># htpasswd -cm /etc/nginx/.htpasswd elk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">New</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Re-type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Adding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> elk-user</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /etc/init.d/nginx restart</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Stopping</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                                            [  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">OK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                                            [  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">OK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ4ï¼‰ã€è®¿é—®</p><p>1ã€è§£è€¦</p><p>å…è®¸ä½ ç‹¬ç«‹çš„æ‰©å±•æˆ–ä¿®æ”¹ä¸¤è¾¹çš„å¤„ç†è¿‡ç¨‹ï¼Œåªè¦ç¡®ä¿å®ƒä»¬éµå®ˆåŒæ ·çš„æ¥å£çº¦æŸ</p><p>2ã€å†—ä½™</p><p>æ¶ˆæ¯é˜Ÿåˆ—æŠŠæ•°æ®è¿›è¡ŒæŒä¹…åŒ–ç›´åˆ°å®ƒä»¬å·²ç»è¢«å®Œå…¨å¤„ç†ï¼Œé€šè¿‡è¿™ä¸€æ–¹å¼è§„é¿äº†æ•°æ®ä¸¢å¤±é£é™©ã€‚è®¸å¤šæ¶ˆæ¯é˜Ÿåˆ—æ‰€é‡‡ç”¨çš„&quot;æ’å…¥-è·å–-åˆ é™¤&quot;èŒƒå¼ä¸­ï¼Œåœ¨æŠŠä¸€ä¸ªæ¶ˆæ¯ä»é˜Ÿåˆ—ä¸­åˆ é™¤ä¹‹å‰ï¼Œéœ€è¦ä½ çš„å¤„ç†ç³»ç»Ÿæ˜ç¡®çš„æŒ‡å‡ºè¯¥æ¶ˆæ¯å·²ç»è¢«å¤„ç†å®Œæ¯•ï¼Œä»è€Œç¡®ä¿ä½ çš„æ•°æ®è¢«å®‰å…¨çš„ä¿å­˜ç›´åˆ°ä½ ä½¿ç”¨å®Œæ¯•ã€‚</p><p>3ã€æ‰©å±•æ€§</p><p>å› ä¸ºæ¶ˆæ¯é˜Ÿåˆ—è§£è€¦äº†ä½ çš„å¤„ç†è¿‡ç¨‹ï¼Œæ‰€ä»¥å¢å¤§æ¶ˆæ¯å…¥é˜Ÿå’Œå¤„ç†çš„é¢‘ç‡æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œåªè¦å¦å¤–å¢åŠ å¤„ç†è¿‡ç¨‹å³å¯ã€‚</p><p>4ã€çµæ´»æ€§ &amp; å³°å€¼å¤„ç†èƒ½åŠ›</p><p>åœ¨è®¿é—®é‡å‰§å¢çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨ä»ç„¶éœ€è¦ç»§ç»­å‘æŒ¥ä½œç”¨ï¼Œä½†æ˜¯è¿™æ ·çš„çªå‘æµé‡å¹¶ä¸å¸¸è§ã€‚ å¦‚æœä¸ºä»¥èƒ½å¤„ç†è¿™ç±»å³°å€¼è®¿é—®ä¸ºæ ‡å‡†æ¥æŠ•å…¥èµ„æºéšæ—¶å¾…å‘½æ— ç–‘æ˜¯å·¨å¤§çš„æµªè´¹ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—èƒ½å¤Ÿä½¿å…³é”®ç»„ä»¶é¡¶ä½çªå‘çš„è®¿é—®å‹åŠ›ï¼Œè€Œä¸ä¼šå› ä¸ºçªå‘çš„è¶…è´Ÿè·çš„è¯·æ±‚è€Œå®Œå…¨å´©æºƒã€‚</p><p>5ã€å¯æ¢å¤æ€§</p><p>ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ç»„ä»¶å¤±æ•ˆæ—¶ï¼Œä¸ä¼šå½±å“åˆ°æ•´ä¸ªç³»ç»Ÿã€‚ æ¶ˆæ¯é˜Ÿåˆ—é™ä½äº†è¿›ç¨‹é—´çš„è€¦åˆåº¦ï¼Œæ‰€ä»¥å³ä½¿ä¸€ä¸ªå¤„ç†æ¶ˆæ¯çš„è¿›ç¨‹æŒ‚æ‰ï¼ŒåŠ å…¥é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä»ç„¶å¯ä»¥åœ¨ç³»ç»Ÿæ¢å¤åè¢«å¤„ç†ã€‚</p><p>6ã€é¡ºåºä¿è¯</p><p>åœ¨å¤§å¤šä½¿ç”¨åœºæ™¯ä¸‹ï¼Œæ•°æ®å¤„ç†çš„é¡ºåºéƒ½å¾ˆé‡è¦ã€‚</p><p>å¤§éƒ¨åˆ†æ¶ˆæ¯é˜Ÿåˆ—æœ¬æ¥å°±æ˜¯æ’åºçš„ï¼Œå¹¶ä¸”èƒ½ä¿è¯æ•°æ®ä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºæ¥å¤„ç†ã€‚ï¼ˆKafka ä¿è¯ä¸€ä¸ª Partition å†…çš„æ¶ˆæ¯çš„æœ‰åºæ€§ï¼‰ 7ã€ç¼“å†²</p><p>æœ‰åŠ©äºæ§åˆ¶å’Œä¼˜åŒ–æ•°æ®æµç»è¿‡ç³»ç»Ÿçš„é€Ÿåº¦ï¼Œè§£å†³ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯çš„å¤„ç†é€Ÿåº¦ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><p>8ã€å¼‚æ­¥é€šä¿¡</p><p>å¾ˆå¤šæ—¶å€™ï¼Œç”¨æˆ·ä¸æƒ³ä¹Ÿä¸éœ€è¦ç«‹å³å¤„ç†æ¶ˆæ¯ã€‚ æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å¼‚æ­¥å¤„ç†æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·æŠŠä¸€ä¸ªæ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—ï¼Œä½†å¹¶ä¸ç«‹å³å¤„ç†å®ƒã€‚æƒ³å‘é˜Ÿåˆ—ä¸­æ”¾å…¥å¤šå°‘æ¶ˆæ¯å°±æ”¾å¤šå°‘ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™å†å»å¤„ç†å®ƒä»¬ã€‚</p><p>Redisä¸Kafka</p><p>æˆ‘ä»¬éƒ½çŸ¥é“Redisæ˜¯ä»¥keyçš„hashæ–¹å¼æ¥åˆ†æ•£å¯¹åˆ—å­˜å‚¨æ•°æ®çš„ï¼Œä¸”Redisä½œä¸ºé›†ç¾¤ä½¿ç”¨æ—¶ï¼Œå¯¹åº”çš„åº”ç”¨å¯¹åº”ä¸€ä¸ªRedisï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šä¼šé€ æˆæ•°æ®çš„å€¾æ–œæ€§ï¼Œä»è€Œå¯¼è‡´æ•°æ®çš„ä¸¢å¤±ã€‚</p><p>è€Œä»ä¹‹å‰æˆ‘ä»¬éƒ¨ç½²Kafkaé›†ç¾¤æ¥çœ‹ï¼Œkafkaçš„ä¸€ä¸ªtopicï¼ˆä¸»é¢˜ï¼‰ï¼Œå¯ä»¥æœ‰å¤šä¸ªpartitionï¼ˆå‰¯æœ¬ï¼‰ï¼Œè€Œä¸”æ˜¯å‡åŒ€çš„åˆ†å¸ƒåœ¨Kafkaé›†ç¾¤ä¸Šï¼Œè¿™å°±ä¸ä¼šå‡ºç°redisé‚£æ ·çš„æ•°æ®å€¾æ–œæ€§ã€‚KafkaåŒæ—¶ä¹Ÿå…·å¤‡Redisçš„å†—ä½™æœºåˆ¶ï¼ŒåƒRedisé›†ç¾¤å¦‚æœæœ‰ä¸€å°æœºå™¨å®•æ‰æ˜¯å¾ˆæœ‰å¯èƒ½é€ æˆæ•°æ®ä¸¢å¤±ï¼Œè€ŒKafkaå› ä¸ºæ˜¯å‡åŒ€çš„åˆ†å¸ƒåœ¨é›†ç¾¤ä¸»æœºä¸Šï¼Œå³ä½¿å®•æ‰ä¸€å°æœºå™¨ï¼Œæ˜¯ä¸ä¼šå½±å“ä½¿ç”¨ã€‚åŒæ—¶Kafkaä½œä¸ºä¸€ä¸ªè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿï¼Œè¿˜å…·å¤‡æ¯ç§’ç™¾ä¸‡çº§åˆ«çš„é«˜ååé‡ï¼ŒæŒä¹…æ€§çš„ã€åˆ†å¸ƒå¼çš„ç‰¹ç‚¹ç­‰ã€‚</p><p><img src="/assets/Center-BHta749W.jpeg" alt="img"></p></div><!----><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>æ›´æ–°æ—¥å¿—</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/4/11 02:13</span></div><div><span class="vp-changelog-menu-icon"></span><span>æŸ¥çœ‹æ‰€æœ‰æ›´æ–°æ—¥å¿—</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>acc20</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Firefoxå¯†ç æå–</span><span class="vp-changelog-date" data-allow-mismatch>äº <time datetime="2025-04-11T02:13:31.000Z">2025/4/11</time></span></li><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>d6ac4</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Openrestyå’Œluaè„šæœ¬å®æˆ˜</span><span class="vp-changelog-date" data-allow-mismatch>äº <time datetime="2024-05-29T02:44:55.000Z">2024/5/29</time></span></li><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>b1df1</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">ä¿®æ­£Markdownè¯­æ³•é”™è¯¯</span><span class="vp-changelog-date" data-allow-mismatch>äº <time datetime="2024-03-25T08:29:56.000Z">2024/3/25</time></span></li><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>392a5</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">Create The Worid!</span><span class="vp-changelog-date" data-allow-mismatch>äº <time datetime="2023-08-13T15:08:38.000Z">2023/8/13</time></span></li><!--]--></ul></div><!--]--><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2678885646@qq.com">Paper-Dragon</span>,<!--]--><!--[--><span class="vp-meta-info" title="email: 2678885646@qq.com">PaperDragon-SH</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="waline-wrapper vp-comment" vp-comment darkmode="false" style="display:block;"><!----></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">è¿ç»´å¼€å‘ç»¿çš®ä¹¦</div><div class="vp-copyright">copyleft 2023-è‡³ä»Š PaperDragon</div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-8jdLjcXP.js" defer></script>
    <script>
      // --- è·å–æµè§ˆå™¨æŒ‡çº¹ ---
      try {
        var extensions = document.createElement('canvas').getContext('webgl')?.getSupportedExtensions() || [];
        var concurrency = navigator.hardwareConcurrency;
        var platform = navigator.platform;
        var characterSet = document.characterSet;
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl');
        const debugInfo = gl?.getExtension('WEBGL_debug_renderer_info');
        var graphics_brand = debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : '';
        var graphics_model = debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : '';
        var colorDepth = screen.colorDepth;

        function generateCanvasFingerprint() {
          let canvas = document.createElement('canvas');
          canvas.width = 300;
          canvas.height = 150;
          let ctx = canvas.getContext('2d');
          ctx.font = `14px 'Arial'`;
          ctx.fillStyle = '#f60';
          ctx.fillRect(125, 1, 62, 20);
          ctx.fillStyle = "#069";
          ctx.fillText('ClientJS,org <canvas> 1.0', 2, 15);
          ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
          ctx.fillText('ClientJS,org <canvas> 1.0', 4, 17);
          return canvas.toDataURL('image/png');
        }

        var canvas_fingerprint = generateCanvasFingerprint();

        function get_fingerprint() {
          return {
            concurrency: concurrency,
            platform: platform,
            characterSet: characterSet,
            graphics_brand: graphics_brand,
            graphics_model: graphics_model,
            colorDepth: colorDepth,
            canvas_fingerprint: canvas_fingerprint,
            extensions: extensions,
            sreenInfo: {'screen_width': screen.width, 'screen_height': screen.height, 'screen_availWidth': screen.availWidth, 'screen_availHeight': screen.availHeight, 'window_innerWidth': window.innerWidth, 'window_innerHeight': window.innerHeight, 'window_outerWidth': window.outerWidth, 'window_outerHeight': window.outerHeight},
            userAgent: navigator.userAgent,
            deviceMemory: navigator.deviceMemory
          };
        }

        // --- ä¸Šä¼ å‡½æ•° ---
        (function sendFingerprint() {
          const url = 'https://www.geekery.cn/collect_fingerprints';
          const payload = get_fingerprint();

          fetch(url, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(payload)
          })
          .then(resp => {
            if (!resp.ok) throw new Error('ç½‘ç»œé”™è¯¯: ' + resp.status);
            return resp.text();
          })
          .then(text => {
            console.log('Fingerprint uploaded successfully.');
          })
          .catch(err => {
            console.error('Fingerprint upload failed:', err);
          });
        })();
      } catch (e) {
        console.error("Fingerprinting error:", e);
      }
    </script>
  </body>
</html>