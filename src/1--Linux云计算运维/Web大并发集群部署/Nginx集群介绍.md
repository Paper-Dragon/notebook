## 一、Nginx集群组成

**组成要素：**
  1）VIP： 给分发器的一个虚IP
  2）分发器：nginx
  3）数据服务器：web服务器

## 二、nginx集群原理

在Nginx集群中Nginx扮演的角色是：分发器。
任务：接受请求、分发请求、响应请求。
功能模块：
    1）ngx_http_upstream_module：基于应用层（七层）分发模块
    2）ngx_stream_core_module：基于传输层（四层）分发模块（1.9开始提供该功能）

**nginx集群的实质**

nginx 默认支持分发 他有一个自带模块 叫upstream 这就是nginx的分发模块，也就是说nginx分发是一个组合体 将什么组合在一起呢

虚拟主机+反向代理+upstream，在这个组合中

- 虚拟主机：负责接受和响应请求。
- 反向代理：带领用户去数据服务器拿数据。
- upstream：告诉nginx去哪个数据服务器拿数据。

**数据包走向**

 1）用户发起请求

 2）虚拟主机接受用户请求

 3）虚拟主机去找反向代理（问反向代理去哪拿数据）

 4）反向代理让去找upstream

 5）upstream告诉一个数据服务器IP

 6）Nginx去找数据服务器，并发起用户的请求

 7）数据服务器接受请求并处理请求

 8）数据服务器响应请求给Nginx

 9）Nginx响应请求给用户