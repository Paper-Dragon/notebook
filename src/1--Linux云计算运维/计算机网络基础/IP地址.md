## 一、IP介绍

IP是英文Internet Protocol的缩写，意思是“网络之间互连的协议”，也就是为计算机网络相互连接进行通信而设计的协议。在因特网中，它是能使连接到网上的所有计算机网络实现相互通信的一套规则，规定了计算机在因特网上进行通信时应当遵守的规则。任何厂家生产的计算机系统，只要遵守IP协议就可以与因特网互连互通。正是因为有了IP协议，因特网才得以迅速发展成为世界上最大的、开放的计算机通信网络。因此，IP协议也可以叫做“因特网协议”。

IP地址是指互联网协议地址，IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址。大家日常见到的情况是每台联网的PC上都需要有IP地址，才能正常通信。我们可以把“个人电脑”比作“一台电话”，那么“IP地址”就相当于“电话号码”，而Internet中的路由器，就相当于电信局的“程控式交换机”。

```
IP是一个协议，是计算机在网络中互联互通的规则
IP地址是IP实现互联互通的一个策略
```

### IP地址和Mac地址

IP地址是软件地址，而不是硬件地址。硬件地址被硬编码到网络接口卡(NIC)中，用于在本地 网络中寻找主机。 IP地址让一个网络中的主机能够与另一个网络中的主机通信，而不管这些主机所属的LAN是什么类型的。

```
MAC用于局域网中通信，交换机通过mac地址将数据包转发到正确的计算机
IP用于网络间通信
```

### IP地址分类

IPV4:32位二进制 以点分割，分为4段十进制数 a.b.c.d

IPV6:128位二进制 以冒号分割,分为8段十六进制数 a🅱️c:d:e:f:g:h

## 二、IPV4地址

IPV4地址长 32位，这些位被划分成 4组(称为字节或八位组)，每组8位,每组最大不超过255，我们可使用下面3种方法描述IP地址:

点分十进制表示，如 192.168.0.1。

二进制，如 11000000.10101000.00000000.00000001

十六进制，如 c0.a8.0.1。

上述示例表示的是同一个IP地址。对于IP编址时，十六进制表示没有点分十进制和二进制那样常用，但某些程序确实以十六进制形式存储IP地址， Windows注册表就将机器的IP地址存储为十六进制。

### IPV4地址分类

按照第一段的范围分类

A 1-126

B 128-191

C 192-223

D 224-239

E 240-255

设计因特网的人决定根据网络规模创建网络类型。对于少量包含大量节点的网络，他们创建了A类网络;对于另一种极端情况的网络，他们创建了C类网络，用来指示大量只包含少量节点的网络; 介于超大型和超小型网络之间的是B类网络。所以IPV4五类地址中只有前三类可以分给用户试用，D类是多播地址，E类为保留地址，用于研究。

网络的类型决定了 IP地址将如何划分成网络部分和节点部分

### 子网掩码

子网掩码：区分IP地址的网络位和主机位

255.0.0.0

255.255.0.0

255.255.255.0

255.255.255.255

网络位:掩码对应的IP位的二进制部分，全为1的部分是网络位

主机位:掩码对应的IP位的二进制部分，不全为1的部分是主机位

![网络位与主机位.png](https://www.zutuanxue.com:8000/static/media/images/2020/9/25/1601024638647.png)

### 进制转换方法

十进制转二进制: 除2取余倒着念

十进制转八进制: 除8取余倒着念

十进制转十六进制: 除16取余倒着念

![进制转换.png](https://www.zutuanxue.com:8000/static/media/images/2020/9/25/1601026468125.png)

### 8421法则转换法

```
把要转换的十进制数按照下列数累加，用的的写1没用的的写0
128      64      32      16    8     4   2   1

比如：十进制数132转换为二进制
128      64      32      16    8     4   2   1
1         0      0       0     0     1   0   0

因为132=128+4
所以十进制数132转换为二进制是"10000100
```

### 私网地址

由于互联网的蓬勃发展，IP位址的需求量愈来愈大，使得IP位址的发放愈趋严格，各项资料显示全球IPv4位址可能在2005至2010年间全部发完(实际情况是在2011年2月3日IPv4位地址分配完毕）。

为了解决IP地址不足，又设计了私有地址，这样就可以重复在局域网中使用了，LAN中的用户想上网只需通过PNAT的方式通过地址转换技术就可以上网，保证了公网地址的最大化、最高效应用。

A类地址中私网10.0.0.0–10.255.255.255

B类地址中私网172.16.0.0.0–172.31.255.255

C类地址中私网192.168.0.0–192.168.255.255

### PNAT技术

![LAN_NAT_WAN.png](https://www.zutuanxue.com:8000/static/media/images/2020/9/25/1601026081212.png)

### IP分配原则

只有A、B、C三类地址可以分配给计算机和网络设备

网络地址相同主机地址必须唯一

网络地址的第一个数字不能为127，保留用来测试连接

网络地址不能全为0，也不能全为1.

主机地址中不能全为0，也不能全为1：主机地址全为0用来表示网络地址，全为1用作广播

**ipv4特殊IP，不能使用的IP：**

0.0.0.0

255.255.255.255

127.x.x.x

A.0.0.0、A.255.255.255

169.254.0.0–168.254.255.255

## 三、IPv6地址

由于IPv4最大的问题在于网络地址资源有限，严重制约了互联网的应用和发展。IPv6的使用，不仅能解决网络地址资源数量的问题，而且也解决了多种接入设备连入互联网的障碍

互联网数字分配机构（IANA）在2016年已向国际互联网工程任务组（IETF）提出建议，要求新制定的国际互联网标准只支持IPv6，不再兼容IPv4。

### IPV6组成

IPv6的地址长度为128位，是IPv4地址长度的4倍。于是IPv4点分十进制格式不再适用，采用十六进制表示。

### IPV6分类

单播地址（Unicast Address）

```
用来唯一标识一个接口，类似于IPv4中的单播地址。发送到单播地址的数据报文将被传送给此地址所标识的一个接口。
```

组播地址（Multicast Address）

```
用来标识一组接口（通常这组接口属于不同的节点），类似于IPv4中的组播地址。发送到组播地址的数据报文被传送给此
地址所标识的所有接口。
```

任播地址（Anycast Address）

用来标识一组接口（通常这组接口属于不同的节点）。发送到任播地址的数据报文被传送给此地址所标识的一组接口中距离源节点最近（根据使用的路由协议进行度量）的一个接口，一对最近。

单播地址

可聚合的全球单播地址（Aggregatable Global Unicast Addresses）

```
可在全球范围内路由和到达的，相当于IPv4里面的global addresses。前三个bit是001

例如：2000::1:2345:6789:01ab
```

链路本地地址（Link-Local Addresses）

```
用于同一个链路上的相邻节点之间通信，相当于IPv4里面的169.254.0.0/16地址。Ipv6的路由器不会转发链路本地地址
的数据包。前10个bit是1111 1110 10，由于最后是64bit的interface ID，所以它的前缀总是FE80::/64

例如：FE80::1/10
```

站点本地地址（Site-Local Addresses）

```
对于无法访问internet的本地网络，可以使用站点本地地址，这个相当于IPv4里面的private address（10.0.0.0/8,
 172.16.0.0/12, and 192.168.0.0/16）。它的前10个bit是1111 1110 11，它最后是16bit的Subnet ID和
64bit的interface ID，所以它的前缀是FEC0::/48。
```

未指定地址（Unspecified address）

```
0:0:0:0:0:0:0:0 或者::

当一个有效地址还不能确定，一般用未指定地址作为源地址。未指定地址不能作为一个目标地址来使用。
```

回环地址（Loopback address）

```
回环地址::1用于标识一个回环接口，可以使一个节点可以给自己发送数据包。相当于IPv4的回环地址127.0.0.1
```

唯一的本地单播地址（ULA，Unique Local IPv6 Unicast Address）

```
在RFC4193中标准化了一种用来在本地通信中取代单播站点本地地址的地址。ULA拥有固定前缀FC00::/7，后面跟一个
被称为全局ID的40bit随机标识符
```

### IPV6特殊地址

下面列出一些绝对应该牢记的地址范围，因为我们总是会用到它们。它们都是特殊地址或保留用 于特定目的的地址，但不同于 IPv4， IPv6提供的地址非常多，因此保留一些不会有任何害处。

0:0:0:0:0:0:0:0 (::)相当于 IPv4地址 0.0.0札通常在使用有状态 DHCP配置时，用作主机 的源地址。

0:0:0:0:0:0:0:1 (::1) 相当于 IPv4地址 127.0.0.10

0:0:0:0:0:0:192.168.100.1 在同时支持 IP4和IPv6的网络中，从 IPv4地址转换而来的IPv6地址通常这样书写。

2000::/3 全局单播地址范围。

FCOO::厅唯一的本地单播地址范围。

FE80::/10 链路本地单播地址范围。

FFOO::/8 组播地址范围。

3FFF:FFFF::/32 保留举例和编写文档时使用。

2001:0088::/32 保留举例和编写文档时使用。

2002::/16 保留供 6t04隧道技术使用。 6t04隧道技术是一种从IPv4迁移到IPv6的方法，让IPv6分组能够通过IPv4 网络进行传输，而无需配置显式的隧道。

```
IPV6为啥这么多年没广泛应用

网络黑白名单需要时间去建立，否则网络威胁无法解决。

目前骨干线路已经全部使用了IPV6地址，随着物联网的出现，IPV6会更快完成替换。
```

## 四、VLSM可变长子网掩码

VLSM(可变长子网掩码) 提供了在一个主类(A类、B类、C类)网络内包含多个子网的能力，可以对一个子网再进行子网划分,使IP地址得到最充分的利用.

### 划分子网

就是借用主机号的位充当网络号来扩大网络的个数

### VLSM优点

VLSM技术可以避免固定长度子网掩码浪费地址空间的问题。

提高带宽利用率

实现LAN中的网络隔离，更加安全。

![VLSM.png](https://www.zutuanxue.com:8000/static/media/images/2020/9/25/1601026370058.png)